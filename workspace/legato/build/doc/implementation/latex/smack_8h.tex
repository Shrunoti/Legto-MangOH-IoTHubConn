\hypertarget{smack_8h}{}\section{framework/liblegato/linux/smack.h File Reference}
\label{smack_8h}\index{framework/liblegato/linux/smack.\+h@{framework/liblegato/linux/smack.\+h}}
{\ttfamily \#include \char`\"{}legato.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{smack_8h_a5f83fdf5dd385685f34dc3bb1a45e654}{S\+M\+A\+C\+K\+\_\+\+A\+P\+P\+\_\+\+P\+R\+E\+F\+IX}~\char`\"{}app.\char`\"{}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{smack_8h_a62834a7a3134811aaeb0033c0e8af715}{smack\+\_\+\+Is\+Enabled} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8h_a681949d8c08d48753609c8ed68efc267}{smack\+\_\+\+Init} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8h_add5cbf8e77184e9ba03ea8446593382e}{smack\+\_\+\+Set\+My\+Label} (const char $\ast$label\+Ptr)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{smack_8h_adc042c6d3c1bc9049463fccfcff585b9}{smack\+\_\+\+Get\+Proc\+Label} (pid\+\_\+t pid, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{smack_8h_af8ed0d3150b8535253b9a42c7847a613}{smack\+\_\+\+Set\+Label} (const char $\ast$obj\+Path\+Ptr, const char $\ast$label\+Ptr)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8h_ad6dc9b823efc45d900bbd2ba393848ec}{smack\+\_\+\+Set\+Rule} (const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr)
\item 
bool \hyperlink{smack_8h_a4d37d4c51fca54a95f83914bc2d12076}{smack\+\_\+\+Has\+Access} (const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8h_a7342897f0690e0e7da9350acf8321e0c}{smack\+\_\+\+Revoke\+Subject} (const char $\ast$subject\+Label\+Ptr)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8h_aa0de3f641219745526a9573936b68f96}{smack\+\_\+\+Get\+App\+Label} (const char $\ast$app\+Name\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8h_aba989a77163254ab2b3fa6880136c0f4}{smack\+\_\+\+Get\+App\+Access\+Label} (const char $\ast$app\+Name\+Ptr, mode\+\_\+t access\+Mode, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{smack_8h_a30a9367abe1cb72785429cc3c5b0aa48}{smack\+\_\+\+Get\+Dev\+Label} (dev\+\_\+t dev\+Id, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Simplified Mandatory Access Control Kernel (S\+M\+A\+CK) provides a simple solution for mandatory access control (M\+AC). M\+AC provides the ability for a centralized entity to set access policy for system resources.

Linux\textquotesingle{}s default access control policy is governed by permission bits on system resources (files, directories, devices, etc.). Permission bits can be modified by the resource owner (process with the same user ID as the resource). The access control policy is at the discretion of the resource owner; this system is classified as D\+AC (discretionary access control). With D\+AC, policies are set in a distributed manner as there are often many system users, each setting the access policy for its own resources.

In contrast, M\+AC policies are set for all system resources by a centralized entity.

Linux\textquotesingle{}s D\+AC has known weaknesses that can lead to security leaks. M\+AC is often used to overcome some of the short comings of D\+AC for systems that require a higher level of security.

S\+M\+A\+CK isn\textquotesingle{}t the only M\+AC solution available. Because it\textquotesingle{}s a simple solution, it\textquotesingle{}s not flexible enough to handle all use cases. For the majority of use cases, it will be easier to setup and maintain.

S\+M\+A\+CK supplements Linux\textquotesingle{}s D\+AC system. D\+AC permissions are checked first; if access is granted, S\+M\+A\+CK permissions are then checked. Consequently, S\+M\+A\+CK can only limit access, it can\textquotesingle{}t grant access beyond D\+AC permissions.

S\+M\+A\+CK uses \textquotesingle{}labels\textquotesingle{} on resources (objects in S\+M\+A\+CK terminology) and processes (subjects) to determine access. Labels on resources can only be set by a privileged process. A privileged process can only set it\textquotesingle{}s own label but not labels of other processes.

There are a number of single character labels (\char`\"{}\+\_\+\char`\"{}, \char`\"{}$^\wedge$\char`\"{}, \char`\"{}$\ast$\char`\"{}, \char`\"{}?\char`\"{}, \char`\"{}@\char`\"{}) that have special meanings. S\+M\+A\+CK restricts read/write/execute access based on the subject label and the object label according to the following rules\+:


\begin{DoxyEnumerate}
\item Any access requested by a task labelled \char`\"{}$\ast$\char`\"{} is denied.
\item A read or execute access requested by a task labelled \char`\"{}$^\wedge$\char`\"{} is permitted.
\item A read or execute access requested on an object labelled \char`\"{}\+\_\+\char`\"{} is permitted.
\item Any access requested on an object labelled \char`\"{}$\ast$\char`\"{} is permitted.
\item Any access requested by a task on an object with the same label is permitted.
\item Any access requested that is explicitly defined in the loaded rule set is permitted.
\item Any other access is denied.
\end{DoxyEnumerate}

Rule 6 lets us use explicit rules through adding specific labels. Explicit rules define the access rights a subject label can have on an object label. See the \hyperlink{smack_8h_c_smack_setRules}{Setting Rules} section for details. Only privileged processes can set rules.\hypertarget{smack_8h_c_smack_privProcess}{}\subsection{Privileged Processess}\label{smack_8h_c_smack_privProcess}
Privileged processes use the C\+A\+P\+\_\+\+M\+A\+C\+\_\+\+O\+V\+E\+R\+R\+I\+DE capability. It\textquotesingle{}s also possible to configure the system so the C\+A\+P\+\_\+\+M\+A\+C\+\_\+\+O\+V\+E\+R\+R\+I\+DE is honoured only for processes with a specific label. This configuration allows the system to restrict root processes (have C\+A\+P\+\_\+\+M\+A\+C\+\_\+\+O\+V\+E\+R\+R\+I\+DE) that don\textquotesingle{}t have the proper S\+M\+A\+CK label.\hypertarget{smack_8h_c_smack_assignLabels}{}\subsection{Assigning Labels}\label{smack_8h_c_smack_assignLabels}
Use \hyperlink{smack_8h_add5cbf8e77184e9ba03ea8446593382e}{smack\+\_\+\+Set\+My\+Label()} to set the S\+M\+A\+CK label for the calling process. The calling process must be a privileged process. Setting S\+M\+A\+CK labels for other processes isn\textquotesingle{}t possible.

To set the S\+M\+A\+CK label for file system objects use \hyperlink{smack_8h_af8ed0d3150b8535253b9a42c7847a613}{smack\+\_\+\+Set\+Label()}, again the calling process must be privileged.\hypertarget{smack_8h_c_smack_setRules}{}\subsection{Setting Rules}\label{smack_8h_c_smack_setRules}
Use \hyperlink{smack_8h_ad6dc9b823efc45d900bbd2ba393848ec}{smack\+\_\+\+Set\+Rule()} to set an explicit S\+M\+A\+CK rule that gives a specified subject access to a specified object.

Copyright (C) Sierra Wireless Inc. 

\subsection{Macro Definition Documentation}
\index{smack.\+h@{smack.\+h}!S\+M\+A\+C\+K\+\_\+\+A\+P\+P\+\_\+\+P\+R\+E\+F\+IX@{S\+M\+A\+C\+K\+\_\+\+A\+P\+P\+\_\+\+P\+R\+E\+F\+IX}}
\index{S\+M\+A\+C\+K\+\_\+\+A\+P\+P\+\_\+\+P\+R\+E\+F\+IX@{S\+M\+A\+C\+K\+\_\+\+A\+P\+P\+\_\+\+P\+R\+E\+F\+IX}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+A\+P\+P\+\_\+\+P\+R\+E\+F\+IX}{SMACK_APP_PREFIX}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+A\+P\+P\+\_\+\+P\+R\+E\+F\+IX~\char`\"{}app.\char`\"{}}\hypertarget{smack_8h_a5f83fdf5dd385685f34dc3bb1a45e654}{}\label{smack_8h_a5f83fdf5dd385685f34dc3bb1a45e654}
Application prefix for S\+M\+A\+CK labels. 

\subsection{Function Documentation}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Get\+App\+Access\+Label@{smack\+\_\+\+Get\+App\+Access\+Label}}
\index{smack\+\_\+\+Get\+App\+Access\+Label@{smack\+\_\+\+Get\+App\+Access\+Label}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Get\+App\+Access\+Label(const char $\ast$app\+Name\+Ptr, mode\+\_\+t access\+Mode, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{smack_GetAppAccessLabel(const char *appNamePtr, mode_t accessMode, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Get\+App\+Access\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{mode\+\_\+t}]{access\+Mode, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_aba989a77163254ab2b3fa6880136c0f4}{}\label{smack_8h_aba989a77163254ab2b3fa6880136c0f4}
Get\textquotesingle{}s the application\textquotesingle{}s smack label with the user\textquotesingle{}s access mode appended to it as a string. For example, if the access\+Mode is S\+\_\+\+I\+R\+U\+SR $\vert$ S\+\_\+\+I\+W\+U\+SR then \char`\"{}rw\char`\"{} will be appended to the application\textquotesingle{}s smack label. The groups and other bits of access\+Mode are ignored. If the user\textquotesingle{}s access\+Mode is 0 (empty) then \char`\"{}-\/\char`\"{} will be appended to the app\textquotesingle{}s smack label.

\begin{DoxyNote}{Note}
The application need not be installed for this function to succeed.
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
This function kills the calling process if there is an error such as if the buffer is too small. 
\end{DoxyWarning}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the application. \\
\hline
\mbox{\tt in}  & {\em access\+Mode} & Access mode. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the proc\textquotesingle{}s S\+M\+A\+CK label. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Get\+App\+Label@{smack\+\_\+\+Get\+App\+Label}}
\index{smack\+\_\+\+Get\+App\+Label@{smack\+\_\+\+Get\+App\+Label}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Get\+App\+Label(const char $\ast$app\+Name\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{smack_GetAppLabel(const char *appNamePtr, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Get\+App\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_aa0de3f641219745526a9573936b68f96}{}\label{smack_8h_aa0de3f641219745526a9573936b68f96}
Gets an application\textquotesingle{}s S\+M\+A\+CK label.

\begin{DoxyNote}{Note}
The application need not be installed for this function to succeed.
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
This function kills the calling process if there is an error such as if the buffer is too small. 
\end{DoxyWarning}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the application. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the proc\textquotesingle{}s S\+M\+A\+CK label. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Get\+Dev\+Label@{smack\+\_\+\+Get\+Dev\+Label}}
\index{smack\+\_\+\+Get\+Dev\+Label@{smack\+\_\+\+Get\+Dev\+Label}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Get\+Dev\+Label(dev\+\_\+t dev\+Id, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{smack_GetDevLabel(dev_t devId, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} smack\+\_\+\+Get\+Dev\+Label (
\begin{DoxyParamCaption}
\item[{dev\+\_\+t}]{dev\+Id, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_a30a9367abe1cb72785429cc3c5b0aa48}{}\label{smack_8h_a30a9367abe1cb72785429cc3c5b0aa48}
Gets a S\+M\+A\+CK label for a device file from the device ID.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if the label was successfully returned in the provided buffer. L\+E\+\_\+\+O\+V\+E\+R\+F\+L\+OW if the label could not fit in the provided buffer. L\+E\+\_\+\+F\+A\+U\+LT if there was an error. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dev\+Id} & Device ID. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to hold the S\+M\+A\+CK label for the device. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Get\+Proc\+Label@{smack\+\_\+\+Get\+Proc\+Label}}
\index{smack\+\_\+\+Get\+Proc\+Label@{smack\+\_\+\+Get\+Proc\+Label}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Get\+Proc\+Label(pid\+\_\+t pid, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{smack_GetProcLabel(pid_t pid, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} smack\+\_\+\+Get\+Proc\+Label (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_adc042c6d3c1bc9049463fccfcff585b9}{}\label{smack_8h_adc042c6d3c1bc9049463fccfcff585b9}
Get\textquotesingle{}s a process\textquotesingle{}s S\+M\+A\+CK label.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. L\+E\+\_\+\+O\+V\+E\+R\+F\+L\+OW if the supplied buffer is too small to hold the S\+M\+A\+CK label. L\+E\+\_\+\+F\+A\+U\+LT if there was an error.
\end{DoxyReturn}
Get\textquotesingle{}s a process\textquotesingle{}s smack label.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. L\+E\+\_\+\+O\+V\+E\+R\+F\+L\+OW if the supplied buffer is too small to hold the smack label. L\+E\+\_\+\+F\+A\+U\+LT if there was an error. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pid} & P\+ID of the process. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the proc\textquotesingle{}s S\+M\+A\+CK label. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Has\+Access@{smack\+\_\+\+Has\+Access}}
\index{smack\+\_\+\+Has\+Access@{smack\+\_\+\+Has\+Access}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Has\+Access(const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr)}{smack_HasAccess(const char *subjectLabelPtr, const char *accessModePtr, const char *objectLabelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}bool smack\+\_\+\+Has\+Access (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{subject\+Label\+Ptr, }
\item[{const char $\ast$}]{access\+Mode\+Ptr, }
\item[{const char $\ast$}]{object\+Label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_a4d37d4c51fca54a95f83914bc2d12076}{}\label{smack_8h_a4d37d4c51fca54a95f83914bc2d12076}
Checks whether a subject has the specified access mode for an object.

\begin{DoxyReturn}{Returns}
true if the subject has the specified access mode for the object. false if the subject does not have the specified access mode for the object.
\end{DoxyReturn}
Checks whether a subject has the specified access mode for an object.

\begin{DoxyReturn}{Returns}
true if the subject has the specified access mode for the object. false if the subject doesn\textquotesingle{}t have the specified access mode for the object. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em subject\+Label\+Ptr} & Subject label. \\
\hline
\mbox{\tt in}  & {\em access\+Mode\+Ptr} & Access mode. \\
\hline
\mbox{\tt in}  & {\em object\+Label\+Ptr} & Object label. \\
\hline
\end{DoxyParams}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Init@{smack\+\_\+\+Init}}
\index{smack\+\_\+\+Init@{smack\+\_\+\+Init}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Init(void)}{smack_Init(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Init (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_a681949d8c08d48753609c8ed68efc267}{}\label{smack_8h_a681949d8c08d48753609c8ed68efc267}
Initializes the S\+M\+A\+CK system. Mounts the S\+M\+A\+CK file system.

\begin{DoxyNote}{Note}
Should be called once for the entire system, subsequent calls to this function will have no effect. Must be called before any of the other functions in this A\+PI is called.

Failures will cause the calling process to exit.
\end{DoxyNote}
Initializes the S\+M\+A\+CK system. Mounts the smack file system.

\begin{DoxyNote}{Note}
Should be called once for the entire system, subsequent calls to this function will have no effect. Must be called before any of the other functions in this A\+PI is called.

Failures will cause the calling process to exit. 
\end{DoxyNote}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Is\+Enabled@{smack\+\_\+\+Is\+Enabled}}
\index{smack\+\_\+\+Is\+Enabled@{smack\+\_\+\+Is\+Enabled}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Is\+Enabled(void)}{smack_IsEnabled(void)}}]{\setlength{\rightskip}{0pt plus 5cm}bool smack\+\_\+\+Is\+Enabled (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_a62834a7a3134811aaeb0033c0e8af715}{}\label{smack_8h_a62834a7a3134811aaeb0033c0e8af715}
Shows whether S\+M\+A\+CK is enabled or disabled in the Legato Framework.

\begin{DoxyReturn}{Returns}
true if S\+M\+A\+CK is enabled. false if S\+M\+A\+CK is disabled. 
\end{DoxyReturn}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Revoke\+Subject@{smack\+\_\+\+Revoke\+Subject}}
\index{smack\+\_\+\+Revoke\+Subject@{smack\+\_\+\+Revoke\+Subject}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Revoke\+Subject(const char $\ast$subject\+Label\+Ptr)}{smack_RevokeSubject(const char *subjectLabelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Revoke\+Subject (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{subject\+Label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_a7342897f0690e0e7da9350acf8321e0c}{}\label{smack_8h_a7342897f0690e0e7da9350acf8321e0c}
Revokes all the access rights for a subject that were given by explicit S\+M\+A\+CK rules.

\begin{DoxyNote}{Note}
If there is an error this function will kill the calling process.
\end{DoxyNote}
Revokes all the access rights for a subject that was given by explicit S\+M\+A\+CK rules.

\begin{DoxyNote}{Note}
If there\textquotesingle{}s an error, this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em subject\+Label\+Ptr} & Subject label. \\
\hline
\end{DoxyParams}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Set\+Label@{smack\+\_\+\+Set\+Label}}
\index{smack\+\_\+\+Set\+Label@{smack\+\_\+\+Set\+Label}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Set\+Label(const char $\ast$obj\+Path\+Ptr, const char $\ast$label\+Ptr)}{smack_SetLabel(const char *objPathPtr, const char *labelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} smack\+\_\+\+Set\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{obj\+Path\+Ptr, }
\item[{const char $\ast$}]{label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_af8ed0d3150b8535253b9a42c7847a613}{}\label{smack_8h_af8ed0d3150b8535253b9a42c7847a613}
Sets the S\+M\+A\+CK label of a file system object. The calling process must be a privileged process.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if the label was set correctly. L\+E\+\_\+\+F\+A\+U\+LT if there was an error.
\end{DoxyReturn}
Sets the smack label of a file system object. The calling process must be a privileged process.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if the label was set correctly. L\+E\+\_\+\+F\+A\+U\+LT if there was an error. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em obj\+Path\+Ptr} & Path to the object. \\
\hline
\mbox{\tt in}  & {\em label\+Ptr} & Label to set the object to. \\
\hline
\end{DoxyParams}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Set\+My\+Label@{smack\+\_\+\+Set\+My\+Label}}
\index{smack\+\_\+\+Set\+My\+Label@{smack\+\_\+\+Set\+My\+Label}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Set\+My\+Label(const char $\ast$label\+Ptr)}{smack_SetMyLabel(const char *labelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Set\+My\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_add5cbf8e77184e9ba03ea8446593382e}{}\label{smack_8h_add5cbf8e77184e9ba03ea8446593382e}
Sets the S\+M\+A\+CK label of the calling process. The calling process must be a privileged process.

\begin{DoxyNote}{Note}
If there is an error this function will kill the calling process.
\end{DoxyNote}
Sets the smack label of the calling process. The calling process must be a privileged process.

\begin{DoxyNote}{Note}
If there\textquotesingle{}s an error, this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em label\+Ptr} & Label to set the calling process to. \\
\hline
\end{DoxyParams}
\index{smack.\+h@{smack.\+h}!smack\+\_\+\+Set\+Rule@{smack\+\_\+\+Set\+Rule}}
\index{smack\+\_\+\+Set\+Rule@{smack\+\_\+\+Set\+Rule}!smack.\+h@{smack.\+h}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Set\+Rule(const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr)}{smack_SetRule(const char *subjectLabelPtr, const char *accessModePtr, const char *objectLabelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Set\+Rule (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{subject\+Label\+Ptr, }
\item[{const char $\ast$}]{access\+Mode\+Ptr, }
\item[{const char $\ast$}]{object\+Label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8h_ad6dc9b823efc45d900bbd2ba393848ec}{}\label{smack_8h_ad6dc9b823efc45d900bbd2ba393848ec}
Sets an explicit S\+M\+A\+CK rule.

An explicit S\+M\+A\+CK rule defines a subject\textquotesingle{}s access to an object. The access mode can be any combination of the following. \begin{DoxyVerb} a: indicates that append access should be granted.
 r: indicates that read access should be granted.
 w: indicates that write access should be granted.
 x: indicates that execute access should be granted.
 t: indicates that the rule requests transmutation.
 -: is used as a place holder.
\end{DoxyVerb}


For example\+: \char`\"{}rx\char`\"{} means read and execute access should be granted. \char`\"{}-\/\char`\"{} means that no access should be granted.

\begin{DoxyNote}{Note}
If there is an error this function will kill the calling process.
\end{DoxyNote}
Sets an explicit smack rule.

An explicit smack rule defines a subject\textquotesingle{}s access to an object. The access mode can be any combination of the following. \begin{DoxyVerb} r: read access should be granted.
 w: write access should be granted.
 x: execute access should be granted.
 a: append access should be granted.
 -: used as a place holder.
\end{DoxyVerb}


For example\+: \char`\"{}rx\char`\"{} means read and execute access should be granted. \char`\"{}-\/\char`\"{} means that no access should be granted.

\begin{DoxyNote}{Note}
If there\textquotesingle{}s an error, this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em subject\+Label\+Ptr} & Subject label. \\
\hline
\mbox{\tt in}  & {\em access\+Mode\+Ptr} & Access mode. See the function description for details. \\
\hline
\mbox{\tt in}  & {\em object\+Label\+Ptr} & Object label. \\
\hline
\end{DoxyParams}
