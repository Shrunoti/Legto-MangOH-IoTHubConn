\hypertarget{sbtrace_8c}{}\section{framework/tools/target/linux/sbtrace/sbtrace.c File Reference}
\label{sbtrace_8c}\index{framework/tools/target/linux/sbtrace/sbtrace.\+c@{framework/tools/target/linux/sbtrace/sbtrace.\+c}}
{\ttfamily \#include \char`\"{}legato.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}interfaces.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}sys\+Paths.\+h\char`\"{}}\\*
{\ttfamily \#include $<$sys/ptrace.\+h$>$}\\*
{\ttfamily \#include $<$unistd.\+h$>$}\\*
\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_registers__t}{Registers\+\_\+t}
\item 
struct \hyperlink{struct_tracee__t}{Tracee\+\_\+t}
\item 
struct \hyperlink{struct_file_access_sys_call__t}{File\+Access\+Sys\+Call\+\_\+t}
\item 
struct \hyperlink{struct_file__t}{File\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{sbtrace_8c_aa3f8828ef285a9dbd99334ab3deaea31}{E\+S\+T\+I\+M\+A\+T\+E\+D\+\_\+\+N\+U\+M\+\_\+\+T\+R\+A\+C\+E\+ES}~17
\item 
\#define \hyperlink{sbtrace_8c_a7e9706382472a1711169460723649958}{M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES}~(\hyperlink{le__limit__interface_8h_a69ad513e5591d63ef98164372efcd3a8}{L\+E\+\_\+\+L\+I\+M\+I\+T\+\_\+\+M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+L\+EN}+1)
\item 
\#define \hyperlink{sbtrace_8c_a3b2316794233b1337cafa86a8e739168}{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR}(format\+String, ...)
\item 
\#define \hyperlink{sbtrace_8c_a4834562728b934eabdb9b813f3a2c1b3}{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+R\+R\+\_\+\+IF}(condition,  format\+String, ...)~\hyperlink{wifi_web_ap_8c_a2bf420bda7cb80e4552dcff350cddbef}{if} (condition) \{ \hyperlink{xattr_8c_a3b2316794233b1337cafa86a8e739168}{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR}(format\+String, \#\#\+\_\+\+\_\+\+V\+A\+\_\+\+A\+R\+G\+S\+\_\+\+\_\+); \}
\item 
\#define \hyperlink{sbtrace_8c_a29b7451465deac204c5f7cb1f9c6e1fc}{M\+A\+X\+\_\+\+A\+R\+GS}~7
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a4636a28aa35491d27d7c67d3495be126}{Print\+Help} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a8da8d98a009c507ee708d9d4a09db7d9}{Set\+Require\+File\+Path} (const char $\ast$requires\+Path\+Ptr)
\item 
static int \hyperlink{sbtrace_8c_ac601b9381c88c0b27e2199daf1255518}{Get\+Sys\+Call\+Num} (const \hyperlink{struct_registers__t}{Registers\+\_\+t} $\ast$reg\+Ptr)
\item 
static int \hyperlink{sbtrace_8c_a135871e62adb377eeb23d7d4b61d7014}{Get\+Sys\+Call\+Arg} (const \hyperlink{struct_registers__t}{Registers\+\_\+t} $\ast$reg\+Ptr, uint arg\+Index)
\item 
static int \hyperlink{sbtrace_8c_acf0caf2f913132a713990c2085ad3a0d}{Ptrace} (enum \+\_\+\+\_\+ptrace\+\_\+request request, pid\+\_\+t pid, \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} $\ast$addr, \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} $\ast$data)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{sbtrace_8c_a68b854e72b6ac582bec6ffae7fd593e2}{Read\+Tracee\+Str} (pid\+\_\+t pid, int addr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{sbtrace_8c_ac75b24a26ffdc561f95029c7cec2ddaa}{Get\+Access\+Path} (pid\+\_\+t pid, \hyperlink{struct_registers__t}{Registers\+\_\+t} $\ast$reg\+Ptr, const \hyperlink{struct_file_access_sys_call__t}{File\+Access\+Sys\+Call\+\_\+t} $\ast$sys\+Call\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
static \hyperlink{struct_tracee__t}{Tracee\+\_\+t} $\ast$ \hyperlink{sbtrace_8c_a6693eb63d56b482088cd56790aa7d3ca}{Get\+Tracee} (pid\+\_\+t pid)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_ad4917edd7394048bdc71b38ee7ed358b}{Attach\+Handler} (\hyperlink{le__app_ctrl__interface_8h_a91f18fa2ac21dcea04769cdf57cb7a3f}{le\+\_\+app\+Ctrl\+\_\+\+App\+Ref\+\_\+t} app\+Ref, int32\+\_\+t pid, const char $\ast$proc\+Name\+Ptr, \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} $\ast$context\+Ptr)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a489555a17fe0972166d059adbb34131d}{Store\+App\+Name} (const char $\ast$app\+Name\+Ptr)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_aa6aff07d3af325a0618f52e1a308d939}{Start\+App\+Trace} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
static const \hyperlink{struct_file_access_sys_call__t}{File\+Access\+Sys\+Call\+\_\+t} $\ast$ \hyperlink{sbtrace_8c_a9a3221d0460433bd7fc549e5abc6b012}{Find\+File\+Access\+Sys\+Call\+Obj} (int sys\+Call\+Num)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{sbtrace_8c_ad6f7091e93f36741e278a64f106b4c2c}{Does\+Path\+Conflict} (const char $\ast$new\+Path\+Ptr, const char $\ast$working\+Dir\+Ptr)
\item 
static bool \hyperlink{sbtrace_8c_af38dc3390d7890541fed788ec036e89f}{Can\+Add\+File} (const char $\ast$app\+Name\+Ptr, const char $\ast$path\+Ptr)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_abca508c7302c1c4778756089b570e847}{Warn\+Against\+Adding} (const char $\ast$dangerous\+Path\+Ptr, const char $\ast$path\+Ptr)
\item 
static bool \hyperlink{sbtrace_8c_a5bb50c5256597ce018860b89f7c878d6}{Should\+Add\+File} (const char $\ast$app\+Name\+Ptr, pid\+\_\+t tid, const char $\ast$sys\+Call\+Name\+Ptr, const char $\ast$path\+Ptr)
\item 
static bool \hyperlink{sbtrace_8c_ae52ed37e4d4278fd396cbc53d5a28b4a}{Is\+Device} (const char $\ast$path\+Ptr)
\item 
static \hyperlink{struct_file__t}{File\+\_\+t} $\ast$ \hyperlink{sbtrace_8c_a42d6169b387c95582620b92df63e3260}{Find\+Path\+In\+List} (const char $\ast$path\+Ptr, \hyperlink{structle__sls___list__t}{le\+\_\+sls\+\_\+\+List\+\_\+t} $\ast$list\+Ptr)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a44f88b633251b42d6beb0ae418daaafa}{Get\+Open\+Sys\+Call\+Perm\+Str} (pid\+\_\+t pid, \hyperlink{struct_registers__t}{Registers\+\_\+t} $\ast$reg\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a96fd7f99ce940efc1e454448d4c14844}{Set\+Device\+Permissions} (pid\+\_\+t pid, \hyperlink{struct_registers__t}{Registers\+\_\+t} $\ast$reg\+Ptr, \hyperlink{struct_file__t}{File\+\_\+t} $\ast$dev\+File\+Ptr)
\item 
static bool \hyperlink{sbtrace_8c_ad9e973e2dbe4e0534ca426830186a14e}{Is\+Link\+Exception} (const char $\ast$path\+Ptr, int sys\+Call\+Num)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a1937d7ca52a6a36677f9ab03ac7aaaca}{Handle\+Sys\+Call} (pid\+\_\+t pid)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_aafe41a852057422068230ec94f1bea71}{Write\+Paths} (const char $\ast$file\+Name\+Ptr, F\+I\+LE $\ast$file\+Stream\+Ptr, \hyperlink{structle__sls___list__t}{le\+\_\+sls\+\_\+\+List\+\_\+t} $\ast$list\+Ptr)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a5c27dfcb9838ca6b44a7ecb7bb7117a5}{Create\+Requires\+Section} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a02f348360211f77ef709b2f0427af38b}{Sig\+Child\+Handler} (int sig\+Num)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_a86ea1507101130275ed963c0886a28d5}{Check\+App\+Shutdown} (\hyperlink{le__timer_8h_a763fa6992488cdce3b5a820817094838}{le\+\_\+timer\+\_\+\+Ref\+\_\+t} timer\+Ref)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_af8bc0ffe4b5bf82606681a13b046f491}{Ask\+User\+To\+Stop} (\hyperlink{le__timer_8h_a763fa6992488cdce3b5a820817094838}{le\+\_\+timer\+\_\+\+Ref\+\_\+t} timer\+Ref)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{sbtrace_8c_afab98a67376074ee5b5424659ab719cd}{Sig\+Int\+Handler} (int sig\+Num)
\item 
\hyperlink{sbtrace_8c_a5660151e48fa98b1a20fba0ee02eb3eb}{le\+\_\+sig\+\_\+\+Block} (S\+I\+G\+I\+NT)
\item 
\hyperlink{sbtrace_8c_a2eb645189be654e43dfeb29c95143ed8}{le\+\_\+sig\+\_\+\+Set\+Event\+Handler} (S\+I\+G\+C\+H\+LD, \hyperlink{sbtrace_8c_a02f348360211f77ef709b2f0427af38b}{Sig\+Child\+Handler})
\item 
\hyperlink{sbtrace_8c_a25aac8fb73147fba535d8388420379ba}{le\+\_\+sig\+\_\+\+Set\+Event\+Handler} (S\+I\+G\+I\+NT, \hyperlink{sbtrace_8c_afab98a67376074ee5b5424659ab719cd}{Sig\+Int\+Handler})
\item 
\hyperlink{sbtrace_8c_af41d5b3ddaf0d057a637ad6f1ab1d78e}{L\+E\+\_\+\+A\+S\+S\+E\+RT} (\hyperlink{timer_8c_abbf8d4c3c78d7bf5801b94071adcb6c6}{le\+\_\+timer\+\_\+\+Set\+Handler}(\hyperlink{sbtrace_8c_a6eb1682482e742756ae0709034b921c3}{Shutdown\+Timer}, \hyperlink{sbtrace_8c_a86ea1507101130275ed963c0886a28d5}{Check\+App\+Shutdown})==\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{L\+E\+\_\+\+OK})
\item 
\hyperlink{sbtrace_8c_a3e9de8ddcaaeb5a1a16fe0bd4cb1370c}{L\+E\+\_\+\+A\+S\+S\+E\+RT} (\hyperlink{timer_8c_a5c66591a4b8e90bbe8a4a72c500e194b}{le\+\_\+timer\+\_\+\+Set\+Ms\+Interval}(\hyperlink{sbtrace_8c_a6eb1682482e742756ae0709034b921c3}{Shutdown\+Timer}, 1000)==\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{L\+E\+\_\+\+OK})
\item 
\hyperlink{sbtrace_8c_acaef4ad93dac2a85aa3888aa73dae351}{L\+E\+\_\+\+A\+S\+S\+E\+RT} (\hyperlink{timer_8c_abbf8d4c3c78d7bf5801b94071adcb6c6}{le\+\_\+timer\+\_\+\+Set\+Handler}(\hyperlink{sbtrace_8c_a9bb12bcf377c123b46764eca09666566}{No\+Activity\+Timer}, \hyperlink{sbtrace_8c_af8bc0ffe4b5bf82606681a13b046f491}{Ask\+User\+To\+Stop})==\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{L\+E\+\_\+\+OK})
\item 
\hyperlink{sbtrace_8c_a7c6c2e5e914cf8eca19d150e90f3b106}{L\+E\+\_\+\+A\+S\+S\+E\+RT} (\hyperlink{timer_8c_a5c66591a4b8e90bbe8a4a72c500e194b}{le\+\_\+timer\+\_\+\+Set\+Ms\+Interval}(\hyperlink{sbtrace_8c_a9bb12bcf377c123b46764eca09666566}{No\+Activity\+Timer}, 5000)==\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{L\+E\+\_\+\+OK})
\item 
\hyperlink{sbtrace_8c_a79004c19288b5582666bba0a1dd0b8fd}{le\+\_\+arg\+\_\+\+Set\+Flag\+Callback} (\hyperlink{wifi_8c_a4636a28aa35491d27d7c67d3495be126}{Print\+Help},\char`\"{}h\char`\"{},\char`\"{}help\char`\"{})
\item 
\hyperlink{sbtrace_8c_a6bc59b647afa6c5dca990eecae1df0c4}{le\+\_\+arg\+\_\+\+Set\+String\+Callback} (\hyperlink{sbtrace_8c_a8da8d98a009c507ee708d9d4a09db7d9}{Set\+Require\+File\+Path},\char`\"{}o\char`\"{},\char`\"{}output\char`\"{})
\item 
\hyperlink{sbtrace_8c_a86ec375ef726b14b4fa73ee5bf722184}{le\+\_\+arg\+\_\+\+Add\+Positional\+Callback} (\hyperlink{sbtrace_8c_a489555a17fe0972166d059adbb34131d}{Store\+App\+Name})
\item 
\hyperlink{sbtrace_8c_a90d7318a26a47ff744c89bedb6b02907}{le\+\_\+arg\+\_\+\+Scan} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{le__mem_8h_a44a896f6a0a1a8c733e8038eb332989e}{le\+\_\+mem\+\_\+\+Pool\+Ref\+\_\+t} \hyperlink{sbtrace_8c_a79078bda47761902ab0a80177a51d88e}{Tracee\+Pool} = N\+U\+LL
\item 
static \hyperlink{le__hashmap_8h_ae81c60860dbdb8c59beaf25985e5605a}{le\+\_\+hashmap\+\_\+\+Ref\+\_\+t} \hyperlink{sbtrace_8c_aedfae07a17296ca3c1102d6105429335}{Tracee\+Map} = N\+U\+LL
\item 
static const \hyperlink{struct_file_access_sys_call__t}{File\+Access\+Sys\+Call\+\_\+t} \hyperlink{sbtrace_8c_a6652b6e6fd2402f85b6f2d9aae318627}{File\+Access\+Sys\+Calls} \mbox{[}$\,$\mbox{]}
\item 
static const char $\ast$ \hyperlink{sbtrace_8c_ad9d8a245fff7a1b56a68019946c6e083}{App\+Name\+Ptr} = N\+U\+LL
\item 
static \hyperlink{le__app_ctrl__interface_8h_a91f18fa2ac21dcea04769cdf57cb7a3f}{le\+\_\+app\+Ctrl\+\_\+\+App\+Ref\+\_\+t} \hyperlink{sbtrace_8c_a42588905256de786c728c1ce6cc71ebc}{App\+Ref} = N\+U\+LL
\item 
static char \hyperlink{sbtrace_8c_a46a6c84efd51d96cb4a474f61229adf2}{App\+Working\+Dir} \mbox{[}\hyperlink{sbtrace_8c_a7e9706382472a1711169460723649958}{M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES}\mbox{]} = \hyperlink{sys_paths_8h_aff303174cbcab42251094e8820422e4f}{A\+P\+P\+S\+\_\+\+W\+R\+I\+T\+E\+A\+B\+L\+E\+\_\+\+D\+IR}
\item 
static \hyperlink{le__timer_8h_a763fa6992488cdce3b5a820817094838}{le\+\_\+timer\+\_\+\+Ref\+\_\+t} \hyperlink{sbtrace_8c_a9bb12bcf377c123b46764eca09666566}{No\+Activity\+Timer} = N\+U\+LL
\item 
static bool \hyperlink{sbtrace_8c_ac802663b05ada1baeec397e60535b1cc}{Check\+No\+Activity} = true
\item 
static \hyperlink{le__timer_8h_a763fa6992488cdce3b5a820817094838}{le\+\_\+timer\+\_\+\+Ref\+\_\+t} \hyperlink{sbtrace_8c_a6eb1682482e742756ae0709034b921c3}{Shutdown\+Timer} = N\+U\+LL
\item 
static \hyperlink{structle__sls___list__t}{le\+\_\+sls\+\_\+\+List\+\_\+t} \hyperlink{sbtrace_8c_a55af897fc3f1788d4b7a592e5661d0dc}{Added\+Files\+List} = \hyperlink{le__singly_linked_list_8h_a2e1013c24e2c826dbba37a761c5d9f44}{L\+E\+\_\+\+S\+L\+S\+\_\+\+L\+I\+S\+T\+\_\+\+I\+N\+IT}
\item 
static \hyperlink{structle__sls___list__t}{le\+\_\+sls\+\_\+\+List\+\_\+t} \hyperlink{sbtrace_8c_a53652f52af38207c127537ba2174e21e}{Added\+Devices\+List} = \hyperlink{le__singly_linked_list_8h_a2e1013c24e2c826dbba37a761c5d9f44}{L\+E\+\_\+\+S\+L\+S\+\_\+\+L\+I\+S\+T\+\_\+\+I\+N\+IT}
\item 
static \hyperlink{le__mem_8h_a44a896f6a0a1a8c733e8038eb332989e}{le\+\_\+mem\+\_\+\+Pool\+Ref\+\_\+t} \hyperlink{sbtrace_8c_a23a33579923f94523f4b0421380dfe56}{File\+Pool} = N\+U\+LL
\item 
static const char $\ast$ \hyperlink{sbtrace_8c_a80d6a9272c8720f425853f4721ec1751}{Requires\+Path\+Ptr} = N\+U\+LL
\item 
\hyperlink{sbtrace_8c_a0392d452f926ce36c4852de26b5eca12}{C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+I\+N\+IT}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Tool to help import files a Legato sandboxed app requires.

Dynamically determines which files an app needs by running the app and tracing the app\textquotesingle{}s system calls. Assumes that the app is already installed.

Must be run as root.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000059}{Todo}]Add support for dynamically determining limits.\end{DoxyRefDesc}


Copyright (C) Sierra Wireless Inc. 

\subsection{Macro Definition Documentation}
\index{sbtrace.\+c@{sbtrace.\+c}!E\+S\+T\+I\+M\+A\+T\+E\+D\+\_\+\+N\+U\+M\+\_\+\+T\+R\+A\+C\+E\+ES@{E\+S\+T\+I\+M\+A\+T\+E\+D\+\_\+\+N\+U\+M\+\_\+\+T\+R\+A\+C\+E\+ES}}
\index{E\+S\+T\+I\+M\+A\+T\+E\+D\+\_\+\+N\+U\+M\+\_\+\+T\+R\+A\+C\+E\+ES@{E\+S\+T\+I\+M\+A\+T\+E\+D\+\_\+\+N\+U\+M\+\_\+\+T\+R\+A\+C\+E\+ES}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{E\+S\+T\+I\+M\+A\+T\+E\+D\+\_\+\+N\+U\+M\+\_\+\+T\+R\+A\+C\+E\+ES}{ESTIMATED_NUM_TRACEES}}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\+S\+T\+I\+M\+A\+T\+E\+D\+\_\+\+N\+U\+M\+\_\+\+T\+R\+A\+C\+E\+ES~17}\hypertarget{sbtrace_8c_aa3f8828ef285a9dbd99334ab3deaea31}{}\label{sbtrace_8c_aa3f8828ef285a9dbd99334ab3deaea31}
Estimated maximum number of tracees. \index{sbtrace.\+c@{sbtrace.\+c}!I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR@{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR}}
\index{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR@{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR}{INTERNAL_ERR}}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR(
\begin{DoxyParamCaption}
\item[{}]{format\+String, }
\item[{}]{...}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a3b2316794233b1337cafa86a8e739168}{}\label{sbtrace_8c_a3b2316794233b1337cafa86a8e739168}
{\bfseries Value\+:}
\begin{DoxyCode}
\{ fprintf(stderr, \textcolor{stringliteral}{"Internal error check logs for details.\(\backslash\)n"});              \hyperlink{le__log_8h_a54b4b07f5396e19a8d9fca74238f4795}{\(\backslash\)}
\hyperlink{le__log_8h_a54b4b07f5396e19a8d9fca74238f4795}{              LE\_FATAL}(formatString, ##\_\_VA\_ARGS\_\_); \}
\end{DoxyCode}
Prints a generic message on stderr so that the user is aware there is a problem, logs the internal error message and exit. \index{sbtrace.\+c@{sbtrace.\+c}!I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+R\+R\+\_\+\+IF@{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+R\+R\+\_\+\+IF}}
\index{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+R\+R\+\_\+\+IF@{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+R\+R\+\_\+\+IF}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+R\+R\+\_\+\+IF}{INTERNAL_ERR_IF}}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+R\+R\+\_\+\+IF(
\begin{DoxyParamCaption}
\item[{}]{condition, }
\item[{}]{format\+String, }
\item[{}]{...}
\end{DoxyParamCaption}
)~{\bf if} (condition) \{ {\bf I\+N\+T\+E\+R\+N\+A\+L\+\_\+\+E\+RR}(format\+String, \#\#\+\_\+\+\_\+\+V\+A\+\_\+\+A\+R\+G\+S\+\_\+\+\_\+); \}}\hypertarget{sbtrace_8c_a4834562728b934eabdb9b813f3a2c1b3}{}\label{sbtrace_8c_a4834562728b934eabdb9b813f3a2c1b3}
If the condition is true, print a generic message on stderr so that the user is aware there is a problem, log the internal error message and exit. \index{sbtrace.\+c@{sbtrace.\+c}!M\+A\+X\+\_\+\+A\+R\+GS@{M\+A\+X\+\_\+\+A\+R\+GS}}
\index{M\+A\+X\+\_\+\+A\+R\+GS@{M\+A\+X\+\_\+\+A\+R\+GS}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{M\+A\+X\+\_\+\+A\+R\+GS}{MAX_ARGS}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+A\+R\+GS~7}\hypertarget{sbtrace_8c_a29b7451465deac204c5f7cb1f9c6e1fc}{}\label{sbtrace_8c_a29b7451465deac204c5f7cb1f9c6e1fc}
\index{sbtrace.\+c@{sbtrace.\+c}!M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES@{M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES}}
\index{M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES@{M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES}{MAX_PATH_BYTES}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES~({\bf L\+E\+\_\+\+L\+I\+M\+I\+T\+\_\+\+M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+L\+EN}+1)}\hypertarget{sbtrace_8c_a7e9706382472a1711169460723649958}{}\label{sbtrace_8c_a7e9706382472a1711169460723649958}
Maximum path bytes. 

\subsection{Function Documentation}
\index{sbtrace.\+c@{sbtrace.\+c}!Ask\+User\+To\+Stop@{Ask\+User\+To\+Stop}}
\index{Ask\+User\+To\+Stop@{Ask\+User\+To\+Stop}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Ask\+User\+To\+Stop(le\+\_\+timer\+\_\+\+Ref\+\_\+t timer\+Ref)}{AskUserToStop(le_timer_Ref_t timerRef)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Ask\+User\+To\+Stop (
\begin{DoxyParamCaption}
\item[{{\bf le\+\_\+timer\+\_\+\+Ref\+\_\+t}}]{timer\+Ref}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_af8bc0ffe4b5bf82606681a13b046f491}{}\label{sbtrace_8c_af8bc0ffe4b5bf82606681a13b046f491}
Asks the user whether we should stop tracing the app because there has been no activity in a while. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em timer\+Ref} & Timer refence that triggered this handler. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Attach\+Handler@{Attach\+Handler}}
\index{Attach\+Handler@{Attach\+Handler}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Attach\+Handler(le\+\_\+app\+Ctrl\+\_\+\+App\+Ref\+\_\+t app\+Ref, int32\+\_\+t pid, const char $\ast$proc\+Name\+Ptr, void $\ast$context\+Ptr)}{AttachHandler(le_appCtrl_AppRef_t appRef, int32_t pid, const char *procNamePtr, void *contextPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Attach\+Handler (
\begin{DoxyParamCaption}
\item[{{\bf le\+\_\+app\+Ctrl\+\_\+\+App\+Ref\+\_\+t}}]{app\+Ref, }
\item[{int32\+\_\+t}]{pid, }
\item[{const char $\ast$}]{proc\+Name\+Ptr, }
\item[{{\bf void} $\ast$}]{context\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_ad4917edd7394048bdc71b38ee7ed358b}{}\label{sbtrace_8c_ad4917edd7394048bdc71b38ee7ed358b}
Attaches to the app\textquotesingle{}s process. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Ref} & App reference. \\
\hline
\mbox{\tt in}  & {\em pid} & P\+ID of the process to attach to. \\
\hline
\mbox{\tt in}  & {\em proc\+Name\+Ptr} & Name of the process. \\
\hline
\mbox{\tt in}  & {\em context\+Ptr} & Not used. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Can\+Add\+File@{Can\+Add\+File}}
\index{Can\+Add\+File@{Can\+Add\+File}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Can\+Add\+File(const char $\ast$app\+Name\+Ptr, const char $\ast$path\+Ptr)}{CanAddFile(const char *appNamePtr, const char *pathPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static bool Can\+Add\+File (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{const char $\ast$}]{path\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_af38dc3390d7890541fed788ec036e89f}{}\label{sbtrace_8c_af38dc3390d7890541fed788ec036e89f}
Checks if the file specified by path can be added to the app\textquotesingle{}s working directory.

\begin{DoxyReturn}{Returns}
true if the file can be added to the app\textquotesingle{}s working directory. false if the file cannot be added to the app\textquotesingle{}s working directory because the file either does not exist or conflicts with something already in the app\textquotesingle{}s working directory. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & App name. \\
\hline
\mbox{\tt in}  & {\em path\+Ptr} & Path to the file. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Check\+App\+Shutdown@{Check\+App\+Shutdown}}
\index{Check\+App\+Shutdown@{Check\+App\+Shutdown}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Check\+App\+Shutdown(le\+\_\+timer\+\_\+\+Ref\+\_\+t timer\+Ref)}{CheckAppShutdown(le_timer_Ref_t timerRef)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Check\+App\+Shutdown (
\begin{DoxyParamCaption}
\item[{{\bf le\+\_\+timer\+\_\+\+Ref\+\_\+t}}]{timer\+Ref}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a86ea1507101130275ed963c0886a28d5}{}\label{sbtrace_8c_a86ea1507101130275ed963c0886a28d5}
Periodically checks whether the app has shutdown.

\begin{DoxyNote}{Note}
Checking when all processes/threads using ptrace is difficult and unreliable. Instead we simply run the Sig\+Child\+Handler periodically and if there are no more attached tracees waitpid() will return -\/1. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em timer\+Ref} & Timer refence that triggered this handler. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Create\+Requires\+Section@{Create\+Requires\+Section}}
\index{Create\+Requires\+Section@{Create\+Requires\+Section}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Create\+Requires\+Section(void)}{CreateRequiresSection(void)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Create\+Requires\+Section (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a5c27dfcb9838ca6b44a7ecb7bb7117a5}{}\label{sbtrace_8c_a5c27dfcb9838ca6b44a7ecb7bb7117a5}
Asks the user if we should create a \textquotesingle{}requires\textquotesingle{} section for all files added in this tool.

\begin{DoxyNote}{Note}
This function never returns. 
\end{DoxyNote}
\index{sbtrace.\+c@{sbtrace.\+c}!Does\+Path\+Conflict@{Does\+Path\+Conflict}}
\index{Does\+Path\+Conflict@{Does\+Path\+Conflict}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Does\+Path\+Conflict(const char $\ast$new\+Path\+Ptr, const char $\ast$working\+Dir\+Ptr)}{DoesPathConflict(const char *newPathPtr, const char *workingDirPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Does\+Path\+Conflict (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{new\+Path\+Ptr, }
\item[{const char $\ast$}]{working\+Dir\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_ad6f7091e93f36741e278a64f106b4c2c}{}\label{sbtrace_8c_ad6f7091e93f36741e278a64f106b4c2c}
Checks whether the new path conflicts with anything under the specified working directory.

\begin{DoxyReturn}{Returns}
true if there is a conflict. false if there are no conflicts. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em new\+Path\+Ptr} & New path relative to the working directory. \\
\hline
\mbox{\tt in}  & {\em working\+Dir\+Ptr} & Working directory to check. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Find\+File\+Access\+Sys\+Call\+Obj@{Find\+File\+Access\+Sys\+Call\+Obj}}
\index{Find\+File\+Access\+Sys\+Call\+Obj@{Find\+File\+Access\+Sys\+Call\+Obj}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Find\+File\+Access\+Sys\+Call\+Obj(int sys\+Call\+Num)}{FindFileAccessSysCallObj(int sysCallNum)}}]{\setlength{\rightskip}{0pt plus 5cm}static const {\bf File\+Access\+Sys\+Call\+\_\+t}$\ast$ Find\+File\+Access\+Sys\+Call\+Obj (
\begin{DoxyParamCaption}
\item[{int}]{sys\+Call\+Num}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a9a3221d0460433bd7fc549e5abc6b012}{}\label{sbtrace_8c_a9a3221d0460433bd7fc549e5abc6b012}
Finds the system call object for the system call number.

\begin{DoxyReturn}{Returns}
File access system call object if successful. N\+U\+LL otherwise. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sys\+Call\+Num} & System call number. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Find\+Path\+In\+List@{Find\+Path\+In\+List}}
\index{Find\+Path\+In\+List@{Find\+Path\+In\+List}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Find\+Path\+In\+List(const char $\ast$path\+Ptr, le\+\_\+sls\+\_\+\+List\+\_\+t $\ast$list\+Ptr)}{FindPathInList(const char *pathPtr, le_sls_List_t *listPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf File\+\_\+t}$\ast$ Find\+Path\+In\+List (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{path\+Ptr, }
\item[{{\bf le\+\_\+sls\+\_\+\+List\+\_\+t} $\ast$}]{list\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a42d6169b387c95582620b92df63e3260}{}\label{sbtrace_8c_a42d6169b387c95582620b92df63e3260}
Gets the file object with the specified path in the list.

\begin{DoxyReturn}{Returns}
The file object if the path is in the list. N\+U\+LL otherwise. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path\+Ptr} & App reference. \\
\hline
\mbox{\tt in}  & {\em list\+Ptr} & List of paths. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Get\+Access\+Path@{Get\+Access\+Path}}
\index{Get\+Access\+Path@{Get\+Access\+Path}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Get\+Access\+Path(pid\+\_\+t pid, Registers\+\_\+t $\ast$reg\+Ptr, const File\+Access\+Sys\+Call\+\_\+t $\ast$sys\+Call\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{GetAccessPath(pid_t pid, Registers_t *regPtr, const FileAccessSysCall_t *sysCallPtr, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Get\+Access\+Path (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid, }
\item[{{\bf Registers\+\_\+t} $\ast$}]{reg\+Ptr, }
\item[{const {\bf File\+Access\+Sys\+Call\+\_\+t} $\ast$}]{sys\+Call\+Ptr, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_ac75b24a26ffdc561f95029c7cec2ddaa}{}\label{sbtrace_8c_ac75b24a26ffdc561f95029c7cec2ddaa}
Gets the path that the system call is trying to access.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. L\+E\+\_\+\+O\+V\+E\+R\+F\+L\+OW if the buffer is too small to hold the path. L\+E\+\_\+\+F\+A\+U\+LT if the path could not be read. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pid} & P\+ID of the tracee. \\
\hline
\mbox{\tt in}  & {\em reg\+Ptr} & The tracee\textquotesingle{}s set of registers when the system call was made. \\
\hline
\mbox{\tt in}  & {\em sys\+Call\+Ptr} & The system call the tracee made. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to hold the path. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Buffer size. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Get\+Open\+Sys\+Call\+Perm\+Str@{Get\+Open\+Sys\+Call\+Perm\+Str}}
\index{Get\+Open\+Sys\+Call\+Perm\+Str@{Get\+Open\+Sys\+Call\+Perm\+Str}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Get\+Open\+Sys\+Call\+Perm\+Str(pid\+\_\+t pid, Registers\+\_\+t $\ast$reg\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{GetOpenSysCallPermStr(pid_t pid, Registers_t *regPtr, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Get\+Open\+Sys\+Call\+Perm\+Str (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid, }
\item[{{\bf Registers\+\_\+t} $\ast$}]{reg\+Ptr, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a44f88b633251b42d6beb0ae418daaafa}{}\label{sbtrace_8c_a44f88b633251b42d6beb0ae418daaafa}
Gets the permission for the current open() system call and merges that with what is already in the user\textquotesingle{}s buffer, producing an updated permission string. For example, if the buffer was \char`\"{}r\char`\"{} and the current open() call has write permission then the buffer would be updated to be \char`\"{}rw\char`\"{}.

\begin{DoxyNote}{Note}
This function should only be called if the tracee is in an open() sys call. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pid} & Process that made the system call. \\
\hline
\mbox{\tt in}  & {\em reg\+Ptr} & The tracees\textquotesingle{}s set of registers when the system call was made. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the permission string. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of buffer. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Get\+Sys\+Call\+Arg@{Get\+Sys\+Call\+Arg}}
\index{Get\+Sys\+Call\+Arg@{Get\+Sys\+Call\+Arg}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Get\+Sys\+Call\+Arg(const Registers\+\_\+t $\ast$reg\+Ptr, uint arg\+Index)}{GetSysCallArg(const Registers_t *regPtr, uint argIndex)}}]{\setlength{\rightskip}{0pt plus 5cm}static int Get\+Sys\+Call\+Arg (
\begin{DoxyParamCaption}
\item[{const {\bf Registers\+\_\+t} $\ast$}]{reg\+Ptr, }
\item[{uint}]{arg\+Index}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a135871e62adb377eeb23d7d4b61d7014}{}\label{sbtrace_8c_a135871e62adb377eeb23d7d4b61d7014}
Get system call arguments.

This function should be used rather than accessing the registers directly as it handles platform specific differences.

\begin{DoxyReturn}{Returns}
Returns the arguments value, or the address to the argumnets for arguments that are passed by reference. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em reg\+Ptr} & Set of register values. \\
\hline
\mbox{\tt in}  & {\em arg\+Index} & Index of the argument to get. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Get\+Sys\+Call\+Num@{Get\+Sys\+Call\+Num}}
\index{Get\+Sys\+Call\+Num@{Get\+Sys\+Call\+Num}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Get\+Sys\+Call\+Num(const Registers\+\_\+t $\ast$reg\+Ptr)}{GetSysCallNum(const Registers_t *regPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static int Get\+Sys\+Call\+Num (
\begin{DoxyParamCaption}
\item[{const {\bf Registers\+\_\+t} $\ast$}]{reg\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_ac601b9381c88c0b27e2199daf1255518}{}\label{sbtrace_8c_ac601b9381c88c0b27e2199daf1255518}
Gets the system call number from the registers.

This function should be used rather than accessing the registers directly as it handles platform specific differences. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em reg\+Ptr} & Set of register values. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Get\+Tracee@{Get\+Tracee}}
\index{Get\+Tracee@{Get\+Tracee}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Get\+Tracee(pid\+\_\+t pid)}{GetTracee(pid_t pid)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf Tracee\+\_\+t}$\ast$ Get\+Tracee (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a6693eb63d56b482088cd56790aa7d3ca}{}\label{sbtrace_8c_a6693eb63d56b482088cd56790aa7d3ca}
Gets a the tracee object for the specified pid. If the object does not exist it will becreated.

\begin{DoxyReturn}{Returns}
Tracee object. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pid} & P\+ID of the tracee. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Handle\+Sys\+Call@{Handle\+Sys\+Call}}
\index{Handle\+Sys\+Call@{Handle\+Sys\+Call}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Handle\+Sys\+Call(pid\+\_\+t pid)}{HandleSysCall(pid_t pid)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Handle\+Sys\+Call (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a1937d7ca52a6a36677f9ab03ac7aaaca}{}\label{sbtrace_8c_a1937d7ca52a6a36677f9ab03ac7aaaca}
Handles system calls that a process makes. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pid} & Process that made the system call. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Is\+Device@{Is\+Device}}
\index{Is\+Device@{Is\+Device}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Is\+Device(const char $\ast$path\+Ptr)}{IsDevice(const char *pathPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static bool Is\+Device (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{path\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_ae52ed37e4d4278fd396cbc53d5a28b4a}{}\label{sbtrace_8c_ae52ed37e4d4278fd396cbc53d5a28b4a}
Checks if the path points to a device file.

\begin{DoxyReturn}{Returns}
true if the path points to a device. false otherwise. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path\+Ptr} & Path to file. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Is\+Link\+Exception@{Is\+Link\+Exception}}
\index{Is\+Link\+Exception@{Is\+Link\+Exception}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Is\+Link\+Exception(const char $\ast$path\+Ptr, int sys\+Call\+Num)}{IsLinkException(const char *pathPtr, int sysCallNum)}}]{\setlength{\rightskip}{0pt plus 5cm}static bool Is\+Link\+Exception (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{path\+Ptr, }
\item[{int}]{sys\+Call\+Num}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_ad9e973e2dbe4e0534ca426830186a14e}{}\label{sbtrace_8c_ad9e973e2dbe4e0534ca426830186a14e}
Check for exceptions, file links that should not be created by default.

\begin{DoxyReturn}{Returns}
true if the file should not be added. false otherwise. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em path\+Ptr} & File path. \\
\hline
\mbox{\tt in}  & {\em sys\+Call\+Num} & System call number. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!le\+\_\+arg\+\_\+\+Add\+Positional\+Callback@{le\+\_\+arg\+\_\+\+Add\+Positional\+Callback}}
\index{le\+\_\+arg\+\_\+\+Add\+Positional\+Callback@{le\+\_\+arg\+\_\+\+Add\+Positional\+Callback}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{le\+\_\+arg\+\_\+\+Add\+Positional\+Callback(\+Store\+App\+Name)}{le_arg_AddPositionalCallback(StoreAppName)}}]{\setlength{\rightskip}{0pt plus 5cm}le\+\_\+arg\+\_\+\+Add\+Positional\+Callback (
\begin{DoxyParamCaption}
\item[{{\bf Store\+App\+Name}}]{}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a86ec375ef726b14b4fa73ee5bf722184}{}\label{sbtrace_8c_a86ec375ef726b14b4fa73ee5bf722184}
\index{sbtrace.\+c@{sbtrace.\+c}!le\+\_\+arg\+\_\+\+Scan@{le\+\_\+arg\+\_\+\+Scan}}
\index{le\+\_\+arg\+\_\+\+Scan@{le\+\_\+arg\+\_\+\+Scan}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{le\+\_\+arg\+\_\+\+Scan()}{le_arg_Scan()}}]{\setlength{\rightskip}{0pt plus 5cm}le\+\_\+arg\+\_\+\+Scan (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a90d7318a26a47ff744c89bedb6b02907}{}\label{sbtrace_8c_a90d7318a26a47ff744c89bedb6b02907}
Scans the argument list, setting variables and calling callbacks registered using the le\+\_\+arg\+\_\+\+Set\+Xxx\+Var(), le\+\_\+arg\+\_\+\+Set\+Xxx\+Callback(), and le\+\_\+arg\+\_\+\+Add\+Positional\+Parameters() functions. \index{sbtrace.\+c@{sbtrace.\+c}!le\+\_\+arg\+\_\+\+Set\+Flag\+Callback@{le\+\_\+arg\+\_\+\+Set\+Flag\+Callback}}
\index{le\+\_\+arg\+\_\+\+Set\+Flag\+Callback@{le\+\_\+arg\+\_\+\+Set\+Flag\+Callback}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{le\+\_\+arg\+\_\+\+Set\+Flag\+Callback(\+Print\+Help,""h"",""help"")}{le_arg_SetFlagCallback(PrintHelp,"h","help")}}]{\setlength{\rightskip}{0pt plus 5cm}le\+\_\+arg\+\_\+\+Set\+Flag\+Callback (
\begin{DoxyParamCaption}
\item[{{\bf Print\+Help}}]{, }
\item[{\char`\"{}h\char`\"{}}]{, }
\item[{\char`\"{}help\char`\"{}}]{}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a79004c19288b5582666bba0a1dd0b8fd}{}\label{sbtrace_8c_a79004c19288b5582666bba0a1dd0b8fd}
\index{sbtrace.\+c@{sbtrace.\+c}!le\+\_\+arg\+\_\+\+Set\+String\+Callback@{le\+\_\+arg\+\_\+\+Set\+String\+Callback}}
\index{le\+\_\+arg\+\_\+\+Set\+String\+Callback@{le\+\_\+arg\+\_\+\+Set\+String\+Callback}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{le\+\_\+arg\+\_\+\+Set\+String\+Callback(\+Set\+Require\+File\+Path,""o"",""output"")}{le_arg_SetStringCallback(SetRequireFilePath,"o","output")}}]{\setlength{\rightskip}{0pt plus 5cm}le\+\_\+arg\+\_\+\+Set\+String\+Callback (
\begin{DoxyParamCaption}
\item[{{\bf Set\+Require\+File\+Path}}]{, }
\item[{\char`\"{}o\char`\"{}}]{, }
\item[{\char`\"{}output\char`\"{}}]{}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a6bc59b647afa6c5dca990eecae1df0c4}{}\label{sbtrace_8c_a6bc59b647afa6c5dca990eecae1df0c4}
\index{sbtrace.\+c@{sbtrace.\+c}!L\+E\+\_\+\+A\+S\+S\+E\+RT@{L\+E\+\_\+\+A\+S\+S\+E\+RT}}
\index{L\+E\+\_\+\+A\+S\+S\+E\+RT@{L\+E\+\_\+\+A\+S\+S\+E\+RT}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{L\+E\+\_\+\+A\+S\+S\+E\+R\+T(le\+\_\+timer\+\_\+\+Set\+Handler(\+Shutdown\+Timer, Check\+App\+Shutdown)==\+L\+E\+\_\+\+O\+K)}{LE_ASSERT(le_timer_SetHandler(ShutdownTimer, CheckAppShutdown)==LE_OK)}}]{\setlength{\rightskip}{0pt plus 5cm}L\+E\+\_\+\+A\+S\+S\+E\+RT (
\begin{DoxyParamCaption}
\item[{{\bf le\+\_\+timer\+\_\+\+Set\+Handler}({\bf Shutdown\+Timer}, {\bf Check\+App\+Shutdown})}]{ = {\ttfamily ={\bf L\+E\+\_\+\+OK}}}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_af41d5b3ddaf0d057a637ad6f1ab1d78e}{}\label{sbtrace_8c_af41d5b3ddaf0d057a637ad6f1ab1d78e}
\index{sbtrace.\+c@{sbtrace.\+c}!L\+E\+\_\+\+A\+S\+S\+E\+RT@{L\+E\+\_\+\+A\+S\+S\+E\+RT}}
\index{L\+E\+\_\+\+A\+S\+S\+E\+RT@{L\+E\+\_\+\+A\+S\+S\+E\+RT}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{L\+E\+\_\+\+A\+S\+S\+E\+R\+T(le\+\_\+timer\+\_\+\+Set\+Ms\+Interval(\+Shutdown\+Timer, 1000)==\+L\+E\+\_\+\+O\+K)}{LE_ASSERT(le_timer_SetMsInterval(ShutdownTimer, 1000)==LE_OK)}}]{\setlength{\rightskip}{0pt plus 5cm}L\+E\+\_\+\+A\+S\+S\+E\+RT (
\begin{DoxyParamCaption}
\item[{{\bf le\+\_\+timer\+\_\+\+Set\+Ms\+Interval}({\bf Shutdown\+Timer}, 1000)}]{ = {\ttfamily ={\bf L\+E\+\_\+\+OK}}}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a3e9de8ddcaaeb5a1a16fe0bd4cb1370c}{}\label{sbtrace_8c_a3e9de8ddcaaeb5a1a16fe0bd4cb1370c}
\index{sbtrace.\+c@{sbtrace.\+c}!L\+E\+\_\+\+A\+S\+S\+E\+RT@{L\+E\+\_\+\+A\+S\+S\+E\+RT}}
\index{L\+E\+\_\+\+A\+S\+S\+E\+RT@{L\+E\+\_\+\+A\+S\+S\+E\+RT}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{L\+E\+\_\+\+A\+S\+S\+E\+R\+T(le\+\_\+timer\+\_\+\+Set\+Handler(\+No\+Activity\+Timer, Ask\+User\+To\+Stop)==\+L\+E\+\_\+\+O\+K)}{LE_ASSERT(le_timer_SetHandler(NoActivityTimer, AskUserToStop)==LE_OK)}}]{\setlength{\rightskip}{0pt plus 5cm}L\+E\+\_\+\+A\+S\+S\+E\+RT (
\begin{DoxyParamCaption}
\item[{{\bf le\+\_\+timer\+\_\+\+Set\+Handler}({\bf No\+Activity\+Timer}, {\bf Ask\+User\+To\+Stop})}]{ = {\ttfamily ={\bf L\+E\+\_\+\+OK}}}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_acaef4ad93dac2a85aa3888aa73dae351}{}\label{sbtrace_8c_acaef4ad93dac2a85aa3888aa73dae351}
\index{sbtrace.\+c@{sbtrace.\+c}!L\+E\+\_\+\+A\+S\+S\+E\+RT@{L\+E\+\_\+\+A\+S\+S\+E\+RT}}
\index{L\+E\+\_\+\+A\+S\+S\+E\+RT@{L\+E\+\_\+\+A\+S\+S\+E\+RT}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{L\+E\+\_\+\+A\+S\+S\+E\+R\+T(le\+\_\+timer\+\_\+\+Set\+Ms\+Interval(\+No\+Activity\+Timer, 5000)==\+L\+E\+\_\+\+O\+K)}{LE_ASSERT(le_timer_SetMsInterval(NoActivityTimer, 5000)==LE_OK)}}]{\setlength{\rightskip}{0pt plus 5cm}L\+E\+\_\+\+A\+S\+S\+E\+RT (
\begin{DoxyParamCaption}
\item[{{\bf le\+\_\+timer\+\_\+\+Set\+Ms\+Interval}({\bf No\+Activity\+Timer}, 5000)}]{ = {\ttfamily ={\bf L\+E\+\_\+\+OK}}}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a7c6c2e5e914cf8eca19d150e90f3b106}{}\label{sbtrace_8c_a7c6c2e5e914cf8eca19d150e90f3b106}
\index{sbtrace.\+c@{sbtrace.\+c}!le\+\_\+sig\+\_\+\+Block@{le\+\_\+sig\+\_\+\+Block}}
\index{le\+\_\+sig\+\_\+\+Block@{le\+\_\+sig\+\_\+\+Block}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{le\+\_\+sig\+\_\+\+Block(\+S\+I\+G\+I\+N\+T)}{le_sig_Block(SIGINT)}}]{\setlength{\rightskip}{0pt plus 5cm}le\+\_\+sig\+\_\+\+Block (
\begin{DoxyParamCaption}
\item[{S\+I\+G\+I\+NT}]{}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a5660151e48fa98b1a20fba0ee02eb3eb}{}\label{sbtrace_8c_a5660151e48fa98b1a20fba0ee02eb3eb}
\index{sbtrace.\+c@{sbtrace.\+c}!le\+\_\+sig\+\_\+\+Set\+Event\+Handler@{le\+\_\+sig\+\_\+\+Set\+Event\+Handler}}
\index{le\+\_\+sig\+\_\+\+Set\+Event\+Handler@{le\+\_\+sig\+\_\+\+Set\+Event\+Handler}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{le\+\_\+sig\+\_\+\+Set\+Event\+Handler(\+S\+I\+G\+C\+H\+L\+D, Sig\+Child\+Handler)}{le_sig_SetEventHandler(SIGCHLD, SigChildHandler)}}]{\setlength{\rightskip}{0pt plus 5cm}le\+\_\+sig\+\_\+\+Set\+Event\+Handler (
\begin{DoxyParamCaption}
\item[{S\+I\+G\+C\+H\+LD}]{, }
\item[{{\bf Sig\+Child\+Handler}}]{}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a2eb645189be654e43dfeb29c95143ed8}{}\label{sbtrace_8c_a2eb645189be654e43dfeb29c95143ed8}
\index{sbtrace.\+c@{sbtrace.\+c}!le\+\_\+sig\+\_\+\+Set\+Event\+Handler@{le\+\_\+sig\+\_\+\+Set\+Event\+Handler}}
\index{le\+\_\+sig\+\_\+\+Set\+Event\+Handler@{le\+\_\+sig\+\_\+\+Set\+Event\+Handler}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{le\+\_\+sig\+\_\+\+Set\+Event\+Handler(\+S\+I\+G\+I\+N\+T, Sig\+Int\+Handler)}{le_sig_SetEventHandler(SIGINT, SigIntHandler)}}]{\setlength{\rightskip}{0pt plus 5cm}le\+\_\+sig\+\_\+\+Set\+Event\+Handler (
\begin{DoxyParamCaption}
\item[{S\+I\+G\+I\+NT}]{, }
\item[{{\bf Sig\+Int\+Handler}}]{}
\end{DoxyParamCaption}
)}\hypertarget{sbtrace_8c_a25aac8fb73147fba535d8388420379ba}{}\label{sbtrace_8c_a25aac8fb73147fba535d8388420379ba}
\index{sbtrace.\+c@{sbtrace.\+c}!Print\+Help@{Print\+Help}}
\index{Print\+Help@{Print\+Help}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Print\+Help(void)}{PrintHelp(void)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Print\+Help (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a4636a28aa35491d27d7c67d3495be126}{}\label{sbtrace_8c_a4636a28aa35491d27d7c67d3495be126}
Prints help to stdout and exits. \index{sbtrace.\+c@{sbtrace.\+c}!Ptrace@{Ptrace}}
\index{Ptrace@{Ptrace}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Ptrace(enum \+\_\+\+\_\+ptrace\+\_\+request request, pid\+\_\+t pid, void $\ast$addr, void $\ast$data)}{Ptrace(enum __ptrace_request request, pid_t pid, void *addr, void *data)}}]{\setlength{\rightskip}{0pt plus 5cm}static int Ptrace (
\begin{DoxyParamCaption}
\item[{enum \+\_\+\+\_\+ptrace\+\_\+request}]{request, }
\item[{pid\+\_\+t}]{pid, }
\item[{{\bf void} $\ast$}]{addr, }
\item[{{\bf void} $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_acf0caf2f913132a713990c2085ad3a0d}{}\label{sbtrace_8c_acf0caf2f913132a713990c2085ad3a0d}
Wrapper for ptrace() calls that only return a result code, ie. do not use this for P\+T\+R\+A\+C\+E\+\_\+\+P\+E\+E\+K$\ast$ calls.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. L\+E\+\_\+\+N\+O\+T\+\_\+\+F\+O\+U\+ND if the tracee does not exist, is not being traced, or is not stopped. 
\end{DoxyReturn}
\index{sbtrace.\+c@{sbtrace.\+c}!Read\+Tracee\+Str@{Read\+Tracee\+Str}}
\index{Read\+Tracee\+Str@{Read\+Tracee\+Str}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Read\+Tracee\+Str(pid\+\_\+t pid, int addr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{ReadTraceeStr(pid_t pid, int addr, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Read\+Tracee\+Str (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid, }
\item[{int}]{addr, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a68b854e72b6ac582bec6ffae7fd593e2}{}\label{sbtrace_8c_a68b854e72b6ac582bec6ffae7fd593e2}
Reads a string of text starting from the specified address in the tracee\textquotesingle{}s memory.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. L\+E\+\_\+\+O\+V\+E\+R\+F\+L\+OW if the buffer is too small to hold the string. L\+E\+\_\+\+F\+A\+U\+LT if the address could not be read. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pid} & P\+ID (actually the thread ID) of the tracee. \\
\hline
\mbox{\tt in}  & {\em addr} & Address to start reading from. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the string in. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Set\+Device\+Permissions@{Set\+Device\+Permissions}}
\index{Set\+Device\+Permissions@{Set\+Device\+Permissions}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Set\+Device\+Permissions(pid\+\_\+t pid, Registers\+\_\+t $\ast$reg\+Ptr, File\+\_\+t $\ast$dev\+File\+Ptr)}{SetDevicePermissions(pid_t pid, Registers_t *regPtr, File_t *devFilePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Set\+Device\+Permissions (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid, }
\item[{{\bf Registers\+\_\+t} $\ast$}]{reg\+Ptr, }
\item[{{\bf File\+\_\+t} $\ast$}]{dev\+File\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a96fd7f99ce940efc1e454448d4c14844}{}\label{sbtrace_8c_a96fd7f99ce940efc1e454448d4c14844}
Sets the permission for the device file. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pid} & Process that made the system call. \\
\hline
\mbox{\tt in}  & {\em reg\+Ptr} & The process\textquotesingle{}s set of registers when the system call was made. \\
\hline
\mbox{\tt in}  & {\em dev\+File\+Ptr} & The device file object to set permissions on. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Set\+Require\+File\+Path@{Set\+Require\+File\+Path}}
\index{Set\+Require\+File\+Path@{Set\+Require\+File\+Path}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Set\+Require\+File\+Path(const char $\ast$requires\+Path\+Ptr)}{SetRequireFilePath(const char *requiresPathPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Set\+Require\+File\+Path (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{requires\+Path\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a8da8d98a009c507ee708d9d4a09db7d9}{}\label{sbtrace_8c_a8da8d98a009c507ee708d9d4a09db7d9}
Sets the path to use for creating the requires section file. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em requires\+Path\+Ptr} & Path to the requires file to create. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Should\+Add\+File@{Should\+Add\+File}}
\index{Should\+Add\+File@{Should\+Add\+File}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Should\+Add\+File(const char $\ast$app\+Name\+Ptr, pid\+\_\+t tid, const char $\ast$sys\+Call\+Name\+Ptr, const char $\ast$path\+Ptr)}{ShouldAddFile(const char *appNamePtr, pid_t tid, const char *sysCallNamePtr, const char *pathPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static bool Should\+Add\+File (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{pid\+\_\+t}]{tid, }
\item[{const char $\ast$}]{sys\+Call\+Name\+Ptr, }
\item[{const char $\ast$}]{path\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a5bb50c5256597ce018860b89f7c878d6}{}\label{sbtrace_8c_a5bb50c5256597ce018860b89f7c878d6}
Asks the user whether the file should be added to the app\textquotesingle{}s working directory.

\begin{DoxyReturn}{Returns}
true if the file should be added to the app\textquotesingle{}s working directory. false if the file should not be added to the app\textquotesingle{}s working directory. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & App name. \\
\hline
\mbox{\tt in}  & {\em tid} & T\+ID of the thread that made the sys call. \\
\hline
\mbox{\tt in}  & {\em sys\+Call\+Name\+Ptr} & Name of the system call. \\
\hline
\mbox{\tt in}  & {\em path\+Ptr} & Path to the file. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Sig\+Child\+Handler@{Sig\+Child\+Handler}}
\index{Sig\+Child\+Handler@{Sig\+Child\+Handler}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Sig\+Child\+Handler(int sig\+Num)}{SigChildHandler(int sigNum)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Sig\+Child\+Handler (
\begin{DoxyParamCaption}
\item[{int}]{sig\+Num}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a02f348360211f77ef709b2f0427af38b}{}\label{sbtrace_8c_a02f348360211f77ef709b2f0427af38b}
Synchronous handler for S\+I\+G\+C\+H\+I\+LD. Used to trace all attached processes. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sig\+Num} & Unused. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Sig\+Int\+Handler@{Sig\+Int\+Handler}}
\index{Sig\+Int\+Handler@{Sig\+Int\+Handler}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Sig\+Int\+Handler(int sig\+Num)}{SigIntHandler(int sigNum)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Sig\+Int\+Handler (
\begin{DoxyParamCaption}
\item[{int}]{sig\+Num}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_afab98a67376074ee5b5424659ab719cd}{}\label{sbtrace_8c_afab98a67376074ee5b5424659ab719cd}
Synchronous handler for S\+I\+G\+I\+NT. Used to handle when the user types Ctrl-\/C. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em sig\+Num} & Unused. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Start\+App\+Trace@{Start\+App\+Trace}}
\index{Start\+App\+Trace@{Start\+App\+Trace}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Start\+App\+Trace(void)}{StartAppTrace(void)}}]{\setlength{\rightskip}{0pt plus 5cm}Start\+App\+Trace (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_aa6aff07d3af325a0618f52e1a308d939}{}\label{sbtrace_8c_aa6aff07d3af325a0618f52e1a308d939}
Start tracing the app. \index{sbtrace.\+c@{sbtrace.\+c}!Store\+App\+Name@{Store\+App\+Name}}
\index{Store\+App\+Name@{Store\+App\+Name}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Store\+App\+Name(const char $\ast$app\+Name\+Ptr)}{StoreAppName(const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Store\+App\+Name (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a489555a17fe0972166d059adbb34131d}{}\label{sbtrace_8c_a489555a17fe0972166d059adbb34131d}
Stores the application name from the command line. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & App name from the command line. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Warn\+Against\+Adding@{Warn\+Against\+Adding}}
\index{Warn\+Against\+Adding@{Warn\+Against\+Adding}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Warn\+Against\+Adding(const char $\ast$dangerous\+Path\+Ptr, const char $\ast$path\+Ptr)}{WarnAgainstAdding(const char *dangerousPathPtr, const char *pathPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Warn\+Against\+Adding (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{dangerous\+Path\+Ptr, }
\item[{const char $\ast$}]{path\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_abca508c7302c1c4778756089b570e847}{}\label{sbtrace_8c_abca508c7302c1c4778756089b570e847}
Prints a warning message if the app is trying to access certain potentially dangerous files. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dangerous\+Path\+Ptr} & Path to warn against. \\
\hline
\mbox{\tt in}  & {\em path\+Ptr} & Path to be added. \\
\hline
\end{DoxyParams}
\index{sbtrace.\+c@{sbtrace.\+c}!Write\+Paths@{Write\+Paths}}
\index{Write\+Paths@{Write\+Paths}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Write\+Paths(const char $\ast$file\+Name\+Ptr, F\+I\+L\+E $\ast$file\+Stream\+Ptr, le\+\_\+sls\+\_\+\+List\+\_\+t $\ast$list\+Ptr)}{WritePaths(const char *fileNamePtr, FILE *fileStreamPtr, le_sls_List_t *listPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Write\+Paths (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{file\+Name\+Ptr, }
\item[{F\+I\+LE $\ast$}]{file\+Stream\+Ptr, }
\item[{{\bf le\+\_\+sls\+\_\+\+List\+\_\+t} $\ast$}]{list\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_aafe41a852057422068230ec94f1bea71}{}\label{sbtrace_8c_aafe41a852057422068230ec94f1bea71}
Write the list of paths to the open file. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em file\+Name\+Ptr} & Name of the file to write to. \\
\hline
\mbox{\tt in}  & {\em file\+Stream\+Ptr} & File to write to. \\
\hline
\mbox{\tt in}  & {\em list\+Ptr} & List of paths. \\
\hline
\end{DoxyParams}


\subsection{Variable Documentation}
\index{sbtrace.\+c@{sbtrace.\+c}!Added\+Devices\+List@{Added\+Devices\+List}}
\index{Added\+Devices\+List@{Added\+Devices\+List}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Added\+Devices\+List}{AddedDevicesList}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+sls\+\_\+\+List\+\_\+t} Added\+Devices\+List = {\bf L\+E\+\_\+\+S\+L\+S\+\_\+\+L\+I\+S\+T\+\_\+\+I\+N\+IT}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a53652f52af38207c127537ba2174e21e}{}\label{sbtrace_8c_a53652f52af38207c127537ba2174e21e}
Added devices list. \index{sbtrace.\+c@{sbtrace.\+c}!Added\+Files\+List@{Added\+Files\+List}}
\index{Added\+Files\+List@{Added\+Files\+List}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Added\+Files\+List}{AddedFilesList}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+sls\+\_\+\+List\+\_\+t} Added\+Files\+List = {\bf L\+E\+\_\+\+S\+L\+S\+\_\+\+L\+I\+S\+T\+\_\+\+I\+N\+IT}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a55af897fc3f1788d4b7a592e5661d0dc}{}\label{sbtrace_8c_a55af897fc3f1788d4b7a592e5661d0dc}
Added files list. \index{sbtrace.\+c@{sbtrace.\+c}!App\+Name\+Ptr@{App\+Name\+Ptr}}
\index{App\+Name\+Ptr@{App\+Name\+Ptr}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{App\+Name\+Ptr}{AppNamePtr}}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ App\+Name\+Ptr = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_ad9d8a245fff7a1b56a68019946c6e083}{}\label{sbtrace_8c_ad9d8a245fff7a1b56a68019946c6e083}
Name of the application being traced. \index{sbtrace.\+c@{sbtrace.\+c}!App\+Ref@{App\+Ref}}
\index{App\+Ref@{App\+Ref}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{App\+Ref}{AppRef}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+app\+Ctrl\+\_\+\+App\+Ref\+\_\+t} App\+Ref = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a42588905256de786c728c1ce6cc71ebc}{}\label{sbtrace_8c_a42588905256de786c728c1ce6cc71ebc}
Application reference. \index{sbtrace.\+c@{sbtrace.\+c}!App\+Working\+Dir@{App\+Working\+Dir}}
\index{App\+Working\+Dir@{App\+Working\+Dir}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{App\+Working\+Dir}{AppWorkingDir}}]{\setlength{\rightskip}{0pt plus 5cm}char App\+Working\+Dir\mbox{[}{\bf M\+A\+X\+\_\+\+P\+A\+T\+H\+\_\+\+B\+Y\+T\+ES}\mbox{]} = {\bf A\+P\+P\+S\+\_\+\+W\+R\+I\+T\+E\+A\+B\+L\+E\+\_\+\+D\+IR}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a46a6c84efd51d96cb4a474f61229adf2}{}\label{sbtrace_8c_a46a6c84efd51d96cb4a474f61229adf2}
Apps working directory. \index{sbtrace.\+c@{sbtrace.\+c}!Check\+No\+Activity@{Check\+No\+Activity}}
\index{Check\+No\+Activity@{Check\+No\+Activity}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Check\+No\+Activity}{CheckNoActivity}}]{\setlength{\rightskip}{0pt plus 5cm}bool Check\+No\+Activity = true\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_ac802663b05ada1baeec397e60535b1cc}{}\label{sbtrace_8c_ac802663b05ada1baeec397e60535b1cc}
Flag that indicates whether to timeout when there is no activity by any tracee. \index{sbtrace.\+c@{sbtrace.\+c}!C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+I\+N\+IT@{C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+I\+N\+IT}}
\index{C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+I\+N\+IT@{C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+I\+N\+IT}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+I\+N\+IT}{COMPONENT_INIT}}]{\setlength{\rightskip}{0pt plus 5cm}C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+I\+N\+IT}\hypertarget{sbtrace_8c_a0392d452f926ce36c4852de26b5eca12}{}\label{sbtrace_8c_a0392d452f926ce36c4852de26b5eca12}
{\bfseries Initial value\+:}
\begin{DoxyCode}
\{
    
    \hyperlink{sbtrace_8c_a5660151e48fa98b1a20fba0ee02eb3eb}{le\_sig\_Block}(SIGCHLD)
\end{DoxyCode}
\index{sbtrace.\+c@{sbtrace.\+c}!File\+Access\+Sys\+Calls@{File\+Access\+Sys\+Calls}}
\index{File\+Access\+Sys\+Calls@{File\+Access\+Sys\+Calls}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{File\+Access\+Sys\+Calls}{FileAccessSysCalls}}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf File\+Access\+Sys\+Call\+\_\+t} File\+Access\+Sys\+Calls\mbox{[}$\,$\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a6652b6e6fd2402f85b6f2d9aae318627}{}\label{sbtrace_8c_a6652b6e6fd2402f85b6f2d9aae318627}
Array of system calls that access a file or directory. \index{sbtrace.\+c@{sbtrace.\+c}!File\+Pool@{File\+Pool}}
\index{File\+Pool@{File\+Pool}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{File\+Pool}{FilePool}}]{\setlength{\rightskip}{0pt plus 5cm}File\+Pool = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a23a33579923f94523f4b0421380dfe56}{}\label{sbtrace_8c_a23a33579923f94523f4b0421380dfe56}
Memory pool of file objects. \index{sbtrace.\+c@{sbtrace.\+c}!No\+Activity\+Timer@{No\+Activity\+Timer}}
\index{No\+Activity\+Timer@{No\+Activity\+Timer}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{No\+Activity\+Timer}{NoActivityTimer}}]{\setlength{\rightskip}{0pt plus 5cm}No\+Activity\+Timer = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a9bb12bcf377c123b46764eca09666566}{}\label{sbtrace_8c_a9bb12bcf377c123b46764eca09666566}
Timeout timer used for when there is no activities by any tracee. \index{sbtrace.\+c@{sbtrace.\+c}!Requires\+Path\+Ptr@{Requires\+Path\+Ptr}}
\index{Requires\+Path\+Ptr@{Requires\+Path\+Ptr}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Requires\+Path\+Ptr}{RequiresPathPtr}}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ Requires\+Path\+Ptr = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a80d6a9272c8720f425853f4721ec1751}{}\label{sbtrace_8c_a80d6a9272c8720f425853f4721ec1751}
Path to use when creating the requires section file. \index{sbtrace.\+c@{sbtrace.\+c}!Shutdown\+Timer@{Shutdown\+Timer}}
\index{Shutdown\+Timer@{Shutdown\+Timer}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Shutdown\+Timer}{ShutdownTimer}}]{\setlength{\rightskip}{0pt plus 5cm}Shutdown\+Timer = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a6eb1682482e742756ae0709034b921c3}{}\label{sbtrace_8c_a6eb1682482e742756ae0709034b921c3}
Timer used for checking when the app has stopped. \index{sbtrace.\+c@{sbtrace.\+c}!Tracee\+Map@{Tracee\+Map}}
\index{Tracee\+Map@{Tracee\+Map}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Tracee\+Map}{TraceeMap}}]{\setlength{\rightskip}{0pt plus 5cm}Tracee\+Map = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_aedfae07a17296ca3c1102d6105429335}{}\label{sbtrace_8c_aedfae07a17296ca3c1102d6105429335}
Hash map of tracees. \index{sbtrace.\+c@{sbtrace.\+c}!Tracee\+Pool@{Tracee\+Pool}}
\index{Tracee\+Pool@{Tracee\+Pool}!sbtrace.\+c@{sbtrace.\+c}}
\subsubsection[{\texorpdfstring{Tracee\+Pool}{TraceePool}}]{\setlength{\rightskip}{0pt plus 5cm}Tracee\+Pool = N\+U\+LL\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{sbtrace_8c_a79078bda47761902ab0a80177a51d88e}{}\label{sbtrace_8c_a79078bda47761902ab0a80177a51d88e}
Pool of tracee objects. 