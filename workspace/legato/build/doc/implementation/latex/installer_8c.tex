\hypertarget{installer_8c}{}\section{framework/liblegato/linux/installer.c File Reference}
\label{installer_8c}\index{framework/liblegato/linux/installer.\+c@{framework/liblegato/linux/installer.\+c}}
{\ttfamily \#include \char`\"{}legato.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}limit.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}installer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}file.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}smack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dir.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}user.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{installer_8c_aeec5a96a8625fff786de3b01f166a339}{Get\+Dir\+Smack\+Label} (const char $\ast$app\+Label, mode\+\_\+t dir\+Mode, char $\ast$dir\+Label, size\+\_\+t label\+Size)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{installer_8c_a41491ce0256d1c21bdac617d5b3894c7}{installer\+\_\+\+Get\+App\+Hash\+From\+Symlink} (const char $\ast$link\+Path, char hash\+Buffer\mbox{[}\hyperlink{limit_8h_a54afff2397b4c963793b121a90abc1dc}{L\+I\+M\+I\+T\+\_\+\+M\+D5\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES}\mbox{]})
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{installer_8c_aba9ecebec96cb9b814b42ea2181d8751}{installer\+\_\+\+Install\+App\+Writeable\+Files} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr, const char $\ast$old\+System\+Name)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{installer_8c_af623700c90b29a0a74ed2f3d7c352215}{installer\+\_\+\+Update\+App\+Writeable\+Files} (const char $\ast$system\+Name\+Ptr, const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{installer_8c_a7e121426d5332b957fc4d8f27900b392}{installer\+\_\+\+Remove\+App\+Writeable\+Device\+Files} (const char $\ast$system\+Name\+Ptr, const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Utility functions needed by the installers (Update Daemon and the start program\textquotesingle{}s \char`\"{}golden\char`\"{} system installer).

Copyright (C) Sierra Wireless Inc. 

\subsection{Function Documentation}
\index{installer.\+c@{installer.\+c}!Get\+Dir\+Smack\+Label@{Get\+Dir\+Smack\+Label}}
\index{Get\+Dir\+Smack\+Label@{Get\+Dir\+Smack\+Label}!installer.\+c@{installer.\+c}}
\subsubsection[{\texorpdfstring{Get\+Dir\+Smack\+Label(const char $\ast$app\+Label, mode\+\_\+t dir\+Mode, char $\ast$dir\+Label, size\+\_\+t label\+Size)}{GetDirSmackLabel(const char *appLabel, mode_t dirMode, char *dirLabel, size_t labelSize)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Get\+Dir\+Smack\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Label, }
\item[{mode\+\_\+t}]{dir\+Mode, }
\item[{char $\ast$}]{dir\+Label, }
\item[{size\+\_\+t}]{label\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{installer_8c_aeec5a96a8625fff786de3b01f166a339}{}\label{installer_8c_aeec5a96a8625fff786de3b01f166a339}
Get app directory smack label based on permission bits. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Label} & The smack label of the application. \\
\hline
\mbox{\tt in}  & {\em dir\+Mode} & Permission bits for directory \\
\hline
\mbox{\tt out}  & {\em dir\+Label} & Ptr to the buffer the directory label will be written into. \\
\hline
\mbox{\tt in}  & {\em label\+Size} & Size (in bytes) of the directory label buffer. \\
\hline
\end{DoxyParams}
\index{installer.\+c@{installer.\+c}!installer\+\_\+\+Get\+App\+Hash\+From\+Symlink@{installer\+\_\+\+Get\+App\+Hash\+From\+Symlink}}
\index{installer\+\_\+\+Get\+App\+Hash\+From\+Symlink@{installer\+\_\+\+Get\+App\+Hash\+From\+Symlink}!installer.\+c@{installer.\+c}}
\subsubsection[{\texorpdfstring{installer\+\_\+\+Get\+App\+Hash\+From\+Symlink(const char $\ast$link\+Path, char hash\+Buffer[L\+I\+M\+I\+T\+\_\+\+M\+D5\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES])}{installer_GetAppHashFromSymlink(const char *linkPath, char hashBuffer[LIMIT_MD5_STR_BYTES])}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} installer\+\_\+\+Get\+App\+Hash\+From\+Symlink (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{link\+Path, }
\item[{char}]{hash\+Buffer\mbox{[}\+L\+I\+M\+I\+T\+\_\+\+M\+D5\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+E\+S\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{installer_8c_a41491ce0256d1c21bdac617d5b3894c7}{}\label{installer_8c_a41491ce0256d1c21bdac617d5b3894c7}
Get the app hash ID contained in a symlink to an app.

On return the application\textquotesingle{}s hash is copied into the supplied hash\+Buffer. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em link\+Path} & The path to the symlink. \\
\hline
\mbox{\tt out}  & {\em hash\+Buffer} & Buffer to hold the application hash ID. \\
\hline
\end{DoxyParams}
\index{installer.\+c@{installer.\+c}!installer\+\_\+\+Install\+App\+Writeable\+Files@{installer\+\_\+\+Install\+App\+Writeable\+Files}}
\index{installer\+\_\+\+Install\+App\+Writeable\+Files@{installer\+\_\+\+Install\+App\+Writeable\+Files}!installer.\+c@{installer.\+c}}
\subsubsection[{\texorpdfstring{installer\+\_\+\+Install\+App\+Writeable\+Files(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr, const char $\ast$old\+System\+Name)}{installer_InstallAppWriteableFiles(const char *appMd5Ptr, const char *appNamePtr, const char *oldSystemName)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} installer\+\_\+\+Install\+App\+Writeable\+Files (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{const char $\ast$}]{old\+System\+Name}
\end{DoxyParamCaption}
)}\hypertarget{installer_8c_aba9ecebec96cb9b814b42ea2181d8751}{}\label{installer_8c_aba9ecebec96cb9b814b42ea2181d8751}
Install a given app\textquotesingle{}s writeable files in the \char`\"{}unpack\char`\"{} system from either the app\textquotesingle{}s install directory (/legato/apps/$<$hash$>$) or a specified other system, as appropriate for each file.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em old\+System\+Name} & Name of system to inherit files from (e.\+g., \char`\"{}current\char`\"{} or \char`\"{}0\char`\"{}). \\
\hline
\end{DoxyParams}
\index{installer.\+c@{installer.\+c}!installer\+\_\+\+Remove\+App\+Writeable\+Device\+Files@{installer\+\_\+\+Remove\+App\+Writeable\+Device\+Files}}
\index{installer\+\_\+\+Remove\+App\+Writeable\+Device\+Files@{installer\+\_\+\+Remove\+App\+Writeable\+Device\+Files}!installer.\+c@{installer.\+c}}
\subsubsection[{\texorpdfstring{installer\+\_\+\+Remove\+App\+Writeable\+Device\+Files(const char $\ast$system\+Name\+Ptr, const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{installer_RemoveAppWriteableDeviceFiles(const char *systemNamePtr, const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} installer\+\_\+\+Remove\+App\+Writeable\+Device\+Files (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{system\+Name\+Ptr, }
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{installer_8c_a7e121426d5332b957fc4d8f27900b392}{}\label{installer_8c_a7e121426d5332b957fc4d8f27900b392}
Remove devices from a given app\textquotesingle{}s writeable files. This is to ensure that device node numbers always match their respective devices outside the sandbox.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em system\+Name\+Ptr} & System dir to write files into (\char`\"{}current\char`\"{} or \char`\"{}unpack\char`\"{}). \\
\hline
\end{DoxyParams}
\index{installer.\+c@{installer.\+c}!installer\+\_\+\+Update\+App\+Writeable\+Files@{installer\+\_\+\+Update\+App\+Writeable\+Files}}
\index{installer\+\_\+\+Update\+App\+Writeable\+Files@{installer\+\_\+\+Update\+App\+Writeable\+Files}!installer.\+c@{installer.\+c}}
\subsubsection[{\texorpdfstring{installer\+\_\+\+Update\+App\+Writeable\+Files(const char $\ast$system\+Name\+Ptr, const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{installer_UpdateAppWriteableFiles(const char *systemNamePtr, const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} installer\+\_\+\+Update\+App\+Writeable\+Files (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{system\+Name\+Ptr, }
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{installer_8c_af623700c90b29a0a74ed2f3d7c352215}{}\label{installer_8c_af623700c90b29a0a74ed2f3d7c352215}
Update a given app\textquotesingle{}s writeable files in a given system to match what\textquotesingle{}s in the app\textquotesingle{}s install directory (/legato/apps/$<$hash$>$). Deletes from the system any files that are not in the app\textquotesingle{}s install directory. Adds to the system any files from the apps\textquotesingle{} install directory that are already in the system. Leaves alone files that are in both the system and the app\textquotesingle{}s install directory.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. 
\end{DoxyReturn}

\begin{DoxyParams}{Parameters}
{\em system\+Name\+Ptr} & System dir to write files into (\char`\"{}current\char`\"{} or \char`\"{}unpack\char`\"{}). \\
\hline
\end{DoxyParams}
