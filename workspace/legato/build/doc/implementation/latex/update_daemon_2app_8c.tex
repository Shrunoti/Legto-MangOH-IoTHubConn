\hypertarget{update_daemon_2app_8c}{}\section{framework/daemons/linux/update\+Daemon/app.c File Reference}
\label{update_daemon_2app_8c}\index{framework/daemons/linux/update\+Daemon/app.\+c@{framework/daemons/linux/update\+Daemon/app.\+c}}
{\ttfamily \#include $<$sys/types.\+h$>$}\\*
{\ttfamily \#include $<$sys/stat.\+h$>$}\\*
{\ttfamily \#include \char`\"{}legato.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}interfaces.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}limit.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}app\+User.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}file.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}dir.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}app.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}sys\+Status.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}system.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}sup\+Ctrl.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}inst\+Stat.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}installer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}smack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}sys\+Paths.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}file\+System.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ima.\+h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{update_daemon_2app_8c_ad28cbea5b2f409d38ee8373b6ed3f6a2}{Import\+Config} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_ab51e66da860f8fa9403e8191e8d7aa36}{Exec\+Install\+Hook} (const char $\ast$user\+Script\+Path)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{update_daemon_2app_8c_a1b0994ea4b19e3eecb731a7429c195d0}{Exec\+Preinstall\+Hook} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{update_daemon_2app_8c_a6e7131dacc0a6357f4f68050c44d7539}{Exec\+Postinstall\+Hook} (const char $\ast$app\+Md5\+Ptr)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_a6f0bb921a0022bcaa42e798064160e76}{Set\+Smack\+Perm\+Read\+Only\+Dir} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_a4f17d1fd2e19fbc8f28870bd5fa810d4}{Set\+Perm\+App\+Writable\+Dir} (const char $\ast$app\+Writable\+Dir, const char $\ast$app\+Label)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_a40306e4cca70c382463e68656d04fc0b}{Perform\+App\+Upgrade} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_a0ea8743d86dae157c2238d66101b8e2c}{Perform\+App\+Install} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
static \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_a478cd27cba1ee57737d388fd3aa6d935}{Perform\+App\+Delete} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr, \hyperlink{le__cfg__interface_8h_a646829934bb23a878e19ade2c3e01eba}{le\+\_\+cfg\+\_\+\+Iterator\+Ref\+\_\+t} i)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_abd33cfa945c3ac142ba70db27aff490f}{app\+\_\+\+Set\+Smack\+Perm\+Read\+Only} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
bool \hyperlink{update_daemon_2app_8c_a75bddf3534b68cb34b45ebc85cfb5664}{app\+\_\+\+Exists} (const char $\ast$md5\+Str\+Ptr)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{update_daemon_2app_8c_ab0305dd523f10ef7195c0396a139c38e}{app\+\_\+\+Hash} (const char $\ast$app\+Name\+Ptr, char hash\+Buffer\mbox{[}\hyperlink{limit_8h_a54afff2397b4c963793b121a90abc1dc}{L\+I\+M\+I\+T\+\_\+\+M\+D5\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES}\mbox{]})
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{update_daemon_2app_8c_a1191a9b48c2badc6ef1dbcfccaba0fac}{app\+\_\+\+Prep\+Unpack\+Dir} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_aeb3d48b159b703d931635ef7b026f7f8}{app\+\_\+\+Set\+Up\+App\+Writeables} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_a289ac74e5203fd85044eb7d749a5009a}{app\+\_\+\+Install\+Individual} (const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{update_daemon_2app_8c_a1ff3f06b5329bfe0be75c08ca58eba66}{app\+\_\+\+Remove\+Individual} (const char $\ast$app\+Name\+Ptr)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{update_daemon_2app_8c_a6715dece7d0aac8dd2e7247d30ebee00}{app\+\_\+\+Finish\+Updates} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static const char $\ast$ \hyperlink{update_daemon_2app_8c_a4609f54012aab62e348646736146d073}{Install\+Hook\+Script\+Path} = \char`\"{}/legato/systems/current/bin/install-\/hook\char`\"{}
\item 
const char $\ast$ \hyperlink{update_daemon_2app_8c_a0d2076594302990a4c6ace287bbb4453}{app\+\_\+\+Unpack\+Path} = \char`\"{}/legato/apps/unpack\char`\"{}
\item 
static const char $\ast$ \hyperlink{update_daemon_2app_8c_ab9c3d9f804ba2dcb123232c16f054df7}{Pre\+Install\+Path} = \char`\"{}/legato/apps/\%s/read-\/only/script/pre-\/install\char`\"{}
\item 
static const char $\ast$ \hyperlink{update_daemon_2app_8c_a3bcdd12ac0ba8bce81c4a2b76a84ba3d}{Post\+Install\+Path} = \char`\"{}/legato/apps/\%s/read-\/only/script/post-\/install\char`\"{}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Exists@{app\+\_\+\+Exists}}
\index{app\+\_\+\+Exists@{app\+\_\+\+Exists}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Exists(const char $\ast$md5\+Str\+Ptr)}{app_Exists(const char *md5StrPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}bool app\+\_\+\+Exists (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{md5\+Str\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{update_daemon_2app_8c_a75bddf3534b68cb34b45ebc85cfb5664}{}\label{update_daemon_2app_8c_a75bddf3534b68cb34b45ebc85cfb5664}
Check to see if the given application exists. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em md5\+Str\+Ptr} & The hash of the app to find. \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Finish\+Updates@{app\+\_\+\+Finish\+Updates}}
\index{app\+\_\+\+Finish\+Updates@{app\+\_\+\+Finish\+Updates}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Finish\+Updates(void)}{app_FinishUpdates(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} app\+\_\+\+Finish\+Updates (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{update_daemon_2app_8c_a6715dece7d0aac8dd2e7247d30ebee00}{}\label{update_daemon_2app_8c_a6715dece7d0aac8dd2e7247d30ebee00}
Determine if an app update was interrupted, and if so finish it. \index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Hash@{app\+\_\+\+Hash}}
\index{app\+\_\+\+Hash@{app\+\_\+\+Hash}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Hash(const char $\ast$app\+Name\+Ptr, char hash\+Buffer[L\+I\+M\+I\+T\+\_\+\+M\+D5\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES])}{app_Hash(const char *appNamePtr, char hashBuffer[LIMIT_MD5_STR_BYTES])}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} app\+\_\+\+Hash (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{char}]{hash\+Buffer\mbox{[}\+L\+I\+M\+I\+T\+\_\+\+M\+D5\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+E\+S\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{update_daemon_2app_8c_ab0305dd523f10ef7195c0396a139c38e}{}\label{update_daemon_2app_8c_ab0305dd523f10ef7195c0396a139c38e}
Get the hash ID for the named application.

On return the application\textquotesingle{}s hash is copied into the supplied hash\+Buffer. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & The name of the application to read. \\
\hline
\mbox{\tt out}  & {\em hash\+Buffer} & Buffer to hold the application hash ID. \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Install\+Individual@{app\+\_\+\+Install\+Individual}}
\index{app\+\_\+\+Install\+Individual@{app\+\_\+\+Install\+Individual}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Install\+Individual(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{app_InstallIndividual(const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} app\+\_\+\+Install\+Individual (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{update_daemon_2app_8c_a289ac74e5203fd85044eb7d749a5009a}{}\label{update_daemon_2app_8c_a289ac74e5203fd85044eb7d749a5009a}
Install a new individual application update in the current running system.

\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item L\+E\+\_\+\+OK if successful.
\item L\+E\+\_\+\+D\+U\+P\+L\+I\+C\+A\+TE if requested to install same app.
\item L\+E\+\_\+\+F\+A\+U\+LT for any other failure. 
\end{DoxyItemize}
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Md5\+Ptr} & Hash ID of the application to install. \\
\hline
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the application to install. \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Prep\+Unpack\+Dir@{app\+\_\+\+Prep\+Unpack\+Dir}}
\index{app\+\_\+\+Prep\+Unpack\+Dir@{app\+\_\+\+Prep\+Unpack\+Dir}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Prep\+Unpack\+Dir(void)}{app_PrepUnpackDir(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} app\+\_\+\+Prep\+Unpack\+Dir (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{update_daemon_2app_8c_a1191a9b48c2badc6ef1dbcfccaba0fac}{}\label{update_daemon_2app_8c_a1191a9b48c2badc6ef1dbcfccaba0fac}
Prepare the app unpack directory for use (delete any old one and create a fresh empty one). \index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Remove\+Individual@{app\+\_\+\+Remove\+Individual}}
\index{app\+\_\+\+Remove\+Individual@{app\+\_\+\+Remove\+Individual}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Remove\+Individual(const char $\ast$app\+Name\+Ptr)}{app_RemoveIndividual(const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} app\+\_\+\+Remove\+Individual (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{update_daemon_2app_8c_a1ff3f06b5329bfe0be75c08ca58eba66}{}\label{update_daemon_2app_8c_a1ff3f06b5329bfe0be75c08ca58eba66}
Remove the named app from the current running system.

\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item L\+E\+\_\+\+OK if successful.
\item L\+E\+\_\+\+N\+O\+T\+\_\+\+F\+O\+U\+ND if requested to remove non-\/existent app.
\item L\+E\+\_\+\+F\+A\+U\+LT for any other failure. 
\end{DoxyItemize}
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the app to remove. \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Set\+Smack\+Perm\+Read\+Only@{app\+\_\+\+Set\+Smack\+Perm\+Read\+Only}}
\index{app\+\_\+\+Set\+Smack\+Perm\+Read\+Only@{app\+\_\+\+Set\+Smack\+Perm\+Read\+Only}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Set\+Smack\+Perm\+Read\+Only(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{app_SetSmackPermReadOnly(const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} app\+\_\+\+Set\+Smack\+Perm\+Read\+Only (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{update_daemon_2app_8c_abd33cfa945c3ac142ba70db27aff490f}{}\label{update_daemon_2app_8c_abd33cfa945c3ac142ba70db27aff490f}
Setup S\+M\+A\+CK permission for contents in app\textquotesingle{}s read-\/only directory.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful, L\+E\+\_\+\+F\+A\+U\+LT if fails. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Md5\+Ptr} & Hash ID of the application to install. \\
\hline
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the application to install. \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Set\+Up\+App\+Writeables@{app\+\_\+\+Set\+Up\+App\+Writeables}}
\index{app\+\_\+\+Set\+Up\+App\+Writeables@{app\+\_\+\+Set\+Up\+App\+Writeables}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Set\+Up\+App\+Writeables(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{app_SetUpAppWriteables(const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} app\+\_\+\+Set\+Up\+App\+Writeables (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{update_daemon_2app_8c_aeb3d48b159b703d931635ef7b026f7f8}{}\label{update_daemon_2app_8c_aeb3d48b159b703d931635ef7b026f7f8}
Set up a given app\textquotesingle{}s writeable files in the \char`\"{}unpack\char`\"{} system.

Files will be copied to the system unpack area based on whether an app with the same name exists in the current system.

\begin{DoxyWarning}{Warning}
Assumes the app identified by the hash is installed in /legato/apps/$<$hash$>$.
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Md5\+Ptr} & Hash ID of the application to install. \\
\hline
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the application to install. \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Exec\+Install\+Hook@{Exec\+Install\+Hook}}
\index{Exec\+Install\+Hook@{Exec\+Install\+Hook}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Exec\+Install\+Hook(const char $\ast$user\+Script\+Path)}{ExecInstallHook(const char *userScriptPath)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Exec\+Install\+Hook (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{user\+Script\+Path}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_ab51e66da860f8fa9403e8191e8d7aa36}{}\label{update_daemon_2app_8c_ab51e66da860f8fa9403e8191e8d7aa36}
Run the specified install script through the system\textquotesingle{}s hook script.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if the script ran successfully, L\+E\+\_\+\+F\+A\+U\+LT otherwise. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em user\+Script\+Path} & Which install hook to execute? \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Exec\+Postinstall\+Hook@{Exec\+Postinstall\+Hook}}
\index{Exec\+Postinstall\+Hook@{Exec\+Postinstall\+Hook}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Exec\+Postinstall\+Hook(const char $\ast$app\+Md5\+Ptr)}{ExecPostinstallHook(const char *appMd5Ptr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Exec\+Postinstall\+Hook (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a6e7131dacc0a6357f4f68050c44d7539}{}\label{update_daemon_2app_8c_a6e7131dacc0a6357f4f68050c44d7539}
Execute the application\textquotesingle{}s postinstall hook. Like the preinstall hook, it is the install-\/hook script that handles the actual execution. \index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Exec\+Preinstall\+Hook@{Exec\+Preinstall\+Hook}}
\index{Exec\+Preinstall\+Hook@{Exec\+Preinstall\+Hook}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Exec\+Preinstall\+Hook(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{ExecPreinstallHook(const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Exec\+Preinstall\+Hook (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a1b0994ea4b19e3eecb731a7429c195d0}{}\label{update_daemon_2app_8c_a1b0994ea4b19e3eecb731a7429c195d0}
Execute the application\textquotesingle{}s preinstall hook, but only if one is supplied. But even then, there\textquotesingle{}s no guarantee that anything will run as the user has to modify their system file script \textquotesingle{}install-\/hook\textquotesingle{} so that it will run the executable file passed in. \index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Import\+Config@{Import\+Config}}
\index{Import\+Config@{Import\+Config}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Import\+Config(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{ImportConfig(const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Import\+Config (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_ad28cbea5b2f409d38ee8373b6ed3f6a2}{}\label{update_daemon_2app_8c_ad28cbea5b2f409d38ee8373b6ed3f6a2}
Import an applications configuration into the system config tree, allowing the supervisor to be able to launch this application. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Md5\+Ptr} & The \hyperlink{class_m_d5}{M\+D5} hash ID for this application. \\
\hline
\mbox{\tt in}  & {\em app\+Name\+Ptr} & The user visible name for this application. \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Perform\+App\+Delete@{Perform\+App\+Delete}}
\index{Perform\+App\+Delete@{Perform\+App\+Delete}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Perform\+App\+Delete(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr, le\+\_\+cfg\+\_\+\+Iterator\+Ref\+\_\+t i)}{PerformAppDelete(const char *appMd5Ptr, const char *appNamePtr, le_cfg_IteratorRef_t i)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Perform\+App\+Delete (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{{\bf le\+\_\+cfg\+\_\+\+Iterator\+Ref\+\_\+t}}]{i}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a478cd27cba1ee57737d388fd3aa6d935}{}\label{update_daemon_2app_8c_a478cd27cba1ee57737d388fd3aa6d935}
Perform application removal. \index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Perform\+App\+Install@{Perform\+App\+Install}}
\index{Perform\+App\+Install@{Perform\+App\+Install}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Perform\+App\+Install(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{PerformAppInstall(const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Perform\+App\+Install (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a0ea8743d86dae157c2238d66101b8e2c}{}\label{update_daemon_2app_8c_a0ea8743d86dae157c2238d66101b8e2c}
Perform an application install.

Assumes the app has not been previously installed. \index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Perform\+App\+Upgrade@{Perform\+App\+Upgrade}}
\index{Perform\+App\+Upgrade@{Perform\+App\+Upgrade}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Perform\+App\+Upgrade(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{PerformAppUpgrade(const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Perform\+App\+Upgrade (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a40306e4cca70c382463e68656d04fc0b}{}\label{update_daemon_2app_8c_a40306e4cca70c382463e68656d04fc0b}
Perform an application upgrade. \index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Set\+Perm\+App\+Writable\+Dir@{Set\+Perm\+App\+Writable\+Dir}}
\index{Set\+Perm\+App\+Writable\+Dir@{Set\+Perm\+App\+Writable\+Dir}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Set\+Perm\+App\+Writable\+Dir(const char $\ast$app\+Writable\+Dir, const char $\ast$app\+Label)}{SetPermAppWritableDir(const char *appWritableDir, const char *appLabel)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Set\+Perm\+App\+Writable\+Dir (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Writable\+Dir, }
\item[{const char $\ast$}]{app\+Label}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a4f17d1fd2e19fbc8f28870bd5fa810d4}{}\label{update_daemon_2app_8c_a4f17d1fd2e19fbc8f28870bd5fa810d4}
Recursively sets the S\+M\+A\+CK permissions for directories under apps writeable directory.

returns L\+E\+\_\+\+OK if successful, L\+E\+\_\+\+F\+A\+U\+LT if fails. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Writable\+Dir} & Path to apps writable directory. \\
\hline
\mbox{\tt in}  & {\em app\+Label} & App S\+M\+A\+CK label. \\
\hline
\end{DoxyParams}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Set\+Smack\+Perm\+Read\+Only\+Dir@{Set\+Smack\+Perm\+Read\+Only\+Dir}}
\index{Set\+Smack\+Perm\+Read\+Only\+Dir@{Set\+Smack\+Perm\+Read\+Only\+Dir}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Set\+Smack\+Perm\+Read\+Only\+Dir(const char $\ast$app\+Md5\+Ptr, const char $\ast$app\+Name\+Ptr)}{SetSmackPermReadOnlyDir(const char *appMd5Ptr, const char *appNamePtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf le\+\_\+result\+\_\+t} Set\+Smack\+Perm\+Read\+Only\+Dir (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Md5\+Ptr, }
\item[{const char $\ast$}]{app\+Name\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a6f0bb921a0022bcaa42e798064160e76}{}\label{update_daemon_2app_8c_a6f0bb921a0022bcaa42e798064160e76}
Recursively sets the permissions for all files and directories in application read-\/only directory.

returns L\+E\+\_\+\+OK if successful, L\+E\+\_\+\+F\+A\+U\+LT if fails. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Md5\+Ptr} & Hash ID of the application to install. \\
\hline
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the application to install. \\
\hline
\end{DoxyParams}


\subsection{Variable Documentation}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!app\+\_\+\+Unpack\+Path@{app\+\_\+\+Unpack\+Path}}
\index{app\+\_\+\+Unpack\+Path@{app\+\_\+\+Unpack\+Path}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{app\+\_\+\+Unpack\+Path}{app_UnpackPath}}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ app\+\_\+\+Unpack\+Path = \char`\"{}/legato/apps/unpack\char`\"{}}\hypertarget{update_daemon_2app_8c_a0d2076594302990a4c6ace287bbb4453}{}\label{update_daemon_2app_8c_a0d2076594302990a4c6ace287bbb4453}
File system path to where apps are unpacked. \index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Install\+Hook\+Script\+Path@{Install\+Hook\+Script\+Path}}
\index{Install\+Hook\+Script\+Path@{Install\+Hook\+Script\+Path}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Install\+Hook\+Script\+Path}{InstallHookScriptPath}}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ Install\+Hook\+Script\+Path = \char`\"{}/legato/systems/current/bin/install-\/hook\char`\"{}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a4609f54012aab62e348646736146d073}{}\label{update_daemon_2app_8c_a4609f54012aab62e348646736146d073}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Post\+Install\+Path@{Post\+Install\+Path}}
\index{Post\+Install\+Path@{Post\+Install\+Path}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Post\+Install\+Path}{PostInstallPath}}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ Post\+Install\+Path = \char`\"{}/legato/apps/\%s/read-\/only/script/post-\/install\char`\"{}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_a3bcdd12ac0ba8bce81c4a2b76a84ba3d}{}\label{update_daemon_2app_8c_a3bcdd12ac0ba8bce81c4a2b76a84ba3d}
\index{update\+Daemon/app.\+c@{update\+Daemon/app.\+c}!Pre\+Install\+Path@{Pre\+Install\+Path}}
\index{Pre\+Install\+Path@{Pre\+Install\+Path}!update\+Daemon/app.\+c@{update\+Daemon/app.\+c}}
\subsubsection[{\texorpdfstring{Pre\+Install\+Path}{PreInstallPath}}]{\setlength{\rightskip}{0pt plus 5cm}const char$\ast$ Pre\+Install\+Path = \char`\"{}/legato/apps/\%s/read-\/only/script/pre-\/install\char`\"{}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{update_daemon_2app_8c_ab9c3d9f804ba2dcb123232c16f054df7}{}\label{update_daemon_2app_8c_ab9c3d9f804ba2dcb123232c16f054df7}
