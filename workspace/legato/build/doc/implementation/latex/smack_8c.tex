\hypertarget{smack_8c}{}\section{framework/liblegato/linux/smack.c File Reference}
\label{smack_8c}\index{framework/liblegato/linux/smack.\+c@{framework/liblegato/linux/smack.\+c}}
{\ttfamily \#include \char`\"{}smack.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}legato.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}limit.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}file\+System.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}file\+Descriptor.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{smack_8c_a009b3ef0f9f4cd4fec2fd594dac9aee2}{S\+M\+A\+C\+K\+\_\+\+FS}~\char`\"{}smack\char`\"{}
\item 
\#define \hyperlink{smack_8c_ad69fa7d3158c43973a5182c13d34bb83}{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR}~\char`\"{}/legato/smack\char`\"{}
\item 
\#define \hyperlink{smack_8c_af7bd5ec675caa416035a56874ea136b4}{S\+M\+A\+C\+K\+\_\+\+L\+O\+A\+D\+\_\+\+F\+I\+LE}~\hyperlink{smack_8c_ad69fa7d3158c43973a5182c13d34bb83}{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/load2\char`\"{}
\item 
\#define \hyperlink{smack_8c_a8eae87d764332c9b66d4d8c0d961a107}{S\+M\+A\+C\+K\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+F\+I\+LE}~\hyperlink{smack_8c_ad69fa7d3158c43973a5182c13d34bb83}{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/access2\char`\"{}
\item 
\#define \hyperlink{smack_8c_aca1a6035bd38532ebfb82f12bceb776a}{S\+M\+A\+C\+K\+\_\+\+R\+E\+V\+O\+K\+E\+\_\+\+F\+I\+LE}~\hyperlink{smack_8c_ad69fa7d3158c43973a5182c13d34bb83}{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/revoke-\/subject\char`\"{}
\item 
\#define \hyperlink{smack_8c_a3cd2e8c105b1d902cd0ebd0cdacdf080}{S\+M\+A\+C\+K\+\_\+\+N\+E\+T\+L\+A\+B\+E\+L\+\_\+\+F\+I\+LE}~\hyperlink{smack_8c_ad69fa7d3158c43973a5182c13d34bb83}{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/netlabel\char`\"{}
\item 
\#define \hyperlink{smack_8c_a85dd99a10b6c50a7148b326839e87d92}{S\+M\+A\+C\+K\+\_\+\+I\+P\+V6\+H\+O\+S\+T\+\_\+\+F\+I\+LE}~\hyperlink{smack_8c_ad69fa7d3158c43973a5182c13d34bb83}{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/ipv6host\char`\"{}
\item 
\#define \hyperlink{smack_8c_a9e0c6977205e848b17203d62519f7621}{P\+R\+O\+C\+\_\+\+S\+M\+A\+C\+K\+\_\+\+F\+I\+LE}~\char`\"{}/proc/self/attr/current\char`\"{}
\item 
\#define \hyperlink{smack_8c_a1df0582400a5a4ab75cf51e5cb7b7a12}{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN}~5
\item 
\#define \hyperlink{smack_8c_a1f1ea3e3c9bfe941fdc8242743cad9d3}{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+B\+Y\+T\+ES}~\hyperlink{smack_8c_a1df0582400a5a4ab75cf51e5cb7b7a12}{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN} + 1
\item 
\#define \hyperlink{smack_8c_afbe6610db61caa565121d1da18a45f5e}{S\+M\+A\+C\+K\+\_\+\+R\+U\+L\+E\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES}~2$\ast$\hyperlink{limit_8h_a1bea74d478b80058137917b5122b2aed}{L\+I\+M\+I\+T\+\_\+\+M\+A\+X\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+E\+L\+\_\+\+L\+EN} + \hyperlink{smack_8c_a1df0582400a5a4ab75cf51e5cb7b7a12}{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN} + 3
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_a9533646c3e9a4522ea3c331d2fa86c35}{Set\+Smack\+Netlabel\+Exceptions} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_a9d6570ccf5a5077cae0f9f44932e1bb7}{Set\+Smack\+I\+Pv6\+Host\+Exceptions} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_a2078f7a3f38418af44de65cba92730f4}{Check\+Label} (const char $\ast$label\+Ptr)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_afef2a56ddf2ead7faaabddb5807a806b}{Make\+Smack\+Mode\+Str} (const char $\ast$mode\+Str, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
static \hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_a6f1d3adb83461cc5c2e13eef14d6f853}{Make\+Rule\+Str} (const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
bool \hyperlink{smack_8c_a62834a7a3134811aaeb0033c0e8af715}{smack\+\_\+\+Is\+Enabled} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_a681949d8c08d48753609c8ed68efc267}{smack\+\_\+\+Init} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_add5cbf8e77184e9ba03ea8446593382e}{smack\+\_\+\+Set\+My\+Label} (const char $\ast$label\+Ptr)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{smack_8c_adc042c6d3c1bc9049463fccfcff585b9}{smack\+\_\+\+Get\+Proc\+Label} (pid\+\_\+t pid, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{smack_8c_af8ed0d3150b8535253b9a42c7847a613}{smack\+\_\+\+Set\+Label} (const char $\ast$obj\+Path\+Ptr, const char $\ast$label\+Ptr)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_ad6dc9b823efc45d900bbd2ba393848ec}{smack\+\_\+\+Set\+Rule} (const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr)
\item 
bool \hyperlink{smack_8c_a4d37d4c51fca54a95f83914bc2d12076}{smack\+\_\+\+Has\+Access} (const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_a7342897f0690e0e7da9350acf8321e0c}{smack\+\_\+\+Revoke\+Subject} (const char $\ast$subject\+Label\+Ptr)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_aa0de3f641219745526a9573936b68f96}{smack\+\_\+\+Get\+App\+Label} (const char $\ast$app\+Name\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void} \hyperlink{smack_8c_aba989a77163254ab2b3fa6880136c0f4}{smack\+\_\+\+Get\+App\+Access\+Label} (const char $\ast$app\+Name\+Ptr, mode\+\_\+t access\+Mode, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{smack_8c_a30a9367abe1cb72785429cc3c5b0aa48}{smack\+\_\+\+Get\+Dev\+Label} (dev\+\_\+t dev\+Id, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This is the implementation of the S\+M\+A\+CK A\+PI.

\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000053}{Todo}]Currently, this implementation writes directly into the smackfs files but we really should use a third party smack library so that we don\textquotesingle{}t need to maintain this implementation when the smackfs file interface changes.\end{DoxyRefDesc}


Copyright (C) Sierra Wireless Inc. 

\subsection{Macro Definition Documentation}
\index{smack.\+c@{smack.\+c}!M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+B\+Y\+T\+ES@{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+B\+Y\+T\+ES}}
\index{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+B\+Y\+T\+ES@{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+B\+Y\+T\+ES}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+B\+Y\+T\+ES}{MAX_ACCESS_MODE_BYTES}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+B\+Y\+T\+ES~{\bf M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN} + 1}\hypertarget{smack_8c_a1f1ea3e3c9bfe941fdc8242743cad9d3}{}\label{smack_8c_a1f1ea3e3c9bfe941fdc8242743cad9d3}
\index{smack.\+c@{smack.\+c}!M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN@{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN}}
\index{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN@{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN}{MAX_ACCESS_MODE_LEN}}]{\setlength{\rightskip}{0pt plus 5cm}\#define M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN~5}\hypertarget{smack_8c_a1df0582400a5a4ab75cf51e5cb7b7a12}{}\label{smack_8c_a1df0582400a5a4ab75cf51e5cb7b7a12}
Maximum access mode string size. \index{smack.\+c@{smack.\+c}!P\+R\+O\+C\+\_\+\+S\+M\+A\+C\+K\+\_\+\+F\+I\+LE@{P\+R\+O\+C\+\_\+\+S\+M\+A\+C\+K\+\_\+\+F\+I\+LE}}
\index{P\+R\+O\+C\+\_\+\+S\+M\+A\+C\+K\+\_\+\+F\+I\+LE@{P\+R\+O\+C\+\_\+\+S\+M\+A\+C\+K\+\_\+\+F\+I\+LE}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{P\+R\+O\+C\+\_\+\+S\+M\+A\+C\+K\+\_\+\+F\+I\+LE}{PROC_SMACK_FILE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+R\+O\+C\+\_\+\+S\+M\+A\+C\+K\+\_\+\+F\+I\+LE~\char`\"{}/proc/self/attr/current\char`\"{}}\hypertarget{smack_8c_a9e0c6977205e848b17203d62519f7621}{}\label{smack_8c_a9e0c6977205e848b17203d62519f7621}
A process\textquotesingle{}s own attribute file that stores the S\+M\+A\+CK label. \index{smack.\+c@{smack.\+c}!S\+M\+A\+C\+K\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+F\+I\+LE}}
\index{S\+M\+A\+C\+K\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+F\+I\+LE}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+F\+I\+LE}{SMACK_ACCESS_FILE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+F\+I\+LE~{\bf S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/access2\char`\"{}}\hypertarget{smack_8c_a8eae87d764332c9b66d4d8c0d961a107}{}\label{smack_8c_a8eae87d764332c9b66d4d8c0d961a107}
S\+M\+A\+CK access file location. \index{smack.\+c@{smack.\+c}!S\+M\+A\+C\+K\+\_\+\+FS@{S\+M\+A\+C\+K\+\_\+\+FS}}
\index{S\+M\+A\+C\+K\+\_\+\+FS@{S\+M\+A\+C\+K\+\_\+\+FS}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+FS}{SMACK_FS}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+FS~\char`\"{}smack\char`\"{}}\hypertarget{smack_8c_a009b3ef0f9f4cd4fec2fd594dac9aee2}{}\label{smack_8c_a009b3ef0f9f4cd4fec2fd594dac9aee2}
Name of the S\+M\+A\+CK file system. \index{smack.\+c@{smack.\+c}!S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR@{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR}}
\index{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR@{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR}{SMACK_FS_DIR}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR~\char`\"{}/legato/smack\char`\"{}}\hypertarget{smack_8c_ad69fa7d3158c43973a5182c13d34bb83}{}\label{smack_8c_ad69fa7d3158c43973a5182c13d34bb83}
Location of the S\+M\+A\+CK file system. \index{smack.\+c@{smack.\+c}!S\+M\+A\+C\+K\+\_\+\+I\+P\+V6\+H\+O\+S\+T\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+I\+P\+V6\+H\+O\+S\+T\+\_\+\+F\+I\+LE}}
\index{S\+M\+A\+C\+K\+\_\+\+I\+P\+V6\+H\+O\+S\+T\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+I\+P\+V6\+H\+O\+S\+T\+\_\+\+F\+I\+LE}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+I\+P\+V6\+H\+O\+S\+T\+\_\+\+F\+I\+LE}{SMACK_IPV6HOST_FILE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+I\+P\+V6\+H\+O\+S\+T\+\_\+\+F\+I\+LE~{\bf S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/ipv6host\char`\"{}}\hypertarget{smack_8c_a85dd99a10b6c50a7148b326839e87d92}{}\label{smack_8c_a85dd99a10b6c50a7148b326839e87d92}
S\+M\+A\+CK ipv6host file location. \index{smack.\+c@{smack.\+c}!S\+M\+A\+C\+K\+\_\+\+L\+O\+A\+D\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+L\+O\+A\+D\+\_\+\+F\+I\+LE}}
\index{S\+M\+A\+C\+K\+\_\+\+L\+O\+A\+D\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+L\+O\+A\+D\+\_\+\+F\+I\+LE}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+L\+O\+A\+D\+\_\+\+F\+I\+LE}{SMACK_LOAD_FILE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+L\+O\+A\+D\+\_\+\+F\+I\+LE~{\bf S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/load2\char`\"{}}\hypertarget{smack_8c_af7bd5ec675caa416035a56874ea136b4}{}\label{smack_8c_af7bd5ec675caa416035a56874ea136b4}
S\+M\+A\+CK load file location. \index{smack.\+c@{smack.\+c}!S\+M\+A\+C\+K\+\_\+\+N\+E\+T\+L\+A\+B\+E\+L\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+N\+E\+T\+L\+A\+B\+E\+L\+\_\+\+F\+I\+LE}}
\index{S\+M\+A\+C\+K\+\_\+\+N\+E\+T\+L\+A\+B\+E\+L\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+N\+E\+T\+L\+A\+B\+E\+L\+\_\+\+F\+I\+LE}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+N\+E\+T\+L\+A\+B\+E\+L\+\_\+\+F\+I\+LE}{SMACK_NETLABEL_FILE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+N\+E\+T\+L\+A\+B\+E\+L\+\_\+\+F\+I\+LE~{\bf S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/netlabel\char`\"{}}\hypertarget{smack_8c_a3cd2e8c105b1d902cd0ebd0cdacdf080}{}\label{smack_8c_a3cd2e8c105b1d902cd0ebd0cdacdf080}
S\+M\+A\+CK netlabel file location. \index{smack.\+c@{smack.\+c}!S\+M\+A\+C\+K\+\_\+\+R\+E\+V\+O\+K\+E\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+R\+E\+V\+O\+K\+E\+\_\+\+F\+I\+LE}}
\index{S\+M\+A\+C\+K\+\_\+\+R\+E\+V\+O\+K\+E\+\_\+\+F\+I\+LE@{S\+M\+A\+C\+K\+\_\+\+R\+E\+V\+O\+K\+E\+\_\+\+F\+I\+LE}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+R\+E\+V\+O\+K\+E\+\_\+\+F\+I\+LE}{SMACK_REVOKE_FILE}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+R\+E\+V\+O\+K\+E\+\_\+\+F\+I\+LE~{\bf S\+M\+A\+C\+K\+\_\+\+F\+S\+\_\+\+D\+IR} \char`\"{}/revoke-\/subject\char`\"{}}\hypertarget{smack_8c_aca1a6035bd38532ebfb82f12bceb776a}{}\label{smack_8c_aca1a6035bd38532ebfb82f12bceb776a}
S\+M\+A\+CK revoke subject file location. \index{smack.\+c@{smack.\+c}!S\+M\+A\+C\+K\+\_\+\+R\+U\+L\+E\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES@{S\+M\+A\+C\+K\+\_\+\+R\+U\+L\+E\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES}}
\index{S\+M\+A\+C\+K\+\_\+\+R\+U\+L\+E\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES@{S\+M\+A\+C\+K\+\_\+\+R\+U\+L\+E\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{S\+M\+A\+C\+K\+\_\+\+R\+U\+L\+E\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES}{SMACK_RULE_STR_BYTES}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+M\+A\+C\+K\+\_\+\+R\+U\+L\+E\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES~2$\ast${\bf L\+I\+M\+I\+T\+\_\+\+M\+A\+X\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+E\+L\+\_\+\+L\+EN} + {\bf M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN} + 3}\hypertarget{smack_8c_afbe6610db61caa565121d1da18a45f5e}{}\label{smack_8c_afbe6610db61caa565121d1da18a45f5e}
S\+M\+A\+CK rule string storage size. 

\subsection{Function Documentation}
\index{smack.\+c@{smack.\+c}!Check\+Label@{Check\+Label}}
\index{Check\+Label@{Check\+Label}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{Check\+Label(const char $\ast$label\+Ptr)}{CheckLabel(const char *labelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Check\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{label\+Ptr}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{smack_8c_a2078f7a3f38418af44de65cba92730f4}{}\label{smack_8c_a2078f7a3f38418af44de65cba92730f4}
Checks whether the given label is a valid S\+M\+A\+CK label.

\begin{DoxyNote}{Note}
If there\textquotesingle{}s an error, this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em label\+Ptr} & Label to check. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!Make\+Rule\+Str@{Make\+Rule\+Str}}
\index{Make\+Rule\+Str@{Make\+Rule\+Str}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{Make\+Rule\+Str(const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{MakeRuleStr(const char *subjectLabelPtr, const char *accessModePtr, const char *objectLabelPtr, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Make\+Rule\+Str (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{subject\+Label\+Ptr, }
\item[{const char $\ast$}]{access\+Mode\+Ptr, }
\item[{const char $\ast$}]{object\+Label\+Ptr, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{smack_8c_a6f1d3adb83461cc5c2e13eef14d6f853}{}\label{smack_8c_a6f1d3adb83461cc5c2e13eef14d6f853}
Creates a S\+M\+A\+CK rule string that conforms to the what S\+M\+A\+CK expects.

\begin{DoxyNote}{Note}
If there is an error this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em subject\+Label\+Ptr} & Subject label. \\
\hline
\mbox{\tt in}  & {\em access\+Mode\+Ptr} & Access mode. \\
\hline
\mbox{\tt in}  & {\em object\+Label\+Ptr} & Object label. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the created rule. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Buffer size. Must be atleast S\+M\+A\+C\+K\+\_\+\+R\+U\+L\+E\+\_\+\+S\+T\+R\+\_\+\+B\+Y\+T\+ES. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!Make\+Smack\+Mode\+Str@{Make\+Smack\+Mode\+Str}}
\index{Make\+Smack\+Mode\+Str@{Make\+Smack\+Mode\+Str}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{Make\+Smack\+Mode\+Str(const char $\ast$mode\+Str, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{MakeSmackModeStr(const char *modeStr, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Make\+Smack\+Mode\+Str (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{mode\+Str, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{smack_8c_afef2a56ddf2ead7faaabddb5807a806b}{}\label{smack_8c_afef2a56ddf2ead7faaabddb5807a806b}
Given a user provided mode string create a mode string that conforms to what S\+M\+A\+CK expects.

\begin{DoxyNote}{Note}
If there\textquotesingle{}is an error, this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em mode\+Str} & User provided mode string. This string can be any combination of mode characters including duplicates. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to hold the mode string that conforms to what smack expects. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer must be more than M\+A\+X\+\_\+\+A\+C\+C\+E\+S\+S\+\_\+\+M\+O\+D\+E\+\_\+\+L\+EN bytes. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!Set\+Smack\+I\+Pv6\+Host\+Exceptions@{Set\+Smack\+I\+Pv6\+Host\+Exceptions}}
\index{Set\+Smack\+I\+Pv6\+Host\+Exceptions@{Set\+Smack\+I\+Pv6\+Host\+Exceptions}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{Set\+Smack\+I\+Pv6\+Host\+Exceptions(void)}{SetSmackIPv6HostExceptions(void)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Set\+Smack\+I\+Pv6\+Host\+Exceptions (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{smack_8c_a9d6570ccf5a5077cae0f9f44932e1bb7}{}\label{smack_8c_a9d6570ccf5a5077cae0f9f44932e1bb7}
Set S\+M\+A\+CK ipv6host exception to grant applications permission to communicate with the Internet. via I\+Pv6. \index{smack.\+c@{smack.\+c}!Set\+Smack\+Netlabel\+Exceptions@{Set\+Smack\+Netlabel\+Exceptions}}
\index{Set\+Smack\+Netlabel\+Exceptions@{Set\+Smack\+Netlabel\+Exceptions}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{Set\+Smack\+Netlabel\+Exceptions(void)}{SetSmackNetlabelExceptions(void)}}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf void} Set\+Smack\+Netlabel\+Exceptions (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{smack_8c_a9533646c3e9a4522ea3c331d2fa86c35}{}\label{smack_8c_a9533646c3e9a4522ea3c331d2fa86c35}
Set S\+M\+A\+CK netlabel exception to grant applications permission to communicate with the Internet via I\+Pv4. \index{smack.\+c@{smack.\+c}!smack\+\_\+\+Get\+App\+Access\+Label@{smack\+\_\+\+Get\+App\+Access\+Label}}
\index{smack\+\_\+\+Get\+App\+Access\+Label@{smack\+\_\+\+Get\+App\+Access\+Label}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Get\+App\+Access\+Label(const char $\ast$app\+Name\+Ptr, mode\+\_\+t access\+Mode, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{smack_GetAppAccessLabel(const char *appNamePtr, mode_t accessMode, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Get\+App\+Access\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{mode\+\_\+t}]{access\+Mode, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_aba989a77163254ab2b3fa6880136c0f4}{}\label{smack_8c_aba989a77163254ab2b3fa6880136c0f4}
Get\textquotesingle{}s the application\textquotesingle{}s smack label with the user\textquotesingle{}s access mode appended to it as a string. For example, if the access\+Mode is S\+\_\+\+I\+R\+U\+SR $\vert$ S\+\_\+\+I\+W\+U\+SR then \char`\"{}rw\char`\"{} will be appended to the application\textquotesingle{}s smack label. The groups and other bits of access\+Mode are ignored. If the user\textquotesingle{}s access\+Mode is 0 (empty) then \char`\"{}-\/\char`\"{} will be appended to the app\textquotesingle{}s smack label.

\begin{DoxyNote}{Note}
The application need not be installed for this function to succeed.
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
This function kills the calling process if there is an error such as if the buffer is too small. 
\end{DoxyWarning}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the application. \\
\hline
\mbox{\tt in}  & {\em access\+Mode} & Access mode. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the proc\textquotesingle{}s S\+M\+A\+CK label. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Get\+App\+Label@{smack\+\_\+\+Get\+App\+Label}}
\index{smack\+\_\+\+Get\+App\+Label@{smack\+\_\+\+Get\+App\+Label}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Get\+App\+Label(const char $\ast$app\+Name\+Ptr, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{smack_GetAppLabel(const char *appNamePtr, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Get\+App\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{app\+Name\+Ptr, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_aa0de3f641219745526a9573936b68f96}{}\label{smack_8c_aa0de3f641219745526a9573936b68f96}
Gets an application\textquotesingle{}s S\+M\+A\+CK label.

\begin{DoxyNote}{Note}
The application need not be installed for this function to succeed.
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
This function kills the calling process if there is an error such as if the buffer is too small. 
\end{DoxyWarning}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em app\+Name\+Ptr} & Name of the application. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the proc\textquotesingle{}s S\+M\+A\+CK label. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Get\+Dev\+Label@{smack\+\_\+\+Get\+Dev\+Label}}
\index{smack\+\_\+\+Get\+Dev\+Label@{smack\+\_\+\+Get\+Dev\+Label}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Get\+Dev\+Label(dev\+\_\+t dev\+Id, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{smack_GetDevLabel(dev_t devId, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} smack\+\_\+\+Get\+Dev\+Label (
\begin{DoxyParamCaption}
\item[{dev\+\_\+t}]{dev\+Id, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_a30a9367abe1cb72785429cc3c5b0aa48}{}\label{smack_8c_a30a9367abe1cb72785429cc3c5b0aa48}
Gets a S\+M\+A\+CK label for a device file from the device ID.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if the label was successfully returned in the provided buffer. L\+E\+\_\+\+O\+V\+E\+R\+F\+L\+OW if the label could not fit in the provided buffer. L\+E\+\_\+\+F\+A\+U\+LT if there was an error. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em dev\+Id} & Device ID. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to hold the S\+M\+A\+CK label for the device. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Get\+Proc\+Label@{smack\+\_\+\+Get\+Proc\+Label}}
\index{smack\+\_\+\+Get\+Proc\+Label@{smack\+\_\+\+Get\+Proc\+Label}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Get\+Proc\+Label(pid\+\_\+t pid, char $\ast$buf\+Ptr, size\+\_\+t buf\+Size)}{smack_GetProcLabel(pid_t pid, char *bufPtr, size_t bufSize)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} smack\+\_\+\+Get\+Proc\+Label (
\begin{DoxyParamCaption}
\item[{pid\+\_\+t}]{pid, }
\item[{char $\ast$}]{buf\+Ptr, }
\item[{size\+\_\+t}]{buf\+Size}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_adc042c6d3c1bc9049463fccfcff585b9}{}\label{smack_8c_adc042c6d3c1bc9049463fccfcff585b9}
Get\textquotesingle{}s a process\textquotesingle{}s smack label.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if successful. L\+E\+\_\+\+O\+V\+E\+R\+F\+L\+OW if the supplied buffer is too small to hold the smack label. L\+E\+\_\+\+F\+A\+U\+LT if there was an error. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em pid} & P\+ID of the process. \\
\hline
\mbox{\tt out}  & {\em buf\+Ptr} & Buffer to store the proc\textquotesingle{}s S\+M\+A\+CK label. \\
\hline
\mbox{\tt in}  & {\em buf\+Size} & Size of the buffer. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Has\+Access@{smack\+\_\+\+Has\+Access}}
\index{smack\+\_\+\+Has\+Access@{smack\+\_\+\+Has\+Access}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Has\+Access(const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr)}{smack_HasAccess(const char *subjectLabelPtr, const char *accessModePtr, const char *objectLabelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}bool smack\+\_\+\+Has\+Access (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{subject\+Label\+Ptr, }
\item[{const char $\ast$}]{access\+Mode\+Ptr, }
\item[{const char $\ast$}]{object\+Label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_a4d37d4c51fca54a95f83914bc2d12076}{}\label{smack_8c_a4d37d4c51fca54a95f83914bc2d12076}
Checks whether a subject has the specified access mode for an object.

\begin{DoxyReturn}{Returns}
true if the subject has the specified access mode for the object. false if the subject doesn\textquotesingle{}t have the specified access mode for the object. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em subject\+Label\+Ptr} & Subject label. \\
\hline
\mbox{\tt in}  & {\em access\+Mode\+Ptr} & Access mode. \\
\hline
\mbox{\tt in}  & {\em object\+Label\+Ptr} & Object label. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Init@{smack\+\_\+\+Init}}
\index{smack\+\_\+\+Init@{smack\+\_\+\+Init}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Init(void)}{smack_Init(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Init (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_a681949d8c08d48753609c8ed68efc267}{}\label{smack_8c_a681949d8c08d48753609c8ed68efc267}
Initializes the S\+M\+A\+CK system. Mounts the smack file system.

\begin{DoxyNote}{Note}
Should be called once for the entire system, subsequent calls to this function will have no effect. Must be called before any of the other functions in this A\+PI is called.

Failures will cause the calling process to exit. 
\end{DoxyNote}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Is\+Enabled@{smack\+\_\+\+Is\+Enabled}}
\index{smack\+\_\+\+Is\+Enabled@{smack\+\_\+\+Is\+Enabled}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Is\+Enabled(void)}{smack_IsEnabled(void)}}]{\setlength{\rightskip}{0pt plus 5cm}bool smack\+\_\+\+Is\+Enabled (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_a62834a7a3134811aaeb0033c0e8af715}{}\label{smack_8c_a62834a7a3134811aaeb0033c0e8af715}
Shows whether S\+M\+A\+CK is enabled or disabled in the Legato Framework.

\begin{DoxyReturn}{Returns}
true if S\+M\+A\+CK is enabled. false if S\+M\+A\+CK is disabled. 
\end{DoxyReturn}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Revoke\+Subject@{smack\+\_\+\+Revoke\+Subject}}
\index{smack\+\_\+\+Revoke\+Subject@{smack\+\_\+\+Revoke\+Subject}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Revoke\+Subject(const char $\ast$subject\+Label\+Ptr)}{smack_RevokeSubject(const char *subjectLabelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Revoke\+Subject (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{subject\+Label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_a7342897f0690e0e7da9350acf8321e0c}{}\label{smack_8c_a7342897f0690e0e7da9350acf8321e0c}
Revokes all the access rights for a subject that was given by explicit S\+M\+A\+CK rules.

\begin{DoxyNote}{Note}
If there\textquotesingle{}s an error, this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em subject\+Label\+Ptr} & Subject label. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Set\+Label@{smack\+\_\+\+Set\+Label}}
\index{smack\+\_\+\+Set\+Label@{smack\+\_\+\+Set\+Label}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Set\+Label(const char $\ast$obj\+Path\+Ptr, const char $\ast$label\+Ptr)}{smack_SetLabel(const char *objPathPtr, const char *labelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} smack\+\_\+\+Set\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{obj\+Path\+Ptr, }
\item[{const char $\ast$}]{label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_af8ed0d3150b8535253b9a42c7847a613}{}\label{smack_8c_af8ed0d3150b8535253b9a42c7847a613}
Sets the smack label of a file system object. The calling process must be a privileged process.

\begin{DoxyReturn}{Returns}
L\+E\+\_\+\+OK if the label was set correctly. L\+E\+\_\+\+F\+A\+U\+LT if there was an error. 
\end{DoxyReturn}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em obj\+Path\+Ptr} & Path to the object. \\
\hline
\mbox{\tt in}  & {\em label\+Ptr} & Label to set the object to. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Set\+My\+Label@{smack\+\_\+\+Set\+My\+Label}}
\index{smack\+\_\+\+Set\+My\+Label@{smack\+\_\+\+Set\+My\+Label}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Set\+My\+Label(const char $\ast$label\+Ptr)}{smack_SetMyLabel(const char *labelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Set\+My\+Label (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_add5cbf8e77184e9ba03ea8446593382e}{}\label{smack_8c_add5cbf8e77184e9ba03ea8446593382e}
Sets the smack label of the calling process. The calling process must be a privileged process.

\begin{DoxyNote}{Note}
If there\textquotesingle{}s an error, this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em label\+Ptr} & Label to set the calling process to. \\
\hline
\end{DoxyParams}
\index{smack.\+c@{smack.\+c}!smack\+\_\+\+Set\+Rule@{smack\+\_\+\+Set\+Rule}}
\index{smack\+\_\+\+Set\+Rule@{smack\+\_\+\+Set\+Rule}!smack.\+c@{smack.\+c}}
\subsubsection[{\texorpdfstring{smack\+\_\+\+Set\+Rule(const char $\ast$subject\+Label\+Ptr, const char $\ast$access\+Mode\+Ptr, const char $\ast$object\+Label\+Ptr)}{smack_SetRule(const char *subjectLabelPtr, const char *accessModePtr, const char *objectLabelPtr)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf void} smack\+\_\+\+Set\+Rule (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{subject\+Label\+Ptr, }
\item[{const char $\ast$}]{access\+Mode\+Ptr, }
\item[{const char $\ast$}]{object\+Label\+Ptr}
\end{DoxyParamCaption}
)}\hypertarget{smack_8c_ad6dc9b823efc45d900bbd2ba393848ec}{}\label{smack_8c_ad6dc9b823efc45d900bbd2ba393848ec}
Sets an explicit smack rule.

An explicit smack rule defines a subject\textquotesingle{}s access to an object. The access mode can be any combination of the following. \begin{DoxyVerb} r: read access should be granted.
 w: write access should be granted.
 x: execute access should be granted.
 a: append access should be granted.
 -: used as a place holder.
\end{DoxyVerb}


For example\+: \char`\"{}rx\char`\"{} means read and execute access should be granted. \char`\"{}-\/\char`\"{} means that no access should be granted.

\begin{DoxyNote}{Note}
If there\textquotesingle{}s an error, this function will kill the calling process. 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em subject\+Label\+Ptr} & Subject label. \\
\hline
\mbox{\tt in}  & {\em access\+Mode\+Ptr} & Access mode. See the function description for details. \\
\hline
\mbox{\tt in}  & {\em object\+Label\+Ptr} & Object label. \\
\hline
\end{DoxyParams}
