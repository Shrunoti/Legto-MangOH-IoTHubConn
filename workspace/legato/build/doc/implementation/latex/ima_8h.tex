\hypertarget{ima_8h}{}\section{framework/liblegato/linux/ima.h File Reference}
\label{ima_8h}\index{framework/liblegato/linux/ima.\+h@{framework/liblegato/linux/ima.\+h}}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{ima_8h_af1089aff59a989c64c896dc61feaf752}{P\+U\+B\+\_\+\+C\+E\+R\+T\+\_\+\+N\+A\+ME}~\char`\"{}ima\+\_\+pub.\+cert\char`\"{}
\item 
\#define \hyperlink{ima_8h_acd323fb6be694e70c3ffaa6543b819f1}{I\+M\+A\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+EL}~\char`\"{}ima\+Legato\char`\"{}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{ima_8h_af504c4032f516986b48015c75135edd2}{ima\+\_\+\+Is\+Enabled} (\hyperlink{_t_e_m_p_l_a_t_e__cdef_8h_ac9c84fa68bbad002983e35ce3663c686}{void})
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{ima_8h_a8b535fc6c48361313ac807326affb534}{ima\+\_\+\+Import\+Public\+Cert} (const char $\ast$cert\+Path)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{ima_8h_a11bf66903144e076ecda77a3f48e79ea}{ima\+\_\+\+Verify\+File} (const char $\ast$file\+Path, const char $\ast$cert\+Path)
\item 
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\+\_\+result\+\_\+t} \hyperlink{ima_8h_a10ab900e7ace70e28fba1274dee35538}{ima\+\_\+\+Verify\+Dir} (const char $\ast$dir\+Path, const char $\ast$cert\+Path)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Provides interfaces that can be used to import I\+MA keys (into the kernel keyring) and verify I\+MA signatures.

This file exposes interfaces that are for use by highly privileged framework daemons implementation, but must not be used outside of the framework implementation.

Copyright (C) Sierra Wireless Inc. 

\subsection{Macro Definition Documentation}
\index{ima.\+h@{ima.\+h}!I\+M\+A\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+EL@{I\+M\+A\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+EL}}
\index{I\+M\+A\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+EL@{I\+M\+A\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+EL}!ima.\+h@{ima.\+h}}
\subsubsection[{\texorpdfstring{I\+M\+A\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+EL}{IMA_SMACK_LABEL}}]{\setlength{\rightskip}{0pt plus 5cm}\#define I\+M\+A\+\_\+\+S\+M\+A\+C\+K\+\_\+\+L\+A\+B\+EL~\char`\"{}ima\+Legato\char`\"{}}\hypertarget{ima_8h_acd323fb6be694e70c3ffaa6543b819f1}{}\label{ima_8h_acd323fb6be694e70c3ffaa6543b819f1}
Smack label used for protecting data files \index{ima.\+h@{ima.\+h}!P\+U\+B\+\_\+\+C\+E\+R\+T\+\_\+\+N\+A\+ME@{P\+U\+B\+\_\+\+C\+E\+R\+T\+\_\+\+N\+A\+ME}}
\index{P\+U\+B\+\_\+\+C\+E\+R\+T\+\_\+\+N\+A\+ME@{P\+U\+B\+\_\+\+C\+E\+R\+T\+\_\+\+N\+A\+ME}!ima.\+h@{ima.\+h}}
\subsubsection[{\texorpdfstring{P\+U\+B\+\_\+\+C\+E\+R\+T\+\_\+\+N\+A\+ME}{PUB_CERT_NAME}}]{\setlength{\rightskip}{0pt plus 5cm}\#define P\+U\+B\+\_\+\+C\+E\+R\+T\+\_\+\+N\+A\+ME~\char`\"{}ima\+\_\+pub.\+cert\char`\"{}}\hypertarget{ima_8h_af1089aff59a989c64c896dc61feaf752}{}\label{ima_8h_af1089aff59a989c64c896dc61feaf752}
Name of I\+MA public certificate. 

\subsection{Function Documentation}
\index{ima.\+h@{ima.\+h}!ima\+\_\+\+Import\+Public\+Cert@{ima\+\_\+\+Import\+Public\+Cert}}
\index{ima\+\_\+\+Import\+Public\+Cert@{ima\+\_\+\+Import\+Public\+Cert}!ima.\+h@{ima.\+h}}
\subsubsection[{\texorpdfstring{ima\+\_\+\+Import\+Public\+Cert(const char $\ast$cert\+Path)}{ima_ImportPublicCert(const char *certPath)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} ima\+\_\+\+Import\+Public\+Cert (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{cert\+Path}
\end{DoxyParamCaption}
)}\hypertarget{ima_8h_a8b535fc6c48361313ac807326affb534}{}\label{ima_8h_a8b535fc6c48361313ac807326affb534}
Import I\+MA public certificate to linux keyring. Public certificate must be signed by system private key to import it properly.

\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item L\+E\+\_\+\+OK if imports properly
\item L\+E\+\_\+\+F\+A\+U\+LT if fails to import
\end{DoxyItemize}
\end{DoxyReturn}
Import I\+MA public certificate to linux keyring. Public certificate must be signed by system private key to import it properly. Only privileged process with right permission and smack label will be able to do that.

\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item L\+E\+\_\+\+OK if imports properly
\item L\+E\+\_\+\+F\+A\+U\+LT if fails to import 
\end{DoxyItemize}
\end{DoxyReturn}
\index{ima.\+h@{ima.\+h}!ima\+\_\+\+Is\+Enabled@{ima\+\_\+\+Is\+Enabled}}
\index{ima\+\_\+\+Is\+Enabled@{ima\+\_\+\+Is\+Enabled}!ima.\+h@{ima.\+h}}
\subsubsection[{\texorpdfstring{ima\+\_\+\+Is\+Enabled(void)}{ima_IsEnabled(void)}}]{\setlength{\rightskip}{0pt plus 5cm}bool ima\+\_\+\+Is\+Enabled (
\begin{DoxyParamCaption}
\item[{{\bf void}}]{}
\end{DoxyParamCaption}
)}\hypertarget{ima_8h_af504c4032f516986b48015c75135edd2}{}\label{ima_8h_af504c4032f516986b48015c75135edd2}
Check whether current linux kernel is I\+M\+A-\/enabled or not.

\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item true if I\+MA is enabled.
\item false otherwise. 
\end{DoxyItemize}
\end{DoxyReturn}
\index{ima.\+h@{ima.\+h}!ima\+\_\+\+Verify\+Dir@{ima\+\_\+\+Verify\+Dir}}
\index{ima\+\_\+\+Verify\+Dir@{ima\+\_\+\+Verify\+Dir}!ima.\+h@{ima.\+h}}
\subsubsection[{\texorpdfstring{ima\+\_\+\+Verify\+Dir(const char $\ast$dir\+Path, const char $\ast$cert\+Path)}{ima_VerifyDir(const char *dirPath, const char *certPath)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} ima\+\_\+\+Verify\+Dir (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{dir\+Path, }
\item[{const char $\ast$}]{cert\+Path}
\end{DoxyParamCaption}
)}\hypertarget{ima_8h_a10ab900e7ace70e28fba1274dee35538}{}\label{ima_8h_a10ab900e7ace70e28fba1274dee35538}
Recursively traverse the directory and verify each file I\+MA signature against provided public certificate path

\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item L\+E\+\_\+\+OK on success
\item L\+E\+\_\+\+F\+A\+U\+LT otherwise 
\end{DoxyItemize}
\end{DoxyReturn}
\index{ima.\+h@{ima.\+h}!ima\+\_\+\+Verify\+File@{ima\+\_\+\+Verify\+File}}
\index{ima\+\_\+\+Verify\+File@{ima\+\_\+\+Verify\+File}!ima.\+h@{ima.\+h}}
\subsubsection[{\texorpdfstring{ima\+\_\+\+Verify\+File(const char $\ast$file\+Path, const char $\ast$cert\+Path)}{ima_VerifyFile(const char *filePath, const char *certPath)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf le\+\_\+result\+\_\+t} ima\+\_\+\+Verify\+File (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{file\+Path, }
\item[{const char $\ast$}]{cert\+Path}
\end{DoxyParamCaption}
)}\hypertarget{ima_8h_a11bf66903144e076ecda77a3f48e79ea}{}\label{ima_8h_a11bf66903144e076ecda77a3f48e79ea}
Verify a file I\+MA signature against provided public certificate path

\begin{DoxyReturn}{Returns}

\begin{DoxyItemize}
\item L\+E\+\_\+\+OK on success
\item L\+E\+\_\+\+F\+A\+U\+LT otherwise 
\end{DoxyItemize}
\end{DoxyReturn}
