<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LEGATO: Common File Format</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/javascript">
//<![CDATA[
    // Detect if doc is served by eclipse
    if( ( (window.location.hostname == "127.0.0.1") || (window.location.hostname == "localhost") ) &&
        ( (window.location.port != "") && (window.location.port != 80) && (window.location.port != 443) ) )
    {
        // Inhibit init function from navtree
        initNavTree = function(toroot,relpath) {}
        $(document).ready(function(){
            navTree = document.getElementById("side-nav");
            if(navTree)
            {
                navTree.parentElement.removeChild(navTree);
            }
            $("#doc-content").css('margin-left',10);
        });
    }
//]]>
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="index.html" title="Legato">
      <img alt="Logo" src="legatoLogo.png"/>
    </a>
    <div id="projectbrief">Simplifying IoT development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('defFilesFormat.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Common File Format </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>All of the definition files have the same format. They're divided into sections. Each section type has a set of permitted content, which could be simple, numerical or text values, named items, or other sections (subsections).</p>
<h1><a class="anchor" id="defFileFormatSections"></a>
Sections</h1>
<p>A section always starts with a section name followed by a colon (':').</p>
<div class="fragment"><div class="line">faultAction: restart</div><div class="line"></div><div class="line">maxFileSystemBytes: 200K</div></div><!-- fragment --><p>Sections that can have multiple content items always have curly braces around their content.</p>
<div class="fragment"><div class="line">sources:</div><div class="line">{</div><div class="line">    helloWorld.c</div><div class="line">    myClass.cpp</div><div class="line">}</div></div><!-- fragment --><p>All sections are optional; they can be empty or omitted.</p>
<p>Sections can be in any order, multiple occurrences are permitted, and some sections have sub-sections.</p>
<div class="fragment"><div class="line">requires:</div><div class="line">{</div><div class="line">    file:</div><div class="line">    {</div><div class="line">        /dev/ttyS0  /dev/uart</div><div class="line">    }</div><div class="line"></div><div class="line">    file:</div><div class="line">    {</div><div class="line">        /tmp/foo  /tmp/</div><div class="line">    }</div><div class="line"></div><div class="line">    dir:</div><div class="line">    {</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="defFileFormatNamedItems"></a>
Named Items</h1>
<p>A named item always begins with the item name followed by an equals sign ('=').</p>
<div class="fragment"><div class="line">myPool = 45</div></div><!-- fragment --><p>If a named item can have multiple content items, then it must have curly braces around its content.</p>
<div class="fragment"><div class="line">myExe = { myComponent otherComponent }</div></div><!-- fragment --><h1><a class="anchor" id="defFileFormatNumberValues"></a>
Numerical Values</h1>
<p>Integers are required in some sections.</p>
<div class="fragment"><div class="line">maxFileDescriptors: 100</div></div><!-- fragment --><p>Numbers can be expressed in multiples of 1024 by adding the 'K' suffix.</p>
<div class="fragment"><div class="line">maxFileSystemBytes: 120K</div></div><!-- fragment --><h1><a class="anchor" id="defFileFormatTextValues"></a>
Text Values</h1>
<p>Some sections contain text-based values. The format of these varies depending on the type of section.</p>
<h1><a class="anchor" id="defFileFormatUsingEnvVarsIn"></a>
Environment Variables</h1>
<p>It's possible to use environment variables inside of <code>.sdef</code>, <code>.adef</code>, and <code>Component.cdef</code> files.</p>
<p>This works the same way as in shell scripts, by prefixing the environment variable name with a dollar sign ($):</p>
<div class="fragment"><div class="line">requires:</div><div class="line">{</div><div class="line">    <a class="code" href="namespaceapi.html">api</a>:</div><div class="line">    {</div><div class="line">        $BUILD_ROOT/interfaces/httpdCtrl.api</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>If necessary, the variable name can also be enclosed in curly braces.</p>
<div class="fragment"><div class="line">requires:</div><div class="line">{</div><div class="line">    <a class="code" href="namespaceapi.html">api</a>:</div><div class="line">    {</div><div class="line">        ${PRODUCT_FAMILY}_interfaces/httpdCtrl.api</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>A double dollar sign ('$$') is replaced by a dollar sign ('$').</p>
<p>Furthermore, the mk tools will create some environment variables:</p>
<ul>
<li><code>LEGATO_ROOT</code> = path to where the Legato framework sources are located</li>
<li><code>LEGATO_TARGET</code> = build target (e.g., wp85, localhost)</li>
<li><code>LEGATO_BUILD</code> = shorthand for <code>$LEGATO_ROOT/build/$TARGET</code></li>
<li><code>LEGATO_SYSROOT</code> = path of the directory containing the target device's system files</li>
<li><code>CURDIR</code> = path of the directory containing the definition file being parsed</li>
<li><code>CC</code> = path to the C compiler</li>
<li><code>CXX</code> = path to the C++ compiler</li>
<li><code>LD</code> = path to the linker</li>
<li><code>AR</code> = path to the archiver to be used to generate static libraries</li>
<li><code>AS</code> = path to the assembler to be used if assembly code source files are found</li>
<li><code>STRIP</code> = path to the debug symbol stripper utility</li>
<li><code>OBJCOPY</code> = path to the object file copier/translator utility</li>
<li><code>READELF</code> = path to the ELF file information extractor utility</li>
</ul>
<h1><a class="anchor" id="defFileFormatIncludeDirectives"></a>
Include Directives</h1>
<p>Definition file sections or parts of a section may be common between several related systems, applications or components. For example, all systems built for a certain module may need the some common <code>buildVars</code> or <code>cflags</code> set, or a series of related products may all share a base set of apps. To reuse common parts of the definition file, these parts can be separated into a common file, which is then included in each definition file where it is needed. This is done through include directives.</p>
<p>Include directives consist of the word <code>#include</code> followed by the name of the file to include. For example</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include baseBuildVars.inc</span></div></div><!-- fragment --><p>will be treated as if the contents of baseBuildVars.inc appeared at this point. Multiple include directives can be used to include multiple files.</p>
<p>When looking for a file to include, environment variables in the filename will be expanded first. If the filename is absolute, that file will be included. If it is relative, first the directory containing the current file will be searched, followed by the <code>${LEGATO_ROOT}</code> directory.</p>
<dl class="section note"><dt>Note</dt><dd>If an environment variable is used in an include filename the value of that environment variable can't be changed in a later <code>buildVars</code> section.</dd></dl>
<h1><a class="anchor" id="defFileFormatIfDirectives"></a>
If Directives</h1>
<p>Some definition file sections or parts of sections may be needed only on certain targets, or in certain configurations. To handle conditionals like this, definition files support the <code>#if</code>, <code>#elif</code>, <code>#else</code>, and <code>#endif</code> directives. These function much like their C counterparts, allowing you to include or exclude certain sections of a Xdef file.</p>
<p>If directives consist of an initial <code>#if</code> directive, zero or more <code>#elif</code> directives, optionally an <code>#else</code> directive then a final <code>#endif</code> directive marking the end of the conditional section. For example:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#if ${INCLUDE_FEATURE} = 1</span></div><div class="line">    <span class="comment">// Definitions to be used if INCLUDE_FEATURE is 1</span></div><div class="line"><span class="preprocessor">#elif dir_exists(apps/optional_app)</span></div><div class="line">    <span class="comment">// Definitions to be used if INCLUDE_FEATURE is not 1 but apps/optional_app exists</span></div><div class="line"><span class="preprocessor">#else</span></div><div class="line">    <span class="comment">// Definitions to be used if none of the above are true</span></div><div class="line"><span class="preprocessor">#endif</span></div></div><!-- fragment --><p>Conditions which can be used with <code>#if</code> directives are:</p>
<ul>
<li><code>left_hand_side = right_hand_side</code>: Check if left_hand_side is equal to right_hand_side after expanding environment variables. Example uses are setting different compiler flags depending on the target, or including certain apps only if a specific feature is enabled.</li>
<li><code>dir_exists(dirpath)</code>: Checks if the directory <code>dirpath</code> exists. Relative paths are relative to the directory containing the file being processed. Example uses include building a component from source if the source is available, or using a pre-built binary module if not.</li>
<li><code>file_exists(filepath)</code>: Checks if the file <code>filepath</code> exists. Relative paths are relative to the directory containing the file being processed. Uses are similar to <code>dir_exists</code>.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This feature is most commonly used in included files. In a top level file it is usually easier to write a separate definition file for each configuration, or move target-specific portions into a target-specific include file.</dd></dl>
<h1><a class="anchor" id="defFileFormatWhitespace"></a>
Whitespace</h1>
<p>Tabs, spaces, new-lines, carriage-returns and comments act as token separators only, and are otherwise all ignored. Consequently, choice of indentation and spacing style is relatively unrestricted.</p>
<h1><a class="anchor" id="defFileFormatComments"></a>
Comments</h1>
<p>Comments can be included using </p><div class="fragment"><div class="line"><span class="comment">// C++-style one-line comments.</span></div><div class="line"></div><div class="line"><span class="comment">/* or</span></div><div class="line"><span class="comment">   C-style multi-line comments. */</span></div></div><!-- fragment --><h1><a class="anchor" id="defFileFormatSample"></a>
Sample</h1>
<div class="fragment"><div class="line"><span class="comment">/* Component.cdef file for a hypothetical web server component that provides a control API</span></div><div class="line"><span class="comment"> * (defined in httpdCtrl.api) that allows other apps to start and stop the web server via IPC.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"></div><div class="line"><span class="preprocessor">#include &quot;targets/${LEGATO_TARGET}.def&quot;</span></div><div class="line"></div><div class="line">bundles:</div><div class="line">{</div><div class="line">    <span class="comment">// Include all the web pages from the build host in the application, and have them appear</span></div><div class="line">    <span class="comment">// to the application under /var/www.</span></div><div class="line">    dir:</div><div class="line">    {</div><div class="line">        htdocs   /var/www</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">provides :     <span class="comment">// Note that space is allowed between the section name and the colon.</span></div><div class="line">{</div><div class="line">    <a class="code" href="namespaceapi.html">api</a>:    {   httpdCtrl.api</div><div class="line">            }</div><div class="line">}</div><div class="line"></div><div class="line">sources: {httpd.c}</div></div><!-- fragment --><p>Copyright (C) Sierra Wireless Inc. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.11
        </div>
    </div>
</body>
</html>
