<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LEGATO: Modem Data Control SDD</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/javascript">
//<![CDATA[
    // Detect if doc is served by eclipse
    if( ( (window.location.hostname == "127.0.0.1") || (window.location.hostname == "localhost") ) &&
        ( (window.location.port != "") && (window.location.port != 80) && (window.location.port != 443) ) )
    {
        // Inhibit init function from navtree
        initNavTree = function(toroot,relpath) {}
        $(document).ready(function(){
            navTree = document.getElementById("side-nav");
            if(navTree)
            {
                navTree.parentElement.removeChild(navTree);
            }
            $("#doc-content").css('margin-left',10);
        });
    }
//]]>
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="index.html" title="Legato">
      <img alt="Logo" src="legatoLogo.png"/>
    </a>
    <div id="projectbrief">Simplifying IoT development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('c_SDD_mdc.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Modem Data Control SDD </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="mdc_service"></a>
MDC Service</h1>
<h2><a class="anchor" id="Overview"></a>
Overview</h2>
<p>A data session is useful for applications that need to send or receive data over a network. To start a data session, a data profile must be configured as specified by the target network.</p>
<p>The Modem Data Control (MDC) API is used to manage data profiles and data sessions.</p>
<h2><a class="anchor" id="mdc_dataProfile"></a>
Data profiles</h2>
<p>If a pre-defined data profile has been configured then this profile can be loaded using <a class="el" href="le__mdc__interface_8h.html#a638b693cd5f644fa5c24f81e1e36483c">le_mdc_GetProfile()</a>. <a class="el" href="le__mdc__interface_8h.html#a638b693cd5f644fa5c24f81e1e36483c">le_mdc_GetProfile()</a> must be called with LE_MDC_DEFAULT_PROFILE to retrieve the default index used by the modem for data connection. <a class="el" href="le__mdc__interface_8h.html#a638b693cd5f644fa5c24f81e1e36483c">le_mdc_GetProfile()</a> must be called with LE_MDC_SIMTOOLKIT_BIP_DEFAULT_PROFILE to retrieve the default index used by the modem for Bearer Independent Protocol (BIP).</p>
<dl class="section warning"><dt>Warning</dt><dd>0 is not a valid index.</dd></dl>
<p>The following data profile parameters can be retrieved: </p><pre class="fragment">Packet Data Protocol using le_mdc_GetPDP().
Access Point Name using le_mdc_GetAPN().
Authentication settings using le_mdc_GetAuthentication().
</pre><p>The following data profile parameters can be set: </p><pre class="fragment">Packet Data Protocol using le_mdc_SetPDP().
Access Point Name using le_mdc_SetAPN().
Authentication settings using le_mdc_SetAuthentication().
</pre><p>The following sample code demonstrates data profile parameters: </p><div class="fragment"><div class="line"></div><div class="line">    <span class="comment">// Get the profile reference</span></div><div class="line">    *profileRefPtr = <a class="code" href="le__mdc__interface_8h.html#a638b693cd5f644fa5c24f81e1e36483c">le_mdc_GetProfile</a>(profile);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(NULL != *profileRefPtr);</div><div class="line"></div><div class="line">    <span class="comment">// Check the current state of the cid</span></div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#a0727e543d0394422963c8d6297947333">le_mdc_ConState_t</a> state = <a class="code" href="le__mdc__interface_8h.html#a0727e543d0394422963c8d6297947333a6d11ee963528c79d73a269eb85202ba7">LE_MDC_DISCONNECTED</a>;</div><div class="line"></div><div class="line">    <span class="comment">// Check the state</span></div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(LE_OK == <a class="code" href="le__mdc__interface_8h.html#add91c364e8b3e4e82a0ce64e480c016b">le_mdc_GetSessionState</a>(*profileRefPtr, &amp;state));</div><div class="line"></div><div class="line">    <span class="comment">// If already connected, disconnect the session</span></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="le__mdc__interface_8h.html#a0727e543d0394422963c8d6297947333a0a8a2113935b881b76c59b94cf7223b8">LE_MDC_CONNECTED</a> == state)</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(<a class="code" href="le__mdc__interface_8h.html#a53453f85065c3cace0922150b7e3d869">le_mdc_StopSession</a>(*profileRefPtr) == LE_OK);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Set pdp type</span></div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#a85721ec6046140c2f87c23f877dce247">le_mdc_Pdp_t</a> pdp = <a class="code" href="le__mdc__interface_8h.html#a85721ec6046140c2f87c23f877dce247a590fd5c933c3751e42053f996d530987">LE_MDC_PDP_UNKNOWN</a>;</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (0 == strncmp(configuration.pdp, PdpIpv4, <span class="keyword">sizeof</span>(PdpIpv4)))</div><div class="line">    {</div><div class="line">        pdp = <a class="code" href="le__mdc__interface_8h.html#a85721ec6046140c2f87c23f877dce247af550adf5bcecb680294f92f28496a830">LE_MDC_PDP_IPV4</a>;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(configuration.pdp, PdpIpv6, <span class="keyword">sizeof</span>(PdpIpv6)))</div><div class="line">    {</div><div class="line">        pdp = <a class="code" href="le__mdc__interface_8h.html#a85721ec6046140c2f87c23f877dce247ac2d2a34bad2d18be1ea8facef0effad0">LE_MDC_PDP_IPV6</a>;</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(configuration.pdp, PdpIpv4v6, <span class="keyword">sizeof</span>(PdpIpv4v6)))</div><div class="line">    {</div><div class="line">        pdp = <a class="code" href="le__mdc__interface_8h.html#a85721ec6046140c2f87c23f877dce247a4427db8ba7a89ebf66c7b62eacfc8275">LE_MDC_PDP_IPV4V6</a>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(LE_OK == <a class="code" href="le__mdc__interface_8h.html#a73e66a7a63dc95d7f261fc2a26470386">le_mdc_SetPDP</a>(*profileRefPtr, pdp));</div><div class="line"></div><div class="line">    <span class="comment">// Set APN</span></div><div class="line">    <span class="keywordflow">if</span> (0 == strncmp(configuration.apn, automaticApn, <span class="keyword">sizeof</span>(automaticApn)))</div><div class="line">    {</div><div class="line">        <span class="comment">// Set default APN</span></div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(LE_OK == <a class="code" href="le__mdc__interface_8h.html#ad44bd756fd5cbfd43a5b348054786a4d">le_mdc_SetDefaultAPN</a>(*profileRefPtr));</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(LE_OK == <a class="code" href="le__mdc__interface_8h.html#ae8ebd11b9cb9afb9b6b5745903f50156">le_mdc_SetAPN</a>(*profileRefPtr, configuration.apn));</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#ae9758eecfab89fbc1bc01341393a7723">le_mdc_Auth_t</a> auth = <a class="code" href="le__mdc__interface_8h.html#ae9758eecfab89fbc1bc01341393a7723a10fb016f4d6f7a7e893cf66846c24de2">LE_MDC_AUTH_NONE</a>;</div><div class="line">    <span class="keywordflow">if</span> (<span class="charliteral">&#39;\0&#39;</span> != configuration.auth[0])</div><div class="line">    {</div><div class="line">        <span class="comment">// Set the authentication, username and password</span></div><div class="line">        <span class="keywordflow">if</span> (0 == strncmp(configuration.auth, AuthPapChap, <span class="keyword">sizeof</span>(AuthPapChap)))</div><div class="line">        {</div><div class="line">            auth = <a class="code" href="le__mdc__interface_8h.html#ae9758eecfab89fbc1bc01341393a7723a151065be441aa8f065d0ead3d739b6f0">LE_MDC_AUTH_PAP</a> | <a class="code" href="le__mdc__interface_8h.html#ae9758eecfab89fbc1bc01341393a7723ae93a464a7ee2f31346aa01676afc7054">LE_MDC_AUTH_CHAP</a>;</div><div class="line">        }</div><div class="line">        <span class="comment">// Set the authentication, username and password</span></div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(configuration.auth, AuthPap, <span class="keyword">sizeof</span>(AuthPap)))</div><div class="line">        {</div><div class="line">            auth = <a class="code" href="le__mdc__interface_8h.html#ae9758eecfab89fbc1bc01341393a7723a151065be441aa8f065d0ead3d739b6f0">LE_MDC_AUTH_PAP</a>;</div><div class="line">        }</div><div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (0 == strncmp(configuration.auth, AuthChap, <span class="keyword">sizeof</span>(AuthChap)))</div><div class="line">        {</div><div class="line">            auth = <a class="code" href="le__mdc__interface_8h.html#ae9758eecfab89fbc1bc01341393a7723ae93a464a7ee2f31346aa01676afc7054">LE_MDC_AUTH_CHAP</a>;</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keywordflow">if</span> (<a class="code" href="le__mdc__interface_8h.html#ae9758eecfab89fbc1bc01341393a7723a10fb016f4d6f7a7e893cf66846c24de2">LE_MDC_AUTH_NONE</a> != auth)</div><div class="line">        {</div><div class="line">            <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(LE_OK == <a class="code" href="le__mdc__interface_8h.html#a9f69d0751927b5ead6c756202179b222">le_mdc_SetAuthentication</a>(*profileRefPtr,</div><div class="line">                                                auth,</div><div class="line">                                                configuration.userName,</div><div class="line">                                                configuration.password));</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;cid: %d pdp: %d apn: %s auth: %d username: %s password: %s&quot;</span>,</div><div class="line">            <a class="code" href="le__mdc__interface_8h.html#a108f7c3db74a377c2ae5482543d4e0d9">le_mdc_GetProfileIndex</a>(*profileRefPtr), pdp, configuration.apn, auth,</div><div class="line">            configuration.userName, configuration.password);</div><div class="line">}<span class="comment"></span></div><div class="line"><span class="comment">//! [Profiles]</span></div></div><!-- fragment --> <h2><a class="anchor" id="mdc_StartSession"></a>
Start Data Session</h2>
<p>A data session can be started using <a class="el" href="le__mdc__interface_8h.html#a2cb08d5c3e6c43297d80448891719649">le_mdc_StartSession()</a>. To start a data session, a data profile must be created and written to the modem, or an existing data profile can be used. The number of simultaneous data sessions supported is dependent on the modem, but cannot be more than the maximum number of supported profiles.</p>
<p>A data session can be started asynchronously using <a class="el" href="le__mdc__interface_8h.html#aa03d6e31263ddf8bf1d94b183c9934d9">le_mdc_StartSessionAsync()</a>, which is not blocking. The response will be returned with the le_mdc_SessionHandlerFunc_t handler function.</p>
<p>When <a class="el" href="le__mdc__interface_8h.html#a638b693cd5f644fa5c24f81e1e36483c">le_mdc_GetProfile()</a> called with LE_MDC_DEFAULT_PROFILE, profile index 1(default index) is retrieved from the modem. To register with another profile other than LE_MDC_DEFAULT_PROFILE, the required profile index should be passed to <a class="el" href="le__mdc__interface_8h.html#a638b693cd5f644fa5c24f81e1e36483c">le_mdc_GetProfile()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>: The maximum number of data profiles supported is modem dependent and can be retrieved with <a class="el" href="le__mdc__interface_8h.html#a790602f1b17d7bf9626a51eac5599439">le_mdc_NumProfiles()</a>. Profile index passed to le_mdc_GetProfile(profile_index) should be less than or equal to maximum number of data profiles supported.</dd></dl>
<h2><a class="anchor" id="mdc_StopSession"></a>
Stop Data Session</h2>
<p>A data session can be stopped using <a class="el" href="le__mdc__interface_8h.html#a53453f85065c3cace0922150b7e3d869">le_mdc_StopSession()</a>.</p>
<p>A data session started can be stopped either synchronously with <a class="el" href="le__mdc__interface_8h.html#a53453f85065c3cace0922150b7e3d869">le_mdc_StopSession()</a> (or) asynchronously with <a class="el" href="le__mdc__interface_8h.html#ac5b357f7437c9e253fa17b2511fa14ef">le_mdc_StopSessionAsync()</a>. <a class="el" href="le__mdc__interface_8h.html#ac5b357f7437c9e253fa17b2511fa14ef">le_mdc_StopSessionAsync()</a> response will be returned with the le_mdc_SessionHandlerFunc_t handler function.</p>
<p>The following sample code demonstrates Data Session Functionality: </p><div class="fragment"><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Session handler response for connection and disconnection.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> SessionHandlerFunc</div><div class="line">(</div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#a91074d8f0d88c6645e3085dfadf87011">le_mdc_ProfileRef_t</a> profileRef,</div><div class="line">    <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> result,</div><div class="line">    <span class="keywordtype">void</span>* contextPtr</div><div class="line">)</div><div class="line">{</div><div class="line">    <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a>* activationPtr = contextPtr;</div><div class="line">    *activationPtr = result;</div><div class="line"></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;Session result %d for profile %d&quot;</span>, result, <a class="code" href="le__mdc__interface_8h.html#a108f7c3db74a377c2ae5482543d4e0d9">le_mdc_GetProfileIndex</a>(profileRef));</div><div class="line"></div><div class="line">    <a class="code" href="le__semaphore_8h.html#abb859411cc58fbcc576c986ef52083b2">le_sem_Post</a>(AsyncTestSemaphore);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Start asynchronous session.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> SessionStartAsync</div><div class="line">(</div><div class="line">    <span class="keywordtype">void</span>* param1Ptr,</div><div class="line">    <span class="keywordtype">void</span>* param2Ptr</div><div class="line">)</div><div class="line">{</div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#a91074d8f0d88c6645e3085dfadf87011">le_mdc_ProfileRef_t</a> profileRef = param1Ptr;</div><div class="line"></div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#aa03d6e31263ddf8bf1d94b183c9934d9">le_mdc_StartSessionAsync</a>(profileRef, SessionHandlerFunc, param2Ptr);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Stop asynchronous session.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> SessionStopAsync</div><div class="line">(</div><div class="line">    <span class="keywordtype">void</span>* param1Ptr,</div><div class="line">    <span class="keywordtype">void</span>* param2Ptr</div><div class="line">)</div><div class="line">{</div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#a91074d8f0d88c6645e3085dfadf87011">le_mdc_ProfileRef_t</a> profileRef = param1Ptr;</div><div class="line"></div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#ac5b357f7437c9e253fa17b2511fa14ef">le_mdc_StopSessionAsync</a>(profileRef, SessionHandlerFunc, param2Ptr);</div><div class="line">}</div><div class="line"></div></div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Data session started synchronously can be stopped asynchronously and vice-versa.</dd></dl>
<h2><a class="anchor" id="le_mdc_dataStatistics"></a>
Data Statistics</h2>
<p>The amount of received and transmitted data can be retrieved through <a class="el" href="le__mdc__interface_8h.html#aaad833c105f7d0ae77f18195d6739080">le_mdc_GetBytesCounters()</a>. The returned values correspond to the number of received and transmitted bytes since the last call to <a class="el" href="le__mdc__interface_8h.html#a63636b2779d2ee6a6520ebfb2d26666c">le_mdc_ResetBytesCounter()</a>.</p>
<p>The data statistics collection can be started with <a class="el" href="le__mdc__interface_8h.html#a30f390941d98c9e9c4144a5e035da3aa">le_mdc_StartBytesCounter()</a> and stopped without resetting the counters with <a class="el" href="le__mdc__interface_8h.html#a1d6007bc8f84e5e4869af4af11b7363f">le_mdc_StopBytesCounter()</a>.</p>
<dl class="section note"><dt>Note</dt><dd>The data statistics collection activation and the data counters are persistent even after a reboot of the platform.</dd></dl>
<p>The following sample code demonstrates Data Statistics usage: </p><div class="fragment"><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span><span class="comment"></span></div><div class="line"><span class="comment">/**</span></div><div class="line"><span class="comment"> * Test the connectivity.</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="comment">//--------------------------------------------------------------------------------------------------</span></div><div class="line"><span class="keywordtype">void</span> TestConnectivity</div><div class="line">(</div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#a91074d8f0d88c6645e3085dfadf87011">le_mdc_ProfileRef_t</a> profileRef</div><div class="line">)</div><div class="line">{</div><div class="line">    <span class="keywordtype">int</span> status;</div><div class="line">    <span class="keywordtype">char</span> systemCmd[200] = {0};</div><div class="line">    <span class="keywordtype">char</span> itfName[<a class="code" href="le__mdc__interface_8h.html#a33ebf9afd03f0ffc91a80c32c15afb42">LE_MDC_INTERFACE_NAME_MAX_BYTES</a>] = <span class="stringliteral">&quot;\0&quot;</span>;</div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#a7a9d8c4b2053b048a53257ed810f527e">le_mdc_DataBearerTechnology_t</a> downlinkDataBearerTech;</div><div class="line">    <a class="code" href="le__mdc__interface_8h.html#a7a9d8c4b2053b048a53257ed810f527e">le_mdc_DataBearerTechnology_t</a> uplinkDataBearerTech;</div><div class="line">    uint64_t rxBytes = 0, txBytes = 0;</div><div class="line">    uint64_t latestRxBytes = 0, latestTxBytes = 0;</div><div class="line"></div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__mdc__interface_8h.html#a1b17bb87b347162013b5ad608cdcda2d">le_mdc_GetDataBearerTechnology</a>(profileRef,</div><div class="line">                                                &amp;downlinkDataBearerTech,</div><div class="line">                                                &amp;uplinkDataBearerTech));</div><div class="line"></div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;downlinkDataBearerTech %d, uplinkDataBearerTech %d&quot;</span>,</div><div class="line">            downlinkDataBearerTech, uplinkDataBearerTech);</div><div class="line"></div><div class="line">    <span class="comment">// Get interface name</span></div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__mdc__interface_8h.html#a4c22a8691d6e6a69270a7ed6ab9974af">le_mdc_GetInterfaceName</a>(profileRef, itfName, <a class="code" href="le__mdc__interface_8h.html#a33ebf9afd03f0ffc91a80c32c15afb42">LE_MDC_INTERFACE_NAME_MAX_BYTES</a>));</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> (<a class="code" href="le__mdc__interface_8h.html#aa3912e94864a6e5862e07f58b3772cba">le_mdc_IsIPv4</a>(profileRef))</div><div class="line">    {</div><div class="line">        <a class="code" href="app_stop_client_8c.html#a2b6c4b2a795957a91039524b524be480">snprintf</a>(systemCmd, <span class="keyword">sizeof</span>(systemCmd), <span class="stringliteral">&quot;ping -c 4 www.sierrawireless.com -I %s&quot;</span>, itfName);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">// TODO ping6 needs raw access to socket and therefore root permissions =&gt; find a different</span></div><div class="line">        <span class="comment">// way to test the connectivity</span></div><div class="line">        <a class="code" href="app_stop_client_8c.html#a2b6c4b2a795957a91039524b524be480">snprintf</a>(systemCmd, <span class="keyword">sizeof</span>(systemCmd), <span class="stringliteral">&quot;ping6 -c 4 www.sierrawireless.com -I %s&quot;</span>, itfName);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="comment">// Ping to test the connectivity</span></div><div class="line">    status = system(systemCmd);</div><div class="line">    <span class="keywordflow">if</span> (WEXITSTATUS(status))</div><div class="line">    {</div><div class="line">        <a class="code" href="le__mdc__interface_8h.html#a53453f85065c3cace0922150b7e3d869">le_mdc_StopSession</a>(profileRef);</div><div class="line">    }</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(!WEXITSTATUS(status));</div><div class="line"></div><div class="line">    <span class="comment">// Get data counters</span></div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__mdc__interface_8h.html#aaad833c105f7d0ae77f18195d6739080">le_mdc_GetBytesCounters</a>(&amp;rxBytes, &amp;txBytes));</div><div class="line">    latestRxBytes = rxBytes;</div><div class="line">    latestTxBytes = txBytes;</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;rxBytes %&quot;</span>PRIu64<span class="stringliteral">&quot;, txBytes %&quot;</span>PRIu64, rxBytes, txBytes);</div><div class="line"></div><div class="line">    <span class="comment">// Stop data counters and ping to test the connectivity</span></div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__mdc__interface_8h.html#a1d6007bc8f84e5e4869af4af11b7363f">le_mdc_StopBytesCounter</a>());</div><div class="line">    status = system(systemCmd);</div><div class="line">    <span class="keywordflow">if</span> (WEXITSTATUS(status))</div><div class="line">    {</div><div class="line">        <a class="code" href="le__mdc__interface_8h.html#a53453f85065c3cace0922150b7e3d869">le_mdc_StopSession</a>(profileRef);</div><div class="line">    }</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(!WEXITSTATUS(status));</div><div class="line"></div><div class="line">    <span class="comment">// Get data counters</span></div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__mdc__interface_8h.html#aaad833c105f7d0ae77f18195d6739080">le_mdc_GetBytesCounters</a>(&amp;rxBytes, &amp;txBytes));</div><div class="line">    <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;rxBytes %&quot;</span>PRIu64<span class="stringliteral">&quot;, txBytes %&quot;</span>PRIu64, rxBytes, txBytes);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(latestRxBytes == rxBytes);</div><div class="line">    <a class="code" href="le__log_8h.html#ac0dbbef91dc0fed449d0092ff0557b39">LE_ASSERT</a>(latestTxBytes == txBytes);</div><div class="line"></div><div class="line">    <span class="comment">// Start data counters</span></div><div class="line">    <a class="code" href="le__log_8h.html#a7cd2daa3d4af1de4d29e0eed95187484">LE_ASSERT_OK</a>(<a class="code" href="le__mdc__interface_8h.html#a30f390941d98c9e9c4144a5e035da3aa">le_mdc_StartBytesCounter</a>());</div><div class="line">}</div></div><!-- fragment --><p>The following flow diagram describes how MDC data profile is retrieved:</p>
<div align="center">
<img src="le_mdc_GetProfile.png" />
</div>
<p>The following flow diagram describes the MDC start session:</p>
<div align="center">
<img src="le_mdc_StartSession.png" />
</div>
<p>The following flow diagram describes the MDC stop session:</p>
<div align="center">
<img src="le_mdc_StopSession.png" />
</div>
<p>Copyright (C) Sierra Wireless Inc. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.11
        </div>
    </div>
</body>
</html>
