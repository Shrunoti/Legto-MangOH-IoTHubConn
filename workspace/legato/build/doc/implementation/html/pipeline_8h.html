<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LEGATO: framework/liblegato/linux/pipeline.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/javascript">
//<![CDATA[
    // Detect if doc is served by eclipse
    if( ( (window.location.hostname == "127.0.0.1") || (window.location.hostname == "localhost") ) &&
        ( (window.location.port != "") && (window.location.port != 80) && (window.location.port != 443) ) )
    {
        // Inhibit init function from navtree
        initNavTree = function(toroot,relpath) {}
        $(document).ready(function(){
            navTree = document.getElementById("side-nav");
            if(navTree)
            {
                navTree.parentElement.removeChild(navTree);
            }
            $("#doc-content").css('margin-left',10);
        });
    }
//]]>
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="index.html" title="Legato">
      <img alt="Logo" src="legatoLogo.png"/>
    </a>
    <div id="projectbrief">Simplifying IoT development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('pipeline_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pipeline.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="pipeline_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:adfb885380a9b0f550fafe4de0a2d2564"><td class="memItemLeft" align="right" valign="top">typedef struct pipeline *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a></td></tr>
<tr class="separator:adfb885380a9b0f550fafe4de0a2d2564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53e3ab7501d0fbda2b26eef532d81522"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#a53e3ab7501d0fbda2b26eef532d81522">pipeline_ProcessFunc_t</a>) (<a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> *param)</td></tr>
<tr class="separator:a53e3ab7501d0fbda2b26eef532d81522"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a768a6dc8deffe73dcd6a7a30696a23e9"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#a768a6dc8deffe73dcd6a7a30696a23e9">pipeline_TerminationHandler_t</a>) (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline, int status)</td></tr>
<tr class="separator:a768a6dc8deffe73dcd6a7a30696a23e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a182c3868d586864efbcf6487172b2b07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#a182c3868d586864efbcf6487172b2b07">pipeline_Create</a> (<a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>)</td></tr>
<tr class="separator:a182c3868d586864efbcf6487172b2b07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae15e18fdcb35f8da14531967e0706d34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#ae15e18fdcb35f8da14531967e0706d34">pipeline_Delete</a> (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline)</td></tr>
<tr class="separator:ae15e18fdcb35f8da14531967e0706d34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93ac6d99ab9f280ed7775d80ef417930"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#a93ac6d99ab9f280ed7775d80ef417930">pipeline_Append</a> (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline, <a class="el" href="pipeline_8h.html#a53e3ab7501d0fbda2b26eef532d81522">pipeline_ProcessFunc_t</a> func, <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> *param)</td></tr>
<tr class="separator:a93ac6d99ab9f280ed7775d80ef417930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0f06827e76701914e05f0680e657b99"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#aa0f06827e76701914e05f0680e657b99">pipeline_SetInput</a> (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline, int <a class="el" href="app_stop_client_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>)</td></tr>
<tr class="separator:aa0f06827e76701914e05f0680e657b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7a6d4db607aea4887cc0d3f94735354"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#ae7a6d4db607aea4887cc0d3f94735354">pipeline_SetOutput</a> (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline, int <a class="el" href="app_stop_client_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>)</td></tr>
<tr class="separator:ae7a6d4db607aea4887cc0d3f94735354"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3a19ee599f8d260000a013abedcea95"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#ab3a19ee599f8d260000a013abedcea95">pipeline_CreateInputPipe</a> (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline)</td></tr>
<tr class="separator:ab3a19ee599f8d260000a013abedcea95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20070b94cc1b09129716560cd84b815a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#a20070b94cc1b09129716560cd84b815a">pipeline_CreateOutputPipe</a> (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline)</td></tr>
<tr class="separator:a20070b94cc1b09129716560cd84b815a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9c761edaba473ad641b11881f4a5d47"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#ad9c761edaba473ad641b11881f4a5d47">pipeline_CreatePipe</a> (int *readFdPtr, int *writeFdPtr)</td></tr>
<tr class="separator:ad9c761edaba473ad641b11881f4a5d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed5a5f3ba88d66bb542744eb56eb7eda"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#aed5a5f3ba88d66bb542744eb56eb7eda">pipeline_Start</a> (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline, <a class="el" href="pipeline_8h.html#a768a6dc8deffe73dcd6a7a30696a23e9">pipeline_TerminationHandler_t</a> callback)</td></tr>
<tr class="separator:aed5a5f3ba88d66bb542744eb56eb7eda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affc4272b72a3a41b34ab69fd30a36a70"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#affc4272b72a3a41b34ab69fd30a36a70">pipeline_CheckChildren</a> (<a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>)</td></tr>
<tr class="separator:affc4272b72a3a41b34ab69fd30a36a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af66bb3e4fa7e730c8cd2eecabeef84e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pipeline_8h.html#af66bb3e4fa7e730c8cd2eecabeef84e4">pipeline_Init</a> ()</td></tr>
<tr class="separator:af66bb3e4fa7e730c8cd2eecabeef84e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>API for creating pipes and pipelines of processes.</p>
<p>The following code creates a pipeline "&lt;c&gt;cat foo | md5sum&lt;/c&gt;" where the <code>tar</code> process reads its data from the parent process's standard input and the output from the <code>md5sum</code> process is delivered to an FD Monitor handler function called PipeOutputHandler() as it arrives.</p>
<p>To make the completion callback work, the caller must monitor for SIGCHLD signals and call <a class="el" href="pipeline_8h.html#affc4272b72a3a41b34ab69fd30a36a70">pipeline_CheckChildren()</a> when it arrives.</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> ChildSignalHandler(<span class="keywordtype">int</span> sigNum)</div><div class="line">{</div><div class="line">    <a class="code" href="pipeline_8c.html#affc4272b72a3a41b34ab69fd30a36a70">pipeline_CheckChildren</a>();</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> CatProcess(<span class="keywordtype">void</span>* param)</div><div class="line">{</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span>* filePath = param;</div><div class="line"></div><div class="line">    execl(<span class="stringliteral">&quot;cat&quot;</span>, filePath, (<span class="keywordtype">char</span>*)NULL);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> Md5SumProcess(<span class="keywordtype">void</span>)</div><div class="line">{</div><div class="line">    execl(<span class="stringliteral">&quot;md5sum&quot;</span>, <span class="stringliteral">&quot;md5sum&quot;</span>, (<span class="keywordtype">char</span>*)NULL);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> CompletionCallback</div><div class="line">(</div><div class="line">    <a class="code" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline,</div><div class="line">    <span class="keywordtype">int</span> result <span class="comment">// Exit status of the last process in the pipeline (see &#39;man waitpid&#39;).</span></div><div class="line">)</div><div class="line">{</div><div class="line">    <span class="keywordflow">if</span> (WIFEXITED(result) &amp;&amp; WEXITSTATUS(EXIT_SUCCESS))</div><div class="line">    {</div><div class="line">        <span class="comment">// Hooray!</span></div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <span class="comment">// Boo!  Killed by a signal or exited with non-zero exit code.</span></div><div class="line">    }</div><div class="line">    <a class="code" href="pipeline_8c.html#ae15e18fdcb35f8da14531967e0706d34">pipeline_Delete</a>(pipeline);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> RunPipeline()</div><div class="line">{</div><div class="line">    pipeline_PipelineRef_t pipeline = <a class="code" href="pipeline_8c.html#a182c3868d586864efbcf6487172b2b07">pipeline_Create</a>();</div><div class="line"></div><div class="line">    <a class="code" href="pipeline_8c.html#a93ac6d99ab9f280ed7775d80ef417930">pipeline_Append</a>(pipeline, CatProcess, <span class="stringliteral">&quot;foo&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="pipeline_8c.html#a93ac6d99ab9f280ed7775d80ef417930">pipeline_Append</a>(pipeline, Md5SumProcess, NULL);</div><div class="line"></div><div class="line">    <a class="code" href="pipeline_8c.html#aa0f06827e76701914e05f0680e657b99">pipeline_SetInput</a>(pipeline, STDIN_FILENO);</div><div class="line"></div><div class="line">    fdMonitor_Create(<span class="stringliteral">&quot;my pipeline&quot;</span>, <a class="code" href="pipeline_8c.html#a20070b94cc1b09129716560cd84b815a">pipeline_CreateOutputPipe</a>(pipeline), PipeOutputHandler, POLLIN);</div><div class="line"></div><div class="line">    <a class="code" href="pipeline_8c.html#aed5a5f3ba88d66bb542744eb56eb7eda">pipeline_Start</a>(pipeline, CompletionCallback);</div><div class="line">}</div><div class="line"></div><div class="line"><a class="code" href="le__event_loop_8h.html#abdb9187a56836a93d19cc793cbd4b7ec">COMPONENT_INIT</a></div><div class="line">{</div><div class="line">    <a class="code" href="supervisor_8c.html#afa9069e7bbdeed2332b5cbffbb472691">le_sig_Block</a>(SIGCHLD);</div><div class="line">    <a class="code" href="supervisor_8c.html#a2eb645189be654e43dfeb29c95143ed8">le_sig_SetEventHandler</a>(SIGCHLD, ChildSignalHandler);</div><div class="line"></div><div class="line">    RunPipeline();</div><div class="line">}</div></div><!-- fragment --><hr/>
<p>Summary of available functions in this API:</p>
<ul>
<li><a class="el" href="pipeline_8h.html#a182c3868d586864efbcf6487172b2b07">pipeline_Create()</a> creates a new pipeline.</li>
<li><a class="el" href="pipeline_8h.html#ae15e18fdcb35f8da14531967e0706d34">pipeline_Delete()</a> deletes a pipeline. Kills all remaining processes in the pipeline.</li>
<li><a class="el" href="pipeline_8h.html#a93ac6d99ab9f280ed7775d80ef417930">pipeline_Append()</a> adds a process to the end of the pipeline.</li>
<li><a class="el" href="pipeline_8h.html#aa0f06827e76701914e05f0680e657b99">pipeline_SetInput()</a> provides a file descriptor for the pipeline to read its input from.</li>
<li><a class="el" href="pipeline_8h.html#ab3a19ee599f8d260000a013abedcea95">pipeline_CreateInputPipe()</a> creates a pipe to be connected to the input of the first process in the pipeline. Returns the write end for the caller to use to write data into the pipe.</li>
<li><a class="el" href="pipeline_8h.html#ae7a6d4db607aea4887cc0d3f94735354">pipeline_SetOutput()</a> provides a file descriptor for the pipeline to write its output to.</li>
<li><a class="el" href="pipeline_8h.html#a20070b94cc1b09129716560cd84b815a">pipeline_CreateOutputPipe()</a> creates a pipe to be connected to the output of the last process in the pipeline. Returns the read end for the caller to use to read data from the pipe.</li>
<li><a class="el" href="pipeline_8h.html#ad9c761edaba473ad641b11881f4a5d47">pipeline_CreatePipe()</a> can be used to create a pipe. It's a simple wrapper around pipe().</li>
<li><a class="el" href="pipeline_8h.html#aed5a5f3ba88d66bb542744eb56eb7eda">pipeline_Start()</a> executes the processes in the pipeline. A completion callback function is provided, which will be called when the pipeline terminates.</li>
<li><a class="el" href="pipeline_8h.html#affc4272b72a3a41b34ab69fd30a36a70">pipeline_CheckChildren()</a> must be called to tell the pipeline to check for the death of any of its children. This should be done in response to a SIGCHLD signal. It is recommended to use the <a class="el" href="c_signals.html">Signals API</a> to detect SIGCHLD signals. DO NOT call any of this API's functions from inside an asynchronous signal handler. This API is NOT async safe.</li>
</ul>
<p><b>Future Enhancements:</b></p>
<ul>
<li>pipeline_SetTimeout()</li>
<li>pipeline_Set/GetContextPtr()</li>
<li>pipeline_Signal() - Send a signal to all processes in the pipeline.</li>
<li>pipeline_Prepend()</li>
</ul>
<hr/>
<p>Copyright (C) Sierra Wireless Inc. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a53e3ab7501d0fbda2b26eef532d81522"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* pipeline_ProcessFunc_t) (<a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> *param)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Process functions look like this. These are the functions that run in the child process. They can do whatever is needed in that process, e.g., setuid(), setgid(), execl(), or just do something and exit.</p>
<p>Standard input and standard output will be properly set up for the pipeline before this function is called.</p>
<p>If the function returns, the process will exit.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Parameter</td><td>passed to <a class="el" href="pipeline_8h.html#a93ac6d99ab9f280ed7775d80ef417930">pipeline_Append()</a> for this process.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Exit code for the process.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>The Legato app framework is not fully fork-safe yet, so it is recommended that the process exec a program, unless it just has something trivial to do using POSIX APIs. </dd></dl>

</div>
</div>
<a class="anchor" id="adfb885380a9b0f550fafe4de0a2d2564"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct pipeline* <a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reference to a pipeline. </p>

</div>
</div>
<a class="anchor" id="a768a6dc8deffe73dcd6a7a30696a23e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>(* pipeline_TerminationHandler_t) (<a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline, int status)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pipeline termination handler functions must look like this.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pipeline</td><td>Reference to the pipeline that terminated.</td></tr>
    <tr><td class="paramname">status</td><td>Status code from the last process in the pipeline. Must be processed using WIFEXITED(), WEXITSTATUS(), WIFSIGNALED(), WTERMSIG(), etc. See 'man waitpid'. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a93ac6d99ab9f280ed7775d80ef417930"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> pipeline_Append </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a>&#160;</td>
          <td class="paramname"><em>pipeline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#a53e3ab7501d0fbda2b26eef532d81522">pipeline_ProcessFunc_t</a>&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Adds a process to the end of the pipeline.</p>
<dl class="section warning"><dt>Warning</dt><dd>Be sure that param is not a pointer to something that will get deallocated before the process starts. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">func</td><td>Function to be called in the child process. </td></tr>
    <tr><td class="paramname">param</td><td>Parameter to pass to the func when it is called. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="affc4272b72a3a41b34ab69fd30a36a70"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> pipeline_CheckChildren </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check all pipelines started by threads in this process for the death of any of its children.</p>
<p>If it finds one or more have died, then it will reap them and report results through completion callbacks.</p>
<p>This does nothing if there are no pipelines running.</p>
<dl class="section note"><dt>Note</dt><dd>It's up to the caller to get the SIGCHLD notification somehow (it is recommended to use the <a class="el" href="c_signals.html">Signals API</a>).</dd></dl>
<p>Check all pipelines started by threads in this process for the death of any of its children.</p>
<p>If it finds one or more have died, then it will reap them and report results through completion callbacks.</p>
<p>This does nothing if there are no pipelines running.</p>
<dl class="section note"><dt>Note</dt><dd>It's up to the caller to get the SIGCHLD notification somehow (it is recommended to use the <a class="el" href="c_signals.html">Signals API</a>).</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>We don't know what thread is calling this function. </dd></dl>

</div>
</div>
<a class="anchor" id="a182c3868d586864efbcf6487172b2b07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a> pipeline_Create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a new pipeline. </p>

</div>
</div>
<a class="anchor" id="ab3a19ee599f8d260000a013abedcea95"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pipeline_CreateInputPipe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a>&#160;</td>
          <td class="paramname"><em>pipeline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a pipe for the first process in the pipeline to read from and returns the write end of the pipe.</p>
<dl class="section return"><dt>Returns</dt><dd>The file descriptor of the write end of the pipe.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Remember to close the write end of the pipe when you are done. The read end will be closed automatically. </dd></dl>

</div>
</div>
<a class="anchor" id="a20070b94cc1b09129716560cd84b815a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pipeline_CreateOutputPipe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a>&#160;</td>
          <td class="paramname"><em>pipeline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a pipe for the last process in the pipeline to write into and returns the read end of the pipe.</p>
<dl class="section return"><dt>Returns</dt><dd>The file descriptor of the read end of the pipe.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Remember to close the read end of the pipe when you are done. The write end will be closed automatically. </dd></dl>

</div>
</div>
<a class="anchor" id="ad9c761edaba473ad641b11881f4a5d47"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> pipeline_CreatePipe </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>readFdPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>writeFdPtr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a pipe. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">readFdPtr</td><td>Ptr to where the fd for the read end of the pipe will be put. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">writeFdPtr</td><td>Ptr to where the fd for the write end of the pipe will be put. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae15e18fdcb35f8da14531967e0706d34"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> pipeline_Delete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a>&#160;</td>
          <td class="paramname"><em>pipeline</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Delete a pipeline.</p>
<p>If the processes are still running, force kills them (using SIGKILL).</p>
<p>Any data left in pipes will be lost. </p>

</div>
</div>
<a class="anchor" id="af66bb3e4fa7e730c8cd2eecabeef84e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> pipeline_Init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initialize the pipeline module.</p>
<p>This should be called by liblegato's <a class="el" href="init_8c.html">init.c</a> module at start-up. </p>

</div>
</div>
<a class="anchor" id="aa0f06827e76701914e05f0680e657b99"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> pipeline_SetInput </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a>&#160;</td>
          <td class="paramname"><em>pipeline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provides a file descriptor for the pipeline to read its input from. </p>

</div>
</div>
<a class="anchor" id="ae7a6d4db607aea4887cc0d3f94735354"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> pipeline_SetOutput </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a>&#160;</td>
          <td class="paramname"><em>pipeline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Provides a file descriptor for the pipeline to write its output to. </p>

</div>
</div>
<a class="anchor" id="aed5a5f3ba88d66bb542744eb56eb7eda"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> pipeline_Start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#adfb885380a9b0f550fafe4de0a2d2564">pipeline_Ref_t</a>&#160;</td>
          <td class="paramname"><em>pipeline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pipeline_8h.html#a768a6dc8deffe73dcd6a7a30696a23e9">pipeline_TerminationHandler_t</a>&#160;</td>
          <td class="paramname"><em>callback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Executes the processes in the pipeline. A completion callback function is provided, which will be called when the pipeline terminates. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.11
        </div>
    </div>
</body>
</html>
