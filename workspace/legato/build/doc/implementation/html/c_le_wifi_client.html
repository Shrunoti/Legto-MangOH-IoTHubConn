<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LEGATO: WiFi Client Service</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/javascript">
//<![CDATA[
    // Detect if doc is served by eclipse
    if( ( (window.location.hostname == "127.0.0.1") || (window.location.hostname == "localhost") ) &&
        ( (window.location.port != "") && (window.location.port != 80) && (window.location.port != 443) ) )
    {
        // Inhibit init function from navtree
        initNavTree = function(toroot,relpath) {}
        $(document).ready(function(){
            navTree = document.getElementById("side-nav");
            if(navTree)
            {
                navTree.parentElement.removeChild(navTree);
            }
            $("#doc-content").css('margin-left',10);
        });
    }
//]]>
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="index.html" title="Legato">
      <img alt="Logo" src="legatoLogo.png"/>
    </a>
    <div id="projectbrief">Simplifying IoT development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('c_le_wifi_client.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">WiFi Client Service </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="le__wifi_client__interface_8h.html">API Reference</a></p>
<hr/>
<p>This API provides WiFi Client setup. Please note that the WiFi Client cannot be used at the same time as the WiFi Access Points service, due to the sharing of same wifi hardware.</p>
<h1><a class="anchor" id="le_wifi_binding"></a>
IPC interfaces binding</h1>
<p>Here's a code sample binding to WiFi service: </p><pre class="fragment">bindings:
{
   clientExe.clientComponent.le_wifiClient -&gt; wifiService.le_wifiClient
}
</pre><h1><a class="anchor" id="le_wifiClient_Start"></a>
Starting the WiFi Client</h1>
<p>First of all the function <a class="el" href="le__wifi_client__interface_8h.html#af637c17f5b8331b598dcf6c57b9260ad">le_wifiClient_Start()</a> must be called to start the WiFi Service.</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#af637c17f5b8331b598dcf6c57b9260ad">le_wifiClient_Start()</a>: returns LE_OK if the call went ok. If WiFi Access Point is active, this will fail.</li>
</ul>
<p>To subscribe to wifi events <a class="el" href="le__wifi_client__interface_8h.html#a55aaafbc0a0b4a70faafb50f6babf482">le_wifiClient_AddNewEventHandler()</a> is to be called.</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#a55aaafbc0a0b4a70faafb50f6babf482">le_wifiClient_AddNewEventHandler()</a>: returns the handler reference if the call went ok.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> EventHandler</div><div class="line">(</div><div class="line">    <a class="code" href="le__wifi_client__interface_8h.html#a1b776321e539bab3bc6a07078545bca4">le_wifiClient_Event_t</a> clientEvent,</div><div class="line">    <span class="keywordtype">void</span> *contextPtr</div><div class="line">)</div><div class="line">{</div><div class="line">    <span class="keywordflow">switch</span>( clientEvent )</div><div class="line">    {</div><div class="line">         <span class="keywordflow">case</span> <a class="code" href="le__wifi_client__interface_8h.html#a1b776321e539bab3bc6a07078545bca4a7311dd6562fef67d5c5defbd9dcbc6d2">LE_WIFICLIENT_EVENT_CONNECTED</a>:</div><div class="line">         {</div><div class="line">             <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;WiFi Client Connected.&quot;</span>);</div><div class="line">         }</div><div class="line">         <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <a class="code" href="le__wifi_client__interface_8h.html#a1b776321e539bab3bc6a07078545bca4a72b538a3446d73b0da95db84de318747">LE_WIFICLIENT_EVENT_DISCONNECTED</a>:</div><div class="line">         {</div><div class="line">             <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;WiFi Client Disconnected.&quot;</span>);</div><div class="line">         }</div><div class="line">         <span class="keywordflow">break</span>;</div><div class="line">         <span class="keywordflow">case</span> <a class="code" href="le__wifi_client__interface_8h.html#a1b776321e539bab3bc6a07078545bca4a4202d7b05f16eb80f8b7adfafcef3973">LE_WIFICLIENT_EVENT_SCAN_DONE</a>:</div><div class="line">         {</div><div class="line">             <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;WiFi Client Scan is done.&quot;</span>);</div><div class="line">             MyHandleScanResult();</div><div class="line">         }</div><div class="line">         <span class="keywordflow">break</span>;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">le_wifiClient_NewEventHandler WiFiEventHandlerRef = NULL;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> MyInit</div><div class="line">(</div><div class="line">    <span class="keywordtype">void</span></div><div class="line">)</div><div class="line">{</div><div class="line">    <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> result = le_wifiClient_start();</div><div class="line"></div><div class="line">    <span class="keywordflow">if</span> ( LE_OK == result )</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;WiFi Client started.&quot;</span>);</div><div class="line">        WiFiEventHandlerRef = <a class="code" href="le__wifi_client__interface_8h.html#a55aaafbc0a0b4a70faafb50f6babf482">le_wifiClient_AddNewEventHandler</a>( EventHandler, NULL );</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86ca92b0367090993d8b41d1560663d01e8d">LE_BUSY</a> == result )</div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;ERROR: WiFi Client already started.&quot;</span>);</div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span></div><div class="line">    {</div><div class="line">        <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;ERROR: WiFi Client not started.&quot;</span>);</div><div class="line">    }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="le_wifiClient_scan"></a>
Scanning Access Points with WiFi Client</h1>
<p>To start a scan for Access Points, the <a class="el" href="le__wifi_client__interface_8h.html#af478b542f65242095c05e1ee61160e2a">le_wifiClient_Scan()</a> should be called.</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#af478b542f65242095c05e1ee61160e2a">le_wifiClient_Scan()</a>: returns the LE_OK if the call went ok.</li>
</ul>
<h1><a class="anchor" id="le_wifiClient_scan_result"></a>
Processing the WiFi scan results</h1>
<p>Once the scan results are available, the event LE_WIFICLIENT_EVENT_SCAN_DONE is received. The found Access Points can then be gotten with</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#a284c452c5bd4309e096b6f89a8da653e">le_wifiClient_GetFirstAccessPoint()</a>: returns the Access Point if found. Else NULL.</li>
<li><a class="el" href="le__wifi_client__interface_8h.html#ab566a61f36b25118f9f38d62863361d2">le_wifiClient_GetNextAccessPoint()</a>: returns the next Access Point if found. Else NULL.</li>
</ul>
<p>The Access Points SSID, Service Set Identifier, is not a string. It does however often contain human readable ASCII values. It can be read with the following function:</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#aa726f6cb7f78e9ed962a6c6d3ae75a91">le_wifiClient_GetSsid()</a> : returns the LE_OK if the SSID was read ok.</li>
</ul>
<p>The Access Points signal strength can be read with the following function:</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#ade417976a142b6e71df49bd8761e9833">le_wifiClient_GetSignalStrength()</a> : returns the signal strength in dBm of the AccessPoint</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> MyHandleScanResult</div><div class="line">(</div><div class="line">    <span class="keywordtype">void</span></div><div class="line">)</div><div class="line">{</div><div class="line">    uint8 ssid[MAX_SSID_BYTES];</div><div class="line">    <a class="code" href="le__wifi_client__interface_8h.html#a5a5709045b59550dbb52ff13a7d24c1e">le_wifiClient_AccessPointRef_t</a> accessPointRef = <a class="code" href="le__wifi_client__interface_8h.html#a284c452c5bd4309e096b6f89a8da653e">le_wifiClient_GetFirstAccessPoint</a>();</div><div class="line"></div><div class="line">    <span class="keywordflow">while</span>( NULL != accessPointRef )</div><div class="line">    {</div><div class="line">         result = <a class="code" href="le__wifi_client__interface_8h.html#aa726f6cb7f78e9ed962a6c6d3ae75a91">le_wifiClient_GetSsid</a>( accessPointRef, ssid, MAX_SSID_BYTES );</div><div class="line">         <span class="keywordflow">if</span> (( result == LE_OK ) &amp;&amp; ( memcmp( ssid, <span class="stringliteral">&quot;MySSID&quot;</span>, 6) == 0 ))</div><div class="line">         {</div><div class="line">              <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;WiFi Client found.&quot;</span>);</div><div class="line">              <span class="keywordflow">break</span>;</div><div class="line">         }</div><div class="line">         accessPointRef = <a class="code" href="le__wifi_client__interface_8h.html#ab566a61f36b25118f9f38d62863361d2">le_wifiClient_GetNextAccessPoint</a>();</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="le_wifiClient_connect_to_ap"></a>
Connecting to Access Point</h1>
<p>First of all, an Access Point reference should be created using the SSID of the target Access Point. Use the following function to create a reference:</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#a96542be7e54ff8373aa0d8b0f5e540c7">le_wifiClient_Create()</a>: returns Access Point reference</li>
</ul>
<p>To set the pass phrase prior for the Access Point use the function:</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#a398b877814bde1cd3054f2f59d0f6b8b">le_wifiClient_SetPassphrase()</a>: returns the function execution status.</li>
</ul>
<p>WPA-Enterprise requires a username and password to authenticate. To set them use the function:</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#a362429a884a24cf6e33415e111f0b522">le_wifiClient_SetUserCredentials()</a>: returns the function execution status.</li>
</ul>
<p>If an Access Point is hidden, it does not announce its presence and will not show up in scan. So, the SSID of this Access Point must be known in advance. Then, use the following function to allow connections to hidden Access Points: <a class="el" href="le__wifi_client__interface_8h.html#a1d150a261039641255c6fce638f91c97">le_wifiClient_SetHiddenNetworkAttribute()</a>: returns the function execution status.</p>
<p>Finally and when the Access Point parameters have been configured, use the following function to attempt a connection:</p><ul>
<li><a class="el" href="le__wifi_client__interface_8h.html#a17963642c794a003627dde66776ba225">le_wifiClient_Connect()</a>: returns the function execution status.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> MyConnectTo</div><div class="line">(</div><div class="line">    <a class="code" href="le__wifi_client__interface_8h.html#a5a5709045b59550dbb52ff13a7d24c1e">le_wifiClient_AccessPointRef_t</a> accessPointRef</div><div class="line">)</div><div class="line">{</div><div class="line">    <a class="code" href="le__basics_8h.html#a1cca095ed6ebab24b57a636382a6c86c">le_result_t</a> result;</div><div class="line">    <a class="code" href="le__wifi_client__interface_8h.html#a398b877814bde1cd3054f2f59d0f6b8b">le_wifiClient_SetPassphrase</a> ( accessPointRef, <span class="stringliteral">&quot;Secret1&quot;</span> );</div><div class="line">    result = <a class="code" href="le__wifi_client__interface_8h.html#a17963642c794a003627dde66776ba225">le_wifiClient_Connect</a>( accessPointRef );</div><div class="line">    <span class="keywordflow">if</span> (result == LE_OK)</div><div class="line">    {</div><div class="line">         <a class="code" href="le__log_8h.html#a23e6d206faa64f612045d688cdde5808">LE_INFO</a>(<span class="stringliteral">&quot;Connecting to AP.&quot;</span>);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><hr/>
<p>Copyright (C) Sierra Wireless Inc. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.11
        </div>
    </div>
</body>
</html>
