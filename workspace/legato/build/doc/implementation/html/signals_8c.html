<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>LEGATO: framework/liblegato/linux/signals.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/javascript">
//<![CDATA[
    // Detect if doc is served by eclipse
    if( ( (window.location.hostname == "127.0.0.1") || (window.location.hostname == "localhost") ) &&
        ( (window.location.port != "") && (window.location.port != 80) && (window.location.port != 443) ) )
    {
        // Inhibit init function from navtree
        initNavTree = function(toroot,relpath) {}
        $(document).ready(function(){
            navTree = document.getElementById("side-nav");
            if(navTree)
            {
                navTree.parentElement.removeChild(navTree);
            }
            $("#doc-content").css('margin-left',10);
        });
    }
//]]>
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="index.html" title="Legato">
      <img alt="Logo" src="legatoLogo.png"/>
    </a>
    <div id="projectbrief">Simplifying IoT development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('signals_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">signals.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="legato_8h_source.html">legato.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="limit_8h_source.html">limit.h</a>&quot;</code><br />
<code>#include &lt;ucontext.h&gt;</code><br />
<code>#include &lt;syslog.h&gt;</code><br />
<code>#include &lt;execinfo.h&gt;</code><br />
<code>#include &lt;setjmp.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_monitor_obj__t.html">MonitorObj_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_handler_obj__t.html">HandlerObj_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a369266c24eacffb87046522897a570d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a369266c24eacffb87046522897a570d5">_GNU_SOURCE</a></td></tr>
<tr class="separator:a369266c24eacffb87046522897a570d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc3b2d5b6dba18fe07087a065619bbc2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#acc3b2d5b6dba18fe07087a065619bbc2">SIG_STR</a>&#160;&#160;&#160;&quot;Sig&quot;</td></tr>
<tr class="separator:acc3b2d5b6dba18fe07087a065619bbc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d13b73bb278596844b801755aca552"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a88d13b73bb278596844b801755aca552">WRITE</a>(<a class="el" href="app_stop_client_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>,  buffer,  sz)</td></tr>
<tr class="separator:a88d13b73bb278596844b801755aca552"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a28ec7d993c364c8de4a240a57ac5b1d0"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="struct_handler_obj__t.html">HandlerObj_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a28ec7d993c364c8de4a240a57ac5b1d0">FindHandlerObj</a> (const int sigNum, <a class="el" href="structle__dls___list__t.html">le_dls_List_t</a> *listPtr)</td></tr>
<tr class="separator:a28ec7d993c364c8de4a240a57ac5b1d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a077c5e918a44362a7225bbd5bc3fd4e3"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a077c5e918a44362a7225bbd5bc3fd4e3">OurSigHandler</a> (int <a class="el" href="app_stop_client_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, short events)</td></tr>
<tr class="separator:a077c5e918a44362a7225bbd5bc3fd4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7dc58d39d6552abef5ef4b7f0898ff2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#aa7dc58d39d6552abef5ef4b7f0898ff2">SigSegVHandler</a> (int signum)</td></tr>
<tr class="separator:aa7dc58d39d6552abef5ef4b7f0898ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a199eff4756a32175cf3f684770827177"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a199eff4756a32175cf3f684770827177">ShowStackSignalHandler</a> (int sigNum, siginfo_t *sigInfoPtr, <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> *sigVoidPtr)</td></tr>
<tr class="separator:a199eff4756a32175cf3f684770827177"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acae2ca62730ef3e9834779c4948f5812"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#acae2ca62730ef3e9834779c4948f5812">le_sig_InstallShowStackHandler</a> (<a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>)</td></tr>
<tr class="separator:acae2ca62730ef3e9834779c4948f5812"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaeb18d6d39617557407a4d628096f18"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#acaeb18d6d39617557407a4d628096f18">TermSignalHandler</a> (int sigNum)</td></tr>
<tr class="separator:acaeb18d6d39617557407a4d628096f18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bc8661a69dd8f5378091a3099815253"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a8bc8661a69dd8f5378091a3099815253">le_sig_InstallDefaultTermHandler</a> (<a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>)</td></tr>
<tr class="separator:a8bc8661a69dd8f5378091a3099815253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae763eee7e4b0c63c229f4d0d01f4d934"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#ae763eee7e4b0c63c229f4d0d01f4d934">sig_Init</a> (<a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>)</td></tr>
<tr class="separator:ae763eee7e4b0c63c229f4d0d01f4d934"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a095ec12deab6b6ed0475583586a6c4d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a095ec12deab6b6ed0475583586a6c4d7">le_sig_Block</a> (int sigNum)</td></tr>
<tr class="separator:a095ec12deab6b6ed0475583586a6c4d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a421910132f193dae70e8309dc86a86c4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a421910132f193dae70e8309dc86a86c4">le_sig_SetEventHandler</a> (int sigNum, <a class="el" href="le__signals_8h.html#a89301bf64254cdb071c5277c7762f32d">le_sig_EventHandlerFunc_t</a> sigEventHandler)</td></tr>
<tr class="separator:a421910132f193dae70e8309dc86a86c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae921df0e028ec66f4920cf3ed655d398"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#ae921df0e028ec66f4920cf3ed655d398">le_sig_DeleteAll</a> (<a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>)</td></tr>
<tr class="separator:ae921df0e028ec66f4920cf3ed655d398"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a4b327bce26282f497d79fe31e1eaeaf1"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="le__mem_8h.html#a44a896f6a0a1a8c733e8038eb332989e">le_mem_PoolRef_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a4b327bce26282f497d79fe31e1eaeaf1">MonitorObjPool</a></td></tr>
<tr class="separator:a4b327bce26282f497d79fe31e1eaeaf1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4da2b58b4166191d6f7a6ec7e17458c2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="le__mem_8h.html#a44a896f6a0a1a8c733e8038eb332989e">le_mem_PoolRef_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a4da2b58b4166191d6f7a6ec7e17458c2">HandlerObjPool</a></td></tr>
<tr class="separator:a4da2b58b4166191d6f7a6ec7e17458c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aeab1297fdc6ad7ac9c462c17cfe0a2"><td class="memItemLeft" align="right" valign="top">static pthread_key_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a8aeab1297fdc6ad7ac9c462c17cfe0a2">SigMonKey</a></td></tr>
<tr class="separator:a8aeab1297fdc6ad7ac9c462c17cfe0a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3273ed9497760bb6284a7d2ab2f19436"><td class="memItemLeft" align="right" valign="top">static sigjmp_buf&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#a3273ed9497760bb6284a7d2ab2f19436">SigEnv</a></td></tr>
<tr class="separator:a3273ed9497760bb6284a7d2ab2f19436"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae77fbab864bf3ec3350774606f3bbfca"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="signals_8c.html#ae77fbab864bf3ec3350774606f3bbfca">GdbServerPort</a> = 0</td></tr>
<tr class="separator:ae77fbab864bf3ec3350774606f3bbfca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file implements the Legato Signal Events by making use of signalFd. When the user sets a signal event handler the handler is stored in a list of handlers and associated with a single signal number. The signal mask for the thread is then updated.</p>
<p>Each thread has its own list of handlers and stores this list in the thread's local data.</p>
<p>A monitor fd is created for each thread with atleast one handler but all monitor fds share a single fd handler, <a class="el" href="signals_8c.html#a077c5e918a44362a7225bbd5bc3fd4e3">OurSigHandler()</a>. When <a class="el" href="signals_8c.html#a077c5e918a44362a7225bbd5bc3fd4e3">OurSigHandler()</a> is invoked it grabs the list of handlers for the current thread and routes the signal to the proper user handler.</p>
<p>Copyright (C) Sierra Wireless Inc. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a369266c24eacffb87046522897a570d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _GNU_SOURCE</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="acc3b2d5b6dba18fe07087a065619bbc2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SIG_STR&#160;&#160;&#160;&quot;Sig&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Prefix for the monitor's name. The monitor's name is this prefix plus the name of the thread. </p>

</div>
</div>
<a class="anchor" id="a88d13b73bb278596844b801755aca552"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WRITE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="app_stop_client_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">buffer, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">sz&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                 \</div><div class="line">                int _rc;                         \</div><div class="line">                _rc = write((<a class="code" href="app_stop_client_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>),(buffer),(sz)); <a class="code" href="service_directory_8c.html#a1d84aa99c70d8cb8f479b606b96ae7e0">\</a></div><div class="line"><a class="code" href="service_directory_8c.html#a1d84aa99c70d8cb8f479b606b96ae7e0">                if</a> ((_rc &gt;= 0) &amp;&amp; (_rc &lt; (sz)))  \</div><div class="line">                {                                \</div><div class="line">                    _rc = write((<a class="code" href="app_stop_client_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a>),(buffer) + _rc,(sz) - _rc); \</div><div class="line">                }                                \</div><div class="line">            } <span class="keywordflow">while</span>(0)</div><div class="ttc" id="app_stop_client_8c_html_a44f21d5190b5a6df8089f54799628d7e"><div class="ttname"><a href="app_stop_client_8c.html#a44f21d5190b5a6df8089f54799628d7e">fd</a></div><div class="ttdeci">int fd</div><div class="ttdef"><b>Definition:</b> appStopClient.c:17</div></div>
<div class="ttc" id="service_directory_8c_html_a1d84aa99c70d8cb8f479b606b96ae7e0"><div class="ttname"><a href="service_directory_8c.html#a1d84aa99c70d8cb8f479b606b96ae7e0">if</a></div><div class="ttdeci">if(listen(ClientSocketFd, MAX_CONNECT_REQUEST_BACKLOG)!=0)</div><div class="ttdef"><b>Definition:</b> serviceDirectory.c:2606</div></div>
</div><!-- fragment --><p>WRITE macro to discard the return code inside the ShowStackSignalHandler </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a28ec7d993c364c8de4a240a57ac5b1d0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="struct_handler_obj__t.html">HandlerObj_t</a>* FindHandlerObj </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>sigNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structle__dls___list__t.html">le_dls_List_t</a> *&#160;</td>
          <td class="paramname"><em>listPtr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the handler object with the matching sigNum from the list.</p>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the handler object with a matching sigNum if found. NULL if a matching sigNum could not be found. </dd></dl>

</div>
</div>
<a class="anchor" id="a095ec12deab6b6ed0475583586a6c4d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> le_sig_Block </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sigNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Blocks a signal in the calling thread.</p>
<p>Signals that an event handler will be set for must be blocked for all threads in the process. To ensure that the signals are blocked in all threads call this function in the process' first thread, all subsequent threads will inherit the signal mask.</p>
<dl class="section note"><dt>Note</dt><dd>Does not return on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sigNum</td><td>Signal to block. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae921df0e028ec66f4920cf3ed655d398"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> le_sig_DeleteAll </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes all signal event handlers for the calling thread and cleans up any resources used for signal events. This should be called before the thread exits. </p>

</div>
</div>
<a class="anchor" id="a8bc8661a69dd8f5378091a3099815253"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> le_sig_InstallDefaultTermHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Install a default handler to handle the SIGTERM signal.</p>
<p>Called automatically by <a class="el" href="start_8c.html#a3c04138a5bfe5d72780bb7e82a18e627">main()</a>. </p>

</div>
</div>
<a class="anchor" id="acae2ca62730ef3e9834779c4948f5812"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> le_sig_InstallShowStackHandler </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Install the ShowStackSignalHandler to show information and dump stack </p>

</div>
</div>
<a class="anchor" id="a421910132f193dae70e8309dc86a86c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> le_sig_SetEventHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sigNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="le__signals_8h.html#a89301bf64254cdb071c5277c7762f32d">le_sig_EventHandlerFunc_t</a>&#160;</td>
          <td class="paramname"><em>sigEventHandler</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set a signal event handler for the calling thread. Each signal can only have a single event handler. The most recent event handler set will be called when the signal is received. sigEventHandler can be set to NULL to remove a previously set handler.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sigNum</td><td>Cannot be SIGKILL or SIGSTOP or any program error signals: SIGFPE, SIGILL, SIGSEGV, SIGBUS, SIGABRT, SIGIOT, SIGTRAP, SIGEMT, SIGSYS.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Does not return on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sigNum</td><td>The signal to set the event handler for. See parameter documentation in comments above. </td></tr>
    <tr><td class="paramname">sigEventHandler</td><td>The event handler to call when a signal is received. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a077c5e918a44362a7225bbd5bc3fd4e3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> OurSigHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">short&#160;</td>
          <td class="paramname"><em>events</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Our signal handler. This signal handler gets called whenever any unmasked signals are received. This handler will read the signal info and call the appropriate user handler. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fd</td><td>The monitored file descriptor. </td></tr>
    <tr><td class="paramname">events</td><td>The event or events (bit mask) that occurred on the fd. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a199eff4756a32175cf3f684770827177"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> ShowStackSignalHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sigNum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">siginfo_t *&#160;</td>
          <td class="paramname"><em>sigInfoPtr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> *&#160;</td>
          <td class="paramname"><em>sigVoidPtr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Our show stack signal handler. This signal handler is called only when SEGV, ILL, BUS, FPE, ABRT TRAP are raised. It will show useful informations: signal, fault address, fault PC, registers, stack and back-trace. It also dumps the process maps. Note: Because these signals are raised from low-level, we should avoid any usage of malloc(3), syslog(3) and others services like these from stdio(3).</p>
<dl class="section note"><dt>Note</dt><dd>This code is architecture dependant, and supports arm, x86_64, i586 and i686. </dd>
<dd>
Some unsafe functions are used:<ul>
<li>snprintf</li>
<li>backtrace (not on arm)</li>
<li>sigsetjmp/siglongjmp </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="ae763eee7e4b0c63c229f4d0d01f4d934"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> sig_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>The signal event initialization function. This must be called before any other functions in this module is called. </p>

</div>
</div>
<a class="anchor" id="aa7dc58d39d6552abef5ef4b7f0898ff2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> SigSegVHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>signum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SEGV handler used to handle a SEGV while executing the ShowStackSignalHandler handler. This will abort the current dump and next dump will be run. This is to prevent the first handler to crash while dumping a crushed stack and backtrace. As sigsetjmp() and siglongjmp() are used, a proctection by counter is added to avoid infinite loop. As two critical parts exists inside the ShowStackSignalHandler, this counter MUST NOT be greater than 2. At the third call, there will be no recover from SEGV. </p>

</div>
</div>
<a class="anchor" id="acaeb18d6d39617557407a4d628096f18"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="_t_e_m_p_l_a_t_e__cdef_8h.html#ac9c84fa68bbad002983e35ce3663c686">void</a> TermSignalHandler </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sigNum</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Minimal signal handler that exists the application if a SIGTERM has been received. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sigNum</td><td>The signal that was received. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ae77fbab864bf3ec3350774606f3bbfca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t GdbServerPort = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Port to use for start and attach a gdbserver(1) to itself. If 0, no gdbserver(1) is started </p>

</div>
</div>
<a class="anchor" id="a4da2b58b4166191d6f7a6ec7e17458c2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="le__mem_8h.html#a44a896f6a0a1a8c733e8038eb332989e">le_mem_PoolRef_t</a> HandlerObjPool</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The signal event handler object memory pool. </p>

</div>
</div>
<a class="anchor" id="a4b327bce26282f497d79fe31e1eaeaf1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="le__mem_8h.html#a44a896f6a0a1a8c733e8038eb332989e">le_mem_PoolRef_t</a> MonitorObjPool</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The signal event monitor object memory pool. </p>

</div>
</div>
<a class="anchor" id="a3273ed9497760bb6284a7d2ab2f19436"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">sigjmp_buf SigEnv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Stack, signals mask and context environment for sigsetjmp() and siglongjmp() </p>

</div>
</div>
<a class="anchor" id="a8aeab1297fdc6ad7ac9c462c17cfe0a2"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pthread_key_t SigMonKey</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The thread local data's key for monitor objects. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.11
        </div>
    </div>
</body>
</html>
