<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Runtime Architecture</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/javascript">
//<![CDATA[
    // Detect if doc is served by eclipse
    if( ( (window.location.hostname == "127.0.0.1") || (window.location.hostname == "localhost") ) &&
        ( (window.location.port != "") && (window.location.port != 80) && (window.location.port != 443) ) )
    {
        // Inhibit init function from navtree
        initNavTree = function(toroot,relpath) {}
        $(document).ready(function(){
            navTree = document.getElementById("side-nav");
            if(navTree)
            {
                navTree.parentElement.removeChild(navTree);
            }
            $("#doc-content").css('margin-left',10);
        });
    }
//]]>
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <a href="index.html" title="Legato">
      <img alt="Logo" src="legatoLogo.png"/>
    </a>
    <div id="projectbrief">Simplifying IoT development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('conceptsRuntimeArch.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Runtime Architecture </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Legato's runtime architecture manages each app in its own sandbox.</p>
<div class="image">
<img src="conceptsRuntimeArch_LayeredArchitecture.png" alt="conceptsRuntimeArch_LayeredArchitecture.png"/>
</div>
<p>Apps communicate with each other using access-controlled message-passing services.</p>
<p>The Supervisor automatically creates sandboxes.</p>
<h1><a class="anchor" id="conceptsRuntimeArch_apps"></a>
Applications</h1>
<p>An application (we call them 'apps') is a collection of executable files, libraries, and/or other resource files (e.g., audio files, web pages) that can be deployed to a target device. Once installed on a device, an app can be started and stopped.</p>
<p>By default, each app runs in its own sandbox. When an app is constructed, all the files and IPC services it needs to access are declared. At runtime, the Supervisor and the Service Directory enforce that only approved files and IPC services are accessed by that app.</p>
<p><a class="el" href="getStartedApps.html">Tutorials</a></p>
<h1><a class="anchor" id="conceptsRuntimeArch_supervisor"></a>
Supervisor</h1>
<p>The Supervisor is a privileged process running on the target device that:</p><ul>
<li>creates and destroys conceptsSecuritySandbox for apps</li>
<li>starts and stops apps</li>
<li>performs fault recovery when apps fail (e.g., restarting the app).</li>
</ul>
<h1><a class="anchor" id="conceptsRuntimeArch_serviceDirectory"></a>
Service Directory</h1>
<p>Legato's Service Directory provides a secure way for client processes to find servers offering services they need, which ensures only authorized connections are established.</p>
<p><a class="el" href="legatoServices.html">Services APIs</a> <br />
 <a class="el" href="conceptsInterfaces.html">Interfaces</a></p>
<h1><a class="anchor" id="conceptsRuntimeArch_configTree"></a>
Config Tree</h1>
<p>The Config Tree provides persistent basicConfig data storage organized in a tree structure.</p>
<p>Command line <a class="el" href="toolsTarget_config.html">config</a> tool <br />
 <a class="el" href="c_config.html">Config Tree API</a></p>
<h1><a class="anchor" id="conceptsRuntimeArch_watchdog"></a>
Watchdog</h1>
<p>Legato provides a monitoring service for applications with the <code>watchdog</code> daemon which runs within the Legato Runtime Environment. If your target supports it, the watchdog daemon can also be enabled to kick an external watchdog such as Linux watchdog device.</p>
<dl class="section note"><dt>Note</dt><dd>To configure the external watchdog kick interval, add a <a class="el" href="defFilesSdef.html#defFilesSdef_externalWatchdogKick">externalWatchdogKick</a> section to your systems <a class="el" href="defFilesSdef.html">System Definition .sdef</a> .</dd></dl>
<p>The daemon monitors app's processes for hangs or freezing and if the process doesn't "kick" the watchdog daemon in a specified time (the default is <b>30</b> <b>seconds</b>), the watchdog signals the <a class="el" href="conceptsRuntimeArch.html#conceptsRuntimeArch_supervisor">Supervisor</a> to perform a specified action. Critical services should also set the maxWatchdogTimeout to further ensure that the system is running with all critical services started.</p>
<dl class="section note"><dt>Note</dt><dd>Most platform services installed on your target have a maxWatchdogTimeout set to 2 minutes. To enable, configure or disable watchdog on a platform service, configure the watchdog settings in the platform service's <a class="el" href="defFilesAdef.html">Application Definition .adef</a>.</dd></dl>
<p>The watchdog consists of 3 configurable settings:</p><ul>
<li>timeout: the time the watchdog daemon waits for a "kick" in normal operation.</li>
<li>maxTimeout: the maximum time the watchdog daemon waits for a kick (including on startup, when performing a system recovery, and after <a class="el" href="le__wdog__interface_8h.html#a041aed268270e1c3668b6ff28bee8fd7">le_wdog_Timeout()</a>).</li>
<li>action: the action the watchdog daemon takes when it does not receive a "kick".</li>
</ul>
<p>All settings are configured in the <a class="el" href="defFilesAdef.html">app's definition file (.adef)</a>. You must also bind the watchdog API into your app and use the <a class="el" href="c_wdog.html">Watchdog Service</a> API's functions to configure the behavior of the watchdog and the app.</p>
<dl class="section note"><dt>Note</dt><dd>Setting the maxTimeout also ensures the watchdog is started on system boot (rather than the first instance of <code><a class="el" href="le__wdog__interface_8h.html#a43d5abc5c44309942efbe7b9c25d811f">le_wdog_Kick()</a></code>).</dd></dl>
<p>Default watchdog kick timeout: <b>30</b> <b>seconds</b> </p>
<p>Default watchdog action: <b>restart</b> </p>
<p>Possible watchdog actions:</p><ul>
<li><code>ignore</code> - Supervisor just logs a warning message; no further action taken.</li>
<li><code>restart</code> - log a critical message and restart the process.</li>
<li><code>restartApp</code> - log a critical message and restart the entire app.</li>
<li><code>stop</code> - Supervisor terminates the process if it's still running.</li>
<li><code>stopApp</code> - log a critical message and terminate the entire app (send all processes the SIGTERM signal, followed shortly by SIGKILL).</li>
<li><code>reboot</code> - log an emergency message and reboot the system.</li>
</ul>
<p>To disable the watchdog for all the daemons within the Legato Application Framework remove the two "#" symbols from the watchdog build section in <code>Makefile.framework</code>.</p>
<p>The command has already been added to the <code>mkexe</code> arguments for <code>liblegato</code>, but has been commented out. Remove the "#" from the following line and the line above it: <code>&ndash;cflags=-DLEGATO_FRAMEWORK_WDOG_DISABLE</code> </p>
<p>Example: </p><pre class="fragment">.PHONY: watchdog
watchdog: liblegato $(BIN_DIR)
            mkexe $(LOCAL_MKEXE_FLAGS) \
                        -i $(LEGATO_ROOT)/framework/liblegato \
                        -i $(LEGATO_ROOT)/framework/liblegato/linux \
                        $(SRC_DIR)/watchdog/watchdogDaemon #\            #uncomment the \
                        #--cflags=-DLEGATO_FRAMEWORK_WDOG_DISABLE        #uncomment this line
</pre><p>To disable the watchdog for the Platform Services on your target set <code>LEGATO_SERVICES_WDOG_DISABLE=1</code> within the <a class="el" href="defFilesSdef.html#defFilesSdef_buildVars">buildVars</a> section of your <a class="el" href="defFilesSdef.html">System Definition .sdef</a> .</p>
<h1><a class="anchor" id="conceptsRuntimeArch_logs"></a>
Logs</h1>
<p>Legato provides a user-friendly way to control log message filtering for running app processes.</p>
<p>Command line <a class="el" href="toolsTarget_log.html">log</a> tool <br />
 <a class="el" href="c_logging.html">Logging API</a>.</p>
<h1><a class="anchor" id="conceptsRuntimeArch_updateDaemon"></a>
Update Daemon</h1>
<p>The Update Daemon accepts <em>update</em> <em>pack</em> files that contain software/firmware update instructions and associated data like libraries, executables, and resource files.</p>
<p>Update packs can be fed to the Update Daemon through the <a class="el" href="c_update.html">Update API</a> API or through the <a class="el" href="toolsTarget_update.html">update</a> tool.</p>
<p>The Update Daemon includes hooks that allow update packs to be digitally signed and/or encrypted for security reasons.</p>
<p>Copyright (C) Sierra Wireless Inc. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="https://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.11
        </div>
    </div>
</body>
</html>
